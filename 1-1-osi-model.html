<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="OSI Model Deep Dive - Understanding all 7 layers with security relevance, attack vectors, and security controls">
    <title>OSI Model Deep Dive | Network Security Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”’</text></svg>">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation (same as index.html) -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">ğŸ”’</div>
                    <div class="sidebar-logo-text">
                        Network Security
                        <span>Ultimate Guide</span>
                    </div>
                </a>
            </div>
            
            <div class="sidebar-search">
                <div class="search-input-wrapper">
                    <span class="search-icon">ğŸ”</span>
                    <input type="text" class="search-input" placeholder="Search documentation...">
                    <span class="search-shortcut">âŒ˜K</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <!-- Section 1: Networking Fundamentals -->
                <div class="nav-section active">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <span class="nav-section-icon">ğŸŒ</span>
                            Networking Fundamentals
                        </div>
                        <span class="nav-section-arrow">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="1-1-osi-model.html" class="nav-link active"><span class="nav-link-number">1.1</span> OSI Model Deep Dive</a>
                        <a href="1-2-tcp-ip-protocols.html" class="nav-link"><span class="nav-link-number">1.2</span> TCP/IP Stack & Protocols</a>
                        <a href="1-3-addressing-subnetting.html" class="nav-link"><span class="nav-link-number">1.3</span> Network Addressing</a>
                        <a href="1-4-routing.html" class="nav-link"><span class="nav-link-number">1.4</span> Routing Fundamentals</a>
                        <a href="1-5-switching-vlans.html" class="nav-link"><span class="nav-link-number">1.5</span> Switching & VLANs</a>
                        <a href="1-6-segmentation.html" class="nav-link"><span class="nav-link-number">1.6</span> Network Segmentation</a>
                        <a href="1-7-dns-security.html" class="nav-link"><span class="nav-link-number">1.7</span> DNS Security</a>
                        <a href="1-8-dhcp-security.html" class="nav-link"><span class="nav-link-number">1.8</span> DHCP Security</a>
                        <a href="1-9-traffic-analysis.html" class="nav-link"><span class="nav-link-number">1.9</span> Traffic Analysis</a>
                        <a href="1-10-protocol-reference.html" class="nav-link"><span class="nav-link-number">1.10</span> Protocol Reference</a>
                    </div>
                </div>
                
                <!-- Section 2: Firewalls (collapsed) -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <span class="nav-section-icon">ğŸ›¡ï¸</span>
                            Firewalls
                        </div>
                        <span class="nav-section-arrow">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="2-1-firewall-fundamentals.html" class="nav-link"><span class="nav-link-number">2.1</span> Firewall Fundamentals</a>
                        <a href="2-2-firewall-types.html" class="nav-link"><span class="nav-link-number">2.2</span> Firewall Types</a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">â˜°</button>
                    <div class="breadcrumb">
                        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item">Networking Fundamentals</span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-current">OSI Model</span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="header-btn" onclick="printPage()">ğŸ–¨ï¸ Print</button>
                </div>
            </header>
            
            <!-- Content Body -->
            <div class="content-body">
                <h1>OSI Model Deep Dive</h1>
                
                <!-- Overview Box -->
                <div class="overview-box">
                    <div class="overview-title">ğŸ“‹ What You'll Learn</div>
                    <div class="overview-content">
                        <p>The OSI (Open Systems Interconnection) model is the foundational framework for understanding how data flows through a network. For security professionals, understanding each layer is critical for identifying attack vectors and implementing appropriate security controls.</p>
                        <ul>
                            <li>All 7 OSI layers with detailed security relevance</li>
                            <li>Attack vectors specific to each layer</li>
                            <li>Security controls and countermeasures</li>
                            <li>Protocol mapping and real-world examples</li>
                            <li>Interview preparation tips and common questions</li>
                        </ul>
                    </div>
                </div>
                
                <h2>The OSI Model Overview</h2>
                
                <p>The OSI model divides network communication into seven distinct layers, each with specific responsibilities. Understanding this model is essential for troubleshooting network issues, implementing security controls, and discussing network architecture with clarity.</p>
                
                <!-- ASCII Diagram -->
                <div class="ascii-diagram">
                    <div class="ascii-diagram-title">OSI Model with Security Context</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           OSI MODEL - SECURITY VIEW                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LAYER   â”‚      NAME        â”‚   PROTOCOLS    â”‚  SECURITY DEVICES/CONTROLS   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    7     â”‚   Application    â”‚  HTTP, HTTPS,  â”‚  WAF, Proxy, DLP,            â”‚
â”‚          â”‚                  â”‚  FTP, SMTP,    â”‚  Application Firewall,       â”‚
â”‚          â”‚                  â”‚  DNS, SSH      â”‚  Content Filtering           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    6     â”‚   Presentation   â”‚  SSL/TLS,      â”‚  Encryption, PKI,            â”‚
â”‚          â”‚                  â”‚  JPEG, MPEG,   â”‚  Certificate Management,     â”‚
â”‚          â”‚                  â”‚  ASCII, EBCDIC â”‚  Data Formatting Security    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    5     â”‚   Session        â”‚  NetBIOS,      â”‚  Session Management,         â”‚
â”‚          â”‚                  â”‚  RPC, PPTP,    â”‚  Authentication Controls,    â”‚
â”‚          â”‚                  â”‚  SIP           â”‚  Session Timeout             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    4     â”‚   Transport      â”‚  TCP, UDP,     â”‚  Stateful Firewall,          â”‚
â”‚          â”‚                  â”‚  SCTP          â”‚  IDS/IPS, Port Filtering,    â”‚
â”‚          â”‚                  â”‚                â”‚  Rate Limiting               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    3     â”‚   Network        â”‚  IP, ICMP,     â”‚  Router ACLs, L3 Firewall,   â”‚
â”‚          â”‚                  â”‚  IGMP, IPSec,  â”‚  VPN, Anti-Spoofing,         â”‚
â”‚          â”‚                  â”‚  ARP, RARP     â”‚  Route Filtering             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    2     â”‚   Data Link      â”‚  Ethernet,     â”‚  Switch Port Security,       â”‚
â”‚          â”‚                  â”‚  PPP, HDLC,    â”‚  VLAN Segmentation,          â”‚
â”‚          â”‚                  â”‚  802.11 (WiFi) â”‚  MAC Filtering, 802.1X       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    1     â”‚   Physical       â”‚  RS-232,       â”‚  Physical Access Control,    â”‚
â”‚          â”‚                  â”‚  RJ-45, Fiber, â”‚  Cable Security,             â”‚
â”‚          â”‚                  â”‚  Radio Waves   â”‚  Secure Facilities           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â–²                                                                      â–²
    â”‚         DATA ENCAPSULATION (Sending)                                 â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚    â”‚  Application Data â†’ Segment â†’ Packet â†’ Frame â†’ Bits      â”‚     â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â”‚                                                                      â”‚
    â”‚         DATA DECAPSULATION (Receiving)                               â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚    â”‚  Bits â†’ Frame â†’ Packet â†’ Segment â†’ Application Data      â”‚     â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â–¼                                                                      â–¼
</pre>
                </div>
                
                <h2>Layer 7: Application Layer</h2>
                
                <p>The Application Layer is the closest to the end-user and provides network services directly to applications. It's also the most targeted layer for attacks because it handles user data and authentication.</p>
                
                <h3>Security Relevance</h3>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Protocol</th>
                                <th>Port</th>
                                <th>Common Attacks</th>
                                <th>Security Controls</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>HTTP/HTTPS</code></td>
                                <td>80/443</td>
                                <td>SQL Injection, XSS, CSRF, Directory Traversal</td>
                                <td>WAF, Input Validation, HTTPS Enforcement</td>
                            </tr>
                            <tr>
                                <td><code>DNS</code></td>
                                <td>53</td>
                                <td>DNS Spoofing, Cache Poisoning, Tunneling</td>
                                <td>DNSSEC, DNS Filtering, Sinkholing</td>
                            </tr>
                            <tr>
                                <td><code>SMTP</code></td>
                                <td>25/587</td>
                                <td>Email Spoofing, Phishing, Spam</td>
                                <td>SPF, DKIM, DMARC, Email Gateway</td>
                            </tr>
                            <tr>
                                <td><code>SSH</code></td>
                                <td>22</td>
                                <td>Brute Force, Key Theft</td>
                                <td>Key-based Auth, Fail2ban, Bastion Hosts</td>
                            </tr>
                            <tr>
                                <td><code>FTP</code></td>
                                <td>21</td>
                                <td>Credential Sniffing, Bounce Attacks</td>
                                <td>SFTP/FTPS, IP Restrictions</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Interview Tip Callout -->
                <div class="callout callout-interview">
                    <div class="callout-title">ğŸ’¡ Interview Tip</div>
                    <div class="callout-content">
                        <p><strong>Common Question:</strong> "At which OSI layer does a WAF operate?"</p>
                        <p><strong>Answer:</strong> A Web Application Firewall (WAF) operates primarily at <strong>Layer 7 (Application Layer)</strong> because it inspects HTTP/HTTPS traffic and understands application-level protocols. It can detect and block attacks like SQL injection, XSS, and CSRF by analyzing the content of web requests. Some WAFs also have visibility into Layer 6 for SSL/TLS decryption.</p>
                    </div>
                </div>
                
                <h2>Layer 6: Presentation Layer</h2>
                
                <p>The Presentation Layer handles data translation, encryption, and compression. It ensures that data from the Application Layer can be read by the receiving system, regardless of differences in data representation.</p>
                
                <h3>Security Functions</h3>
                
                <ul>
                    <li><strong>Encryption/Decryption:</strong> SSL/TLS operates here, providing confidentiality</li>
                    <li><strong>Data Formatting:</strong> Ensures consistent data representation (ASCII, EBCDIC, Unicode)</li>
                    <li><strong>Compression:</strong> Reduces data size while maintaining integrity</li>
                </ul>
                
                <!-- Code Block Example -->
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">OpenSSL - Checking TLS Certificate</span>
                        <button class="code-copy-btn">ğŸ“‹ Copy</button>
                    </div>
                    <pre><code><span class="token-comment"># Check SSL/TLS certificate of a website</span>
<span class="token-command">openssl</span> <span class="token-function">s_client</span> <span class="token-flag">-connect</span> <span class="token-string">example.com:443</span> <span class="token-flag">-servername</span> <span class="token-string">example.com</span>

<span class="token-comment"># View certificate details</span>
<span class="token-command">openssl</span> <span class="token-function">s_client</span> <span class="token-flag">-connect</span> <span class="token-string">example.com:443</span> | <span class="token-command">openssl</span> <span class="token-function">x509</span> <span class="token-flag">-noout</span> <span class="token-flag">-text</span>

<span class="token-comment"># Check certificate expiration</span>
<span class="token-command">openssl</span> <span class="token-function">s_client</span> <span class="token-flag">-connect</span> <span class="token-string">example.com:443</span> 2>/dev/null | <span class="token-command">openssl</span> <span class="token-function">x509</span> <span class="token-flag">-noout</span> <span class="token-flag">-dates</span></code></pre>
                </div>
                
                <h2>Layer 5: Session Layer</h2>
                
                <p>The Session Layer establishes, manages, and terminates sessions between applications. It handles authentication, reconnection, and checkpointing during data transfer.</p>
                
                <div class="callout callout-warning">
                    <div class="callout-title">âš ï¸ Security Warning</div>
                    <div class="callout-content">
                        <p>Session hijacking attacks target this layer. Attackers can steal session tokens, cookies, or session IDs to impersonate legitimate users. Always implement:</p>
                        <ul>
                            <li>Session timeout policies</li>
                            <li>Secure session token generation (cryptographically random)</li>
                            <li>Session binding to IP/User-Agent</li>
                            <li>HTTPS-only session cookies</li>
                        </ul>
                    </div>
                </div>
                
                <h2>Layer 4: Transport Layer</h2>
                
                <p>The Transport Layer provides end-to-end communication services, including segmentation, flow control, and error recovery. TCP and UDP are the primary protocols at this layer.</p>
                
                <!-- ASCII Diagram: TCP vs UDP -->
                <div class="ascii-diagram">
                    <div class="ascii-diagram-title">TCP vs UDP Security Comparison</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TCP (Transmission Control Protocol)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ“ Connection-oriented (3-way handshake)                                    â”‚
â”‚  âœ“ Reliable delivery with acknowledgments                                   â”‚
â”‚  âœ“ Ordered packet delivery                                                  â”‚
â”‚  âœ“ Flow control and congestion control                                      â”‚
â”‚                                                                              â”‚
â”‚  SECURITY IMPLICATIONS:                                                      â”‚
â”‚  â€¢ SYN Flood attacks possible (target handshake)                            â”‚
â”‚  â€¢ TCP session hijacking (sequence number prediction)                        â”‚
â”‚  â€¢ RST attacks can terminate sessions                                        â”‚
â”‚  â€¢ Stateful firewalls can track connections                                  â”‚
â”‚                                                                              â”‚
â”‚  COMMON ATTACKS: SYN Flood, TCP Reset, Session Hijacking, ACK Flood         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UDP (User Datagram Protocol)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ— Connectionless (no handshake)                                            â”‚
â”‚  âœ— Unreliable (no acknowledgments)                                          â”‚
â”‚  âœ— No ordering guarantee                                                    â”‚
â”‚  âœ“ Low overhead, faster than TCP                                            â”‚
â”‚                                                                              â”‚
â”‚  SECURITY IMPLICATIONS:                                                      â”‚
â”‚  â€¢ Easy to spoof source IP (no handshake verification)                      â”‚
â”‚  â€¢ Used in amplification/reflection attacks                                  â”‚
â”‚  â€¢ Harder for stateful firewalls to track                                   â”‚
â”‚  â€¢ DNS, NTP, SNMP often abused for DDoS                                     â”‚
â”‚                                                                              â”‚
â”‚  COMMON ATTACKS: UDP Flood, DNS Amplification, NTP Amplification            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <h3>TCP Three-Way Handshake</h3>
                
                <div class="ascii-diagram">
                    <div class="ascii-diagram-title">TCP Three-Way Handshake with Packet Details</div>
<pre>
     CLIENT                                                 SERVER
        â”‚                                                      â”‚
        â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SYN (SEQ=100) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
        â”‚              Flags: SYN                              â”‚
        â”‚              Seq: 100                                â”‚
        â”‚                                                      â”‚
        â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€ SYN-ACK (SEQ=300, ACK=101) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
        â”‚              Flags: SYN, ACK                         â”‚
        â”‚              Seq: 300, Ack: 101                      â”‚
        â”‚                                                      â”‚
        â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ACK (SEQ=101, ACK=301) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
        â”‚              Flags: ACK                              â”‚
        â”‚              Seq: 101, Ack: 301                      â”‚
        â”‚                                                      â”‚
        â”‚  â•â•â•â•â•â•â•â•â•â•â• CONNECTION ESTABLISHED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
        â”‚                                                      â”‚
        
   ATTACK VECTOR: SYN Flood
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Attacker sends thousands of SYN packets with             â”‚
   â”‚  spoofed source IPs. Server allocates resources           â”‚
   â”‚  for half-open connections, exhausting memory.            â”‚
   â”‚                                                            â”‚
   â”‚  MITIGATION: SYN Cookies, Rate Limiting, Firewall Rules   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <!-- Best Practice Callout -->
                <div class="callout callout-bestpractice">
                    <div class="callout-title">âœ… Best Practice</div>
                    <div class="callout-content">
                        <p><strong>Firewall Rule Design at Layer 4:</strong></p>
                        <p>When creating firewall rules, always specify both port AND protocol. A rule allowing "port 443" without specifying TCP could inadvertently allow UDP traffic on port 443, which might be exploited.</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-lang">Palo Alto CLI</span>
                                <button class="code-copy-btn">ğŸ“‹ Copy</button>
                            </div>
                            <pre><code><span class="token-comment"># Good: Specify protocol and port</span>
set rulebase security rules HTTPS-Allow from any to untrust source any destination any application ssl service application-default action allow

<span class="token-comment"># Check session table for TCP connections</span>
show session all filter protocol 6 destination-port 443</code></pre>
                        </div>
                    </div>
                </div>
                
                <h2>Layer 3: Network Layer</h2>
                
                <p>The Network Layer handles logical addressing (IP addresses) and routing. It determines the best path for data to travel across networks and is where routers operate.</p>
                
                <h3>Security Controls at Layer 3</h3>
                
                <div class="steps-container">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Router Access Control Lists (ACLs)</h4>
                            <p>Filter traffic based on source/destination IP addresses. Standard ACLs filter by source only; Extended ACLs can filter by source, destination, protocol, and port.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Anti-Spoofing (uRPF)</h4>
                            <p>Unicast Reverse Path Forwarding validates that source IP addresses are reachable through the interface they arrived on, preventing IP spoofing.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>IPSec VPN</h4>
                            <p>Provides encryption and authentication at Layer 3, enabling secure site-to-site and remote access connections.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Route Filtering</h4>
                            <p>Prevent route injection attacks by filtering which routes are accepted from BGP/OSPF peers. Use prefix lists and route maps.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Cisco ACL Example -->
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">Cisco IOS - Extended ACL Example</span>
                        <button class="code-copy-btn">ğŸ“‹ Copy</button>
                    </div>
                    <pre><code><span class="token-comment">! Create an extended ACL to allow HTTPS and deny all other traffic</span>
<span class="token-keyword">ip access-list extended</span> WEB-TRAFFIC
 <span class="token-keyword">permit</span> tcp <span class="token-variable">192.168.1.0 0.0.0.255</span> any <span class="token-keyword">eq</span> <span class="token-number">443</span>
 <span class="token-keyword">permit</span> tcp <span class="token-variable">192.168.1.0 0.0.0.255</span> any <span class="token-keyword">eq</span> <span class="token-number">80</span>
 <span class="token-keyword">deny</span> ip any any <span class="token-keyword">log</span>

<span class="token-comment">! Apply ACL to interface (inbound)</span>
<span class="token-keyword">interface</span> GigabitEthernet0/1
 ip access-group WEB-TRAFFIC in

<span class="token-comment">! Verify ACL hits</span>
<span class="token-command">show</span> access-lists WEB-TRAFFIC</code></pre>
                </div>
                
                <h2>Layer 2: Data Link Layer</h2>
                
                <p>The Data Link Layer provides node-to-node data transfer and handles MAC addressing, framing, and error detection. Switches operate at this layer.</p>
                
                <h3>Layer 2 Attack Vectors</h3>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Attack</th>
                                <th>Description</th>
                                <th>Mitigation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>MAC Flooding</strong></td>
                                <td>Overwhelm switch MAC table to force hub-like behavior</td>
                                <td>Port Security, MAC Limiting</td>
                            </tr>
                            <tr>
                                <td><strong>ARP Spoofing</strong></td>
                                <td>Send fake ARP replies to redirect traffic</td>
                                <td>Dynamic ARP Inspection (DAI)</td>
                            </tr>
                            <tr>
                                <td><strong>VLAN Hopping</strong></td>
                                <td>Access other VLANs via switch spoofing or double tagging</td>
                                <td>Disable DTP, Native VLAN hardening</td>
                            </tr>
                            <tr>
                                <td><strong>STP Attacks</strong></td>
                                <td>Manipulate Spanning Tree to become root bridge</td>
                                <td>BPDU Guard, Root Guard</td>
                            </tr>
                            <tr>
                                <td><strong>DHCP Starvation</strong></td>
                                <td>Exhaust DHCP pool with fake requests</td>
                                <td>DHCP Snooping, Port Security</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">Cisco IOS - Port Security Configuration</span>
                        <button class="code-copy-btn">ğŸ“‹ Copy</button>
                    </div>
                    <pre><code><span class="token-comment">! Enable port security on access port</span>
<span class="token-keyword">interface</span> GigabitEthernet0/1
 <span class="token-keyword">switchport mode</span> access
 <span class="token-keyword">switchport access</span> vlan 10
 <span class="token-keyword">switchport port-security</span>
 <span class="token-keyword">switchport port-security maximum</span> <span class="token-number">2</span>
 <span class="token-keyword">switchport port-security violation</span> restrict
 <span class="token-keyword">switchport port-security mac-address</span> sticky

<span class="token-comment">! Enable DHCP Snooping</span>
<span class="token-keyword">ip dhcp snooping</span>
<span class="token-keyword">ip dhcp snooping</span> vlan 10,20,30

<span class="token-comment">! Trust uplink to DHCP server</span>
<span class="token-keyword">interface</span> GigabitEthernet0/24
 <span class="token-keyword">ip dhcp snooping trust</span>

<span class="token-comment">! Enable Dynamic ARP Inspection</span>
<span class="token-keyword">ip arp inspection</span> vlan 10,20,30</code></pre>
                </div>
                
                <h2>Layer 1: Physical Layer</h2>
                
                <p>The Physical Layer deals with the actual physical connection between devicesâ€”cables, connectors, electrical signals, and radio waves. While often overlooked, physical security is fundamental.</p>
                
                <div class="callout callout-critical">
                    <div class="callout-title">ğŸ”´ Critical Security Note</div>
                    <div class="callout-content">
                        <p><strong>Physical security is the foundation of all security.</strong> If an attacker has physical access to your network infrastructure, all other security controls can potentially be bypassed.</p>
                        <ul>
                            <li>Secure server rooms with badge access and logging</li>
                            <li>Lock network closets and cable management areas</li>
                            <li>Use tamper-evident seals on critical equipment</li>
                            <li>Implement CCTV monitoring for sensitive areas</li>
                            <li>Disable unused switch ports</li>
                            <li>Use fiber optics where possible (harder to tap than copper)</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Day-to-Day Tasks -->
                <div class="callout callout-daily">
                    <div class="callout-title">ğŸ“… Day-to-Day Tasks</div>
                    <div class="callout-content">
                        <p><strong>As a Security Engineer, here's how you'll use OSI model knowledge daily:</strong></p>
                        <ul>
                            <li><strong>Troubleshooting:</strong> Systematically work through layers to isolate issues</li>
                            <li><strong>Security Architecture:</strong> Design defense-in-depth with controls at multiple layers</li>
                            <li><strong>Incident Response:</strong> Identify which layer an attack is targeting</li>
                            <li><strong>Vendor Communication:</strong> Speak the same language as network and security teams</li>
                            <li><strong>Documentation:</strong> Clearly describe where security controls operate</li>
                        </ul>
                    </div>
                </div>
                
                <h2>Security Devices by OSI Layer</h2>
                
                <div class="ascii-diagram">
                    <div class="ascii-diagram-title">Security Device Mapping to OSI Layers</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WHERE SECURITY DEVICES OPERATE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  Layer 7  â”€â”€â–º  WAF, Proxy, DLP, CASB, Email Gateway, Content Filter           â”‚
â”‚                                                                                â”‚
â”‚  Layer 6  â”€â”€â–º  SSL/TLS Inspection, Encryption Appliances                      â”‚
â”‚                                                                                â”‚
â”‚  Layer 5  â”€â”€â–º  Session Management (integrated into L7 devices)                â”‚
â”‚                                                                                â”‚
â”‚  Layer 4  â”€â”€â–º  Stateful Firewall, IDS/IPS, Load Balancer (L4)                 â”‚
â”‚                                                                                â”‚
â”‚  Layer 3  â”€â”€â–º  Router ACLs, VPN Gateway, Packet Filter Firewall               â”‚
â”‚                                                                                â”‚
â”‚  Layer 2  â”€â”€â–º  Switch (Port Security, VLAN), 802.1X (NAC)                     â”‚
â”‚                                                                                â”‚
â”‚  Layer 1  â”€â”€â–º  Physical Access Controls, Network TAPs, Cable Locks            â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  NGFW (Next-Gen Firewall)     â”€â”€â–º  Layers 3-7 (Deep Packet Inspection)        â”‚
â”‚  UTM (Unified Threat Mgmt)    â”€â”€â–º  Layers 3-7 (All-in-one appliance)          â”‚
â”‚  SIEM                         â”€â”€â–º  All Layers (Log collection & correlation)  â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <h2>Quick Reference: Remembering the OSI Layers</h2>
                
                <p>Use this mnemonic to remember the layers from bottom to top:</p>
                
                <div class="callout callout-info">
                    <div class="callout-title">ğŸ’¡ Memory Trick</div>
                    <div class="callout-content">
                        <p><strong>"Please Do Not Throw Sausage Pizza Away"</strong></p>
                        <ul>
                            <li><strong>P</strong>hysical (Layer 1)</li>
                            <li><strong>D</strong>ata Link (Layer 2)</li>
                            <li><strong>N</strong>etwork (Layer 3)</li>
                            <li><strong>T</strong>ransport (Layer 4)</li>
                            <li><strong>S</strong>ession (Layer 5)</li>
                            <li><strong>P</strong>resentation (Layer 6)</li>
                            <li><strong>A</strong>pplication (Layer 7)</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Final Interview Tip -->
                <div class="callout callout-interview">
                    <div class="callout-title">ğŸ’¡ Interview Tip</div>
                    <div class="callout-content">
                        <p><strong>Common Question:</strong> "What's the difference between a Layer 3 firewall and a Layer 7 firewall?"</p>
                        <p><strong>Answer:</strong></p>
                        <ul>
                            <li><strong>Layer 3 Firewall:</strong> Makes decisions based on IP addresses and ports only. Fast but limited visibility. Example: Router ACLs, packet filter firewalls.</li>
                            <li><strong>Layer 7 Firewall:</strong> Can inspect application-level data (HTTP headers, SQL queries, etc.). Slower but much more granular control. Can identify applications regardless of port. Example: Next-Gen Firewalls (Palo Alto, Fortinet).</li>
                        </ul>
                        <p><strong>Follow-up:</strong> "Modern NGFWs actually operate across Layers 3-7, combining packet filtering, stateful inspection, and deep packet inspection for comprehensive security."</p>
                    </div>
                </div>
                
                <!-- Page Navigation -->
                <nav class="page-navigation">
                    <a href="index.html" class="page-nav-btn prev">
                        <span class="page-nav-arrow">â†</span>
                        <div class="page-nav-text">
                            <span class="page-nav-label">Previous</span>
                            <span class="page-nav-title">Home</span>
                        </div>
                    </a>
                    <a href="1-2-tcp-ip-protocols.html" class="page-nav-btn next">
                        <span class="page-nav-arrow">â†’</span>
                        <div class="page-nav-text">
                            <span class="page-nav-label">Next</span>
                            <span class="page-nav-title">TCP/IP Stack & Protocols</span>
                        </div>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    
    <!-- Search Modal -->
    <div class="search-modal" id="searchModal">
        <div class="search-modal-content">
            <input type="text" class="search-modal-input" id="searchModalInput" placeholder="Search documentation...">
            <div class="search-results" id="searchResults"></div>
        </div>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
