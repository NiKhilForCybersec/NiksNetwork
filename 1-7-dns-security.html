<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DNS Security - Complete guide to DNS attacks, DNSSEC, DNS filtering, and protective DNS">
    <title>DNS Security | Network Security Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”’</text></svg>">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">ğŸ”’</div>
                    <div class="sidebar-logo-text">Network Security<span>Ultimate Guide</span></div>
                </a>
            </div>
            <div class="sidebar-search">
                <input type="text" id="searchInput" placeholder="Search... (Ctrl+K)" autocomplete="off">
            </div>
            <nav class="sidebar-nav" id="sidebarNav">
                <!-- Section 1: Networking Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸŒ</span>Networking Fundamentals</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="1-1-osi-model.html" class="nav-link"><span class="nav-link-number">1.1</span> OSI Model</a>
                        <a href="1-2-tcpip.html" class="nav-link"><span class="nav-link-number">1.2</span> TCP/IP Networking</a>
                        <a href="1-3-ip-addressing.html" class="nav-link"><span class="nav-link-number">1.3</span> IP Addressing & Subnetting</a>
                        <a href="1-4-dns.html" class="nav-link"><span class="nav-link-number">1.4</span> DNS</a>
                        <a href="1-5-routing.html" class="nav-link"><span class="nav-link-number">1.5</span> Routing Protocols</a>
                        <a href="1-6-switching.html" class="nav-link"><span class="nav-link-number">1.6</span> Switching & VLANs</a>
                        <a href="1-7-dns-security.html" class="nav-link"><span class="nav-link-number">1.7</span> DNS Security</a>
                        <a href="1-8-wireless-security.html" class="nav-link"><span class="nav-link-number">1.8</span> Wireless Security</a>
                        <a href="1-9-bgp-security.html" class="nav-link"><span class="nav-link-number">1.9</span> BGP Security</a>
                        <a href="1-10-layer2-security.html" class="nav-link"><span class="nav-link-number">1.10</span> Layer 2 Security</a>
                        <a href="1-11-snmp-security.html" class="nav-link"><span class="nav-link-number">1.11</span> SNMP Security</a>
                        <a href="1-12-aaa-radius-tacacs.html" class="nav-link"><span class="nav-link-number">1.12</span> AAA / RADIUS / TACACS+</a>
                        <a href="1-13-ipv6-security.html" class="nav-link"><span class="nav-link-number">1.13</span> IPv6 Security</a>
                        <a href="1-14-macsec.html" class="nav-link"><span class="nav-link-number">1.14</span> MACsec</a>
                        <a href="1-15-network-taps.html" class="nav-link"><span class="nav-link-number">1.15</span> Network TAPs & Visibility</a>
                        <a href="1-16-doh-dot.html" class="nav-link"><span class="nav-link-number">1.16</span> DoH/DoT Security</a>
                    </div>
                </div>

                <!-- Section 2: Firewalls -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ”¥</span>Firewalls</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="2-1-firewall-fundamentals.html" class="nav-link"><span class="nav-link-number">2.1</span> Firewall Fundamentals</a>
                        <a href="2-4-palo-alto.html" class="nav-link"><span class="nav-link-number">2.4</span> Palo Alto Networks</a>
                        <a href="2-5-cisco-firepower.html" class="nav-link"><span class="nav-link-number">2.5</span> Cisco Firepower/ASA</a>
                        <a href="2-6-fortigate.html" class="nav-link"><span class="nav-link-number">2.6</span> Fortinet FortiGate</a>
                        <a href="2-7-checkpoint.html" class="nav-link"><span class="nav-link-number">2.7</span> Check Point</a>
                        <a href="2-8-cloud-firewalls.html" class="nav-link"><span class="nav-link-number">2.8</span> Cloud Firewalls</a>
                        <a href="2-9-firewall-ha.html" class="nav-link"><span class="nav-link-number">2.9</span> High Availability</a>
                        <a href="2-10-firewall-logging.html" class="nav-link"><span class="nav-link-number">2.10</span> Firewall Logging</a>
                        <a href="2-11-firewall-troubleshooting.html" class="nav-link"><span class="nav-link-number">2.11</span> Troubleshooting</a>
                        <a href="2-12-ddos-protection.html" class="nav-link"><span class="nav-link-number">2.12</span> DDoS Protection</a>
                    </div>
                </div>

                <!-- Section 3: Web Proxy -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸŒ</span>Web Proxy & TLS</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="3-1-proxy-fundamentals.html" class="nav-link"><span class="nav-link-number">3.1</span> Proxy Fundamentals</a>
                        <a href="3-2-ssl-inspection.html" class="nav-link"><span class="nav-link-number">3.2</span> SSL/TLS Inspection</a>
                        <a href="3-3-url-filtering.html" class="nav-link"><span class="nav-link-number">3.3</span> URL Filtering</a>
                        <a href="3-4-squid.html" class="nav-link"><span class="nav-link-number">3.4</span> Squid Proxy</a>
                        <a href="3-5-tls-hardening.html" class="nav-link"><span class="nav-link-number">3.5</span> TLS Hardening</a>
                    </div>
                </div>

                <!-- Section 4: WAF & API Security -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ›¡ï¸</span>WAF & API Security</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="4-1-waf-fundamentals.html" class="nav-link"><span class="nav-link-number">4.1</span> WAF Fundamentals</a>
                        <a href="4-2-owasp-top10.html" class="nav-link"><span class="nav-link-number">4.2</span> OWASP Top 10</a>
                        <a href="4-3-aws-waf.html" class="nav-link"><span class="nav-link-number">4.3</span> AWS WAF</a>
                        <a href="4-4-azure-waf.html" class="nav-link"><span class="nav-link-number">4.4</span> Azure WAF</a>
                        <a href="4-5-cloudflare-waf.html" class="nav-link"><span class="nav-link-number">4.5</span> Cloudflare WAF</a>
                        <a href="4-6-api-security.html" class="nav-link"><span class="nav-link-number">4.6</span> API Security</a>
                    </div>
                </div>

                <!-- Section 5: IDS/IPS & NDR -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸš¨</span>IDS/IPS & NDR</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="5-1-ids-ips-fundamentals.html" class="nav-link"><span class="nav-link-number">5.1</span> IDS/IPS Fundamentals</a>
                        <a href="5-2-snort-suricata.html" class="nav-link"><span class="nav-link-number">5.2</span> Snort & Suricata</a>
                        <a href="5-3-zeek.html" class="nav-link"><span class="nav-link-number">5.3</span> Zeek (Bro)</a>
                        <a href="5-4-ids-tuning.html" class="nav-link"><span class="nav-link-number">5.4</span> IDS/IPS Tuning</a>
                        <a href="5-5-ndr.html" class="nav-link"><span class="nav-link-number">5.5</span> Network Detection & Response</a>
                    </div>
                </div>

                <!-- Section 6: VPN & WAN -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ”</span>VPN & SD-WAN</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="6-1-vpn-fundamentals.html" class="nav-link"><span class="nav-link-number">6.1</span> VPN Fundamentals</a>
                        <a href="6-2-ipsec.html" class="nav-link"><span class="nav-link-number">6.2</span> IPSec Deep Dive</a>
                        <a href="6-3-ssl-vpn.html" class="nav-link"><span class="nav-link-number">6.3</span> SSL VPN</a>
                        <a href="6-4-site-to-site.html" class="nav-link"><span class="nav-link-number">6.4</span> Site-to-Site VPN</a>
                        <a href="6-5-vpn-troubleshooting.html" class="nav-link"><span class="nav-link-number">6.5</span> VPN Troubleshooting</a>
                        <a href="6-6-sdwan-security.html" class="nav-link"><span class="nav-link-number">6.6</span> SD-WAN Security</a>
                    </div>
                </div>

                <!-- Section 7: Network Architecture -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ—ï¸</span>Network Architecture</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="7-1-network-segmentation.html" class="nav-link"><span class="nav-link-number">7.1</span> Network Segmentation</a>
                        <a href="7-2-zero-trust.html" class="nav-link"><span class="nav-link-number">7.2</span> Zero Trust Network</a>
                        <a href="7-3-zscaler-platform.html" class="nav-link"><span class="nav-link-number">7.3</span> Zscaler Platform</a>
                        <a href="7-4-threat-intel.html" class="nav-link"><span class="nav-link-number">7.4</span> Network Threat Intelligence</a>
                        <a href="7-5-active-directory.html" class="nav-link"><span class="nav-link-number">7.5</span> Active Directory Security</a>
                        <a href="7-7-nac.html" class="nav-link"><span class="nav-link-number">7.7</span> Network Access Control</a>
                        <a href="7-8-datacenter-security.html" class="nav-link"><span class="nav-link-number">7.8</span> Data Center Security</a>
                        <a href="7-9-network-automation.html" class="nav-link"><span class="nav-link-number">7.9</span> Network Automation Security</a>
                    </div>
                </div>

                <!-- Section 8: Load Balancers -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">âš–ï¸</span>Load Balancers</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="8-1-lb-fundamentals.html" class="nav-link"><span class="nav-link-number">8.1</span> Load Balancer Fundamentals</a>
                        <a href="8-2-f5-bigip.html" class="nav-link"><span class="nav-link-number">8.2</span> F5 BIG-IP</a>
                        <a href="8-3-aws-elb.html" class="nav-link"><span class="nav-link-number">8.3</span> AWS ALB/NLB</a>
                        <a href="8-4-haproxy.html" class="nav-link"><span class="nav-link-number">8.4</span> HAProxy</a>
                        <a href="8-5-nginx.html" class="nav-link"><span class="nav-link-number">8.5</span> NGINX</a>
                    </div>
                </div>

                <!-- Section 10: SIEM -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ“Š</span>SIEM & Log Analysis</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="10-1-siem-fundamentals.html" class="nav-link"><span class="nav-link-number">10.1</span> SIEM Fundamentals</a>
                        <a href="10-2-splunk.html" class="nav-link"><span class="nav-link-number">10.2</span> Splunk</a>
                        <a href="10-3-microsoft-sentinel.html" class="nav-link"><span class="nav-link-number">10.3</span> Microsoft Sentinel</a>
                        <a href="10-4-elastic-security.html" class="nav-link"><span class="nav-link-number">10.4</span> Elastic Security</a>
                    </div>
                </div>

                <!-- Section 12: Network Operations -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ”§</span>Network Operations</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="12-1-methodology.html" class="nav-link"><span class="nav-link-number">12.1</span> Troubleshooting Methodology</a>
                        <a href="12-2-incident-response.html" class="nav-link"><span class="nav-link-number">12.2</span> Network Incident Response</a>
                        <a href="12-3-log-analysis.html" class="nav-link"><span class="nav-link-number">12.3</span> Network Log Analysis</a>
                        <a href="12-4-packet-capture.html" class="nav-link"><span class="nav-link-number">12.4</span> Packet Capture & Analysis</a>
                        <a href="12-5-threat-hunting.html" class="nav-link"><span class="nav-link-number">12.5</span> Network Threat Hunting</a>
                        <a href="12-6-netflow.html" class="nav-link"><span class="nav-link-number">12.6</span> NetFlow & sFlow</a>
                        <a href="12-7-network-forensics.html" class="nav-link"><span class="nav-link-number">12.7</span> Network Forensics</a>
                        <a href="12-8-network-pentesting.html" class="nav-link"><span class="nav-link-number">12.8</span> Network Pentesting</a>
                    </div>
                </div>

                <!-- Section 13: Compliance -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ“‹</span>Compliance</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="13-1-compliance-frameworks.html" class="nav-link"><span class="nav-link-number">13.1</span> Network Compliance</a>
                        <a href="13-2-vulnerability-management.html" class="nav-link"><span class="nav-link-number">13.2</span> Vulnerability Scanning</a>
                    </div>
                </div>

                <!-- Section 14: Cloud Network Security -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">â˜ï¸</span>Cloud Network Security</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="14-1-cloud-security.html" class="nav-link"><span class="nav-link-number">14.1</span> Cloud Network Fundamentals</a>
                        <a href="14-2-aws-security.html" class="nav-link"><span class="nav-link-number">14.2</span> AWS Network Security</a>
                        <a href="14-3-azure-security.html" class="nav-link"><span class="nav-link-number">14.3</span> Azure Network Security</a>
                        <a href="14-4-gcp-security.html" class="nav-link"><span class="nav-link-number">14.4</span> GCP Network Security</a>
                        <a href="14-5-container-security.html" class="nav-link"><span class="nav-link-number">14.5</span> Container Network Security</a>
                        <a href="14-6-casb.html" class="nav-link"><span class="nav-link-number">14.6</span> CASB</a>
                        <a href="14-7-aws-vpc-deep-dive.html" class="nav-link"><span class="nav-link-number">14.7</span> AWS VPC Deep Dive</a>
                        <a href="14-8-azure-networking.html" class="nav-link"><span class="nav-link-number">14.8</span> Azure Networking Deep Dive</a>
                        <a href="14-9-service-mesh.html" class="nav-link"><span class="nav-link-number">14.9</span> Service Mesh Security</a>
                        <a href="14-10-kubernetes-networking.html" class="nav-link"><span class="nav-link-number">14.10</span> Kubernetes Networking</a>
                    </div>
                </div>

                <!-- Section 23: IoT/OT -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ“¡</span>IoT/OT Security</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="23-1-iot-security.html" class="nav-link"><span class="nav-link-number">23.1</span> IoT Network Security</a>
                    </div>
                </div>

                <!-- Section 15: Resources -->
                <div class="nav-section">
                    <div class="nav-section-header" onclick="toggleSection(this)">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ“š</span>Resources</div>
                        <span class="nav-section-toggle">â–¼</span>
                    </div>
                    <div class="nav-section-content">
                        <a href="15-2-interview-questions.html" class="nav-link"><span class="nav-link-number">15.2</span> Interview Questions</a>
                        <a href="15-4-cheat-sheets.html" class="nav-link"><span class="nav-link-number">15.4</span> Command Cheat Sheets</a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <main class="main-content">
            <header class="content-header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">â˜°</button>
                    <div class="breadcrumb">
                        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item">Networking</span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-current">DNS Security</span>
                    </div>
                </div>
            </header>
            
            <div class="content-body">
                <h1>DNS Security</h1>
                
                <div class="overview-box">
                    <div class="overview-title">ğŸ“‹ What You'll Learn</div>
                    <div class="overview-content">
                        <p>DNS is critical infrastructure but was designed without security in mind. Understanding DNS threats and protections is essential for both defense and detection.</p>
                        <ul>
                            <li>Common DNS attacks</li>
                            <li>DNSSEC validation</li>
                            <li>DNS over HTTPS/TLS (DoH/DoT)</li>
                            <li>Protective DNS services</li>
                            <li>DNS tunneling detection</li>
                        </ul>
                    </div>
                </div>
                
                <h2>DNS Attack Types</h2>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Attack</th>
                                <th>Description</th>
                                <th>Detection/Prevention</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>DNS Spoofing/Cache Poisoning</strong></td>
                                <td>Inject false DNS records into cache</td>
                                <td>DNSSEC, randomized source ports</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Tunneling</strong></td>
                                <td>Exfiltrate data or C2 via DNS queries</td>
                                <td>Monitor query length/volume, block TXT</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Hijacking</strong></td>
                                <td>Modify DNS settings on device/router</td>
                                <td>Monitor DNS server changes, DNSSEC</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Amplification DDoS</strong></td>
                                <td>Spoof source, trigger large responses</td>
                                <td>Rate limiting, RRL, disable recursion</td>
                            </tr>
                            <tr>
                                <td><strong>Typosquatting</strong></td>
                                <td>Register similar domains (gooogle.com)</td>
                                <td>Domain monitoring, user training</td>
                            </tr>
                            <tr>
                                <td><strong>DNS Rebinding</strong></td>
                                <td>Bypass same-origin policy</td>
                                <td>DNS pinning, internal DNS filtering</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2>DNS Tunneling Detection</h2>
                
                <div class="ascii-diagram">
                    <div class="ascii-diagram-title">DNS Tunneling Indicators</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DNS TUNNELING INDICATORS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  NORMAL DNS QUERY:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ www.example.com                                                     â”‚    â”‚
â”‚  â”‚ Length: 15 characters                                               â”‚    â”‚
â”‚  â”‚ Record: A                                                           â”‚    â”‚
â”‚  â”‚ Frequency: Normal                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  DNS TUNNELING QUERY:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ dGhpcyBpcyBleGZpbHRyYXRlZCBkYXRh.tunnel.evil.com                   â”‚    â”‚
â”‚  â”‚ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                               â”‚    â”‚
â”‚  â”‚ Base64 encoded data being exfiltrated                              â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚ Length: 52 characters  âš ï¸  ABNORMALLY LONG                         â”‚    â”‚
â”‚  â”‚ Record: TXT            âš ï¸  UNUSUAL RECORD TYPE                     â”‚    â”‚
â”‚  â”‚ Frequency: High        âš ï¸  MANY QUERIES TO SAME DOMAIN             â”‚    â”‚
â”‚  â”‚ Entropy: High          âš ï¸  RANDOM-LOOKING SUBDOMAIN                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  DETECTION THRESHOLDS:                                                      â”‚
â”‚  â€¢ Query length > 50 characters                                            â”‚
â”‚  â€¢ Subdomain length > 30 characters                                        â”‚
â”‚  â€¢ High volume to single domain (>100/hour from one host)                  â”‚
â”‚  â€¢ TXT or NULL record queries                                              â”‚
â”‚  â€¢ High entropy subdomains                                                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <h2>Protective DNS Services</h2>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>Type</th>
                                <th>Features</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Cisco Umbrella</strong></td>
                                <td>Enterprise</td>
                                <td>DNS filtering, proxy, CASB</td>
                            </tr>
                            <tr>
                                <td><strong>Cloudflare Gateway</strong></td>
                                <td>Enterprise</td>
                                <td>DNS filtering, Zero Trust</td>
                            </tr>
                            <tr>
                                <td><strong>Infoblox BloxOne</strong></td>
                                <td>Enterprise</td>
                                <td>DDI + threat defense</td>
                            </tr>
                            <tr>
                                <td><strong>CISA Protective DNS</strong></td>
                                <td>Government</td>
                                <td>Free for federal agencies</td>
                            </tr>
                            <tr>
                                <td><strong>Quad9 (9.9.9.9)</strong></td>
                                <td>Free</td>
                                <td>Threat blocking, privacy-focused</td>
                            </tr>
                            <tr>
                                <td><strong>Cloudflare (1.1.1.1)</strong></td>
                                <td>Free</td>
                                <td>Fast, privacy-focused, malware blocking option</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2>DNS Security Commands</h2>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">DNS Security Analysis</span>
                        <button class="code-copy-btn">ğŸ“‹ Copy</button>
                    </div>
                    <pre><code><span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># CHECK DNSSEC</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Check if domain has DNSSEC</span>
<span class="token-command">dig</span> +dnssec example.com

<span class="token-comment"># Look for RRSIG records (signatures)</span>
<span class="token-command">dig</span> +short DNSKEY example.com

<span class="token-comment"># Validate DNSSEC chain</span>
<span class="token-command">delv</span> @8.8.8.8 example.com

<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># DNS TUNNELING DETECTION</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Find long DNS queries in logs</span>
<span class="token-command">grep</span> -E "query:.{50,}" /var/log/named/query.log

<span class="token-comment"># Count queries per domain</span>
<span class="token-command">cat</span> dns.log | awk '{print $NF}' | sort | uniq -c | sort -rn | head

<span class="token-comment"># Find TXT record queries (common for tunneling)</span>
<span class="token-command">grep</span> "type=TXT" /var/log/named/query.log

<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># RESPONSE POLICY ZONE (RPZ) - SINKHOLE</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># In named.conf</span>
zone "rpz.local" {
    type master;
    file "/etc/bind/db.rpz";
    allow-query { any; };
};

<span class="token-comment"># In db.rpz - sinkhole malicious domain</span>
evil-domain.com     CNAME   .            <span class="token-comment"># Block (NXDOMAIN)</span>
*.evil-domain.com   CNAME   .            <span class="token-comment"># Block subdomains</span>
malware.bad.com     A       10.0.0.1     <span class="token-comment"># Redirect to sinkhole</span></code></pre>
                </div>
                
                <h2>DoH/DoT (Encrypted DNS)</h2>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Protocol</th>
                                <th>Port</th>
                                <th>Pros</th>
                                <th>Cons</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>DNS (Traditional)</strong></td>
                                <td>53/UDP</td>
                                <td>Fast, simple</td>
                                <td>No encryption, easy to monitor/block</td>
                            </tr>
                            <tr>
                                <td><strong>DoT (DNS over TLS)</strong></td>
                                <td>853/TCP</td>
                                <td>Encrypted, dedicated port</td>
                                <td>Easy to block (known port)</td>
                            </tr>
                            <tr>
                                <td><strong>DoH (DNS over HTTPS)</strong></td>
                                <td>443/TCP</td>
                                <td>Encrypted, hard to block</td>
                                <td>Bypasses enterprise DNS controls</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="callout callout-warning">
                    <div class="callout-title">âš ï¸ DoH Security Concerns</div>
                    <div class="callout-content">
                        <ul>
                            <li><strong>Bypasses enterprise DNS:</strong> Users/malware can bypass filtering</li>
                            <li><strong>Reduced visibility:</strong> Can't monitor DNS queries</li>
                            <li><strong>Block known DoH providers:</strong> At firewall level</li>
                            <li><strong>Use canary domain:</strong> Detect DoH bypass attempts</li>
                            <li><strong>GPO control:</strong> Disable DoH in browsers via policy</li>
                        </ul>
                    </div>
                </div>
                
                <div class="callout callout-interview">
                    <div class="callout-title">ğŸ’¡ Interview Tip</div>
                    <div class="callout-content">
                        <p><strong>Question:</strong> "How would you detect DNS tunneling?"</p>
                        <p><strong>Answer:</strong> "I'd look for several indicators: First, unusually long DNS queries - normal queries are short, but tunneling encodes data in subdomains creating 50+ character queries. Second, high volume of queries to a single domain from one host - legitimate browsing queries many domains, but tunneling repeatedly hits one. Third, unusual record types like TXT or NULL which can carry more data. Fourth, high entropy in subdomains - random-looking strings instead of readable names. For detection, I'd use tools like Zeek to log DNS metadata, then query in the SIEM for these patterns. Protective DNS services like Cisco Umbrella can also detect and block known tunneling domains."</p>
                    </div>
                </div>
                
                <nav class="page-navigation">
                    <a href="1-4-dns.html" class="page-nav-btn prev">
                        <span class="page-nav-arrow">â†</span>
                        <div class="page-nav-text">
                            <span class="page-nav-label">Previous</span>
                            <span class="page-nav-title">DNS Basics</span>
                        </div>
                    </a>
                    <a href="2-1-firewall-fundamentals.html" class="page-nav-btn next">
                        <span class="page-nav-arrow">â†’</span>
                        <div class="page-nav-text">
                            <span class="page-nav-label">Next</span>
                            <span class="page-nav-title">Firewall Fundamentals</span>
                        </div>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
