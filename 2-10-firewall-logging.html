<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Firewall Logging & Monitoring - Complete guide to firewall logs, SIEM integration, and security monitoring">
    <title>Firewall Logging | Network Security Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”’</text></svg>">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="sidebar-logo-icon">ğŸ”’</div>
                    <div class="sidebar-logo-text">Network Security<span>Ultimate Guide</span></div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section active">
                    <div class="nav-section-header">
                        <div class="nav-section-title"><span class="nav-section-icon">ğŸ›¡ï¸</span>Firewalls</div>
                    </div>
                    <div class="nav-section-content">
                        <a href="2-1-firewall-fundamentals.html" class="nav-link"><span class="nav-link-number">2.1</span> Fundamentals</a>
                        <a href="2-9-firewall-ha.html" class="nav-link"><span class="nav-link-number">2.9</span> High Availability</a>
                        <a href="2-10-firewall-logging.html" class="nav-link active"><span class="nav-link-number">2.10</span> Logging</a>
                    </div>
                </div>
            </nav>
        </aside>
        
        <main class="main-content">
            <header class="content-header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">â˜°</button>
                    <div class="breadcrumb">
                        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item">Firewalls</span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-current">Logging</span>
                    </div>
                </div>
            </header>
            
            <div class="content-body">
                <h1>Firewall Logging & Monitoring</h1>
                
                <div class="overview-box">
                    <div class="overview-title">ğŸ“‹ What You'll Learn</div>
                    <div class="overview-content">
                        <p>Firewall logs are critical for security monitoring, incident response, and compliance. Understanding log types, formats, and how to analyze them is essential for security operations.</p>
                        <ul>
                            <li>Types of firewall logs</li>
                            <li>Log forwarding to SIEM</li>
                            <li>Key fields to monitor</li>
                            <li>Common detection use cases</li>
                            <li>Log retention requirements</li>
                        </ul>
                    </div>
                </div>
                
                <h2>Log Types</h2>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Log Type</th>
                                <th>Content</th>
                                <th>Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Traffic</strong></td>
                                <td>Allow/deny decisions, IP, port, bytes</td>
                                <td>Security monitoring, troubleshooting</td>
                            </tr>
                            <tr>
                                <td><strong>Threat</strong></td>
                                <td>IPS alerts, malware, vulnerabilities</td>
                                <td>Threat detection, incident response</td>
                            </tr>
                            <tr>
                                <td><strong>URL</strong></td>
                                <td>Web requests, categories, actions</td>
                                <td>Web security, policy enforcement</td>
                            </tr>
                            <tr>
                                <td><strong>User-ID</strong></td>
                                <td>User-to-IP mappings</td>
                                <td>Attribution, compliance</td>
                            </tr>
                            <tr>
                                <td><strong>System</strong></td>
                                <td>Config changes, HA events, errors</td>
                                <td>Audit, troubleshooting</td>
                            </tr>
                            <tr>
                                <td><strong>Authentication</strong></td>
                                <td>Admin/VPN login attempts</td>
                                <td>Access monitoring, brute force detection</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2>Log Forwarding Architecture</h2>
                
                <div class="ascii-diagram">
                    <div class="ascii-diagram-title">Firewall Log Collection</div>
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LOG COLLECTION ARCHITECTURE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  FIREWALLS                          COLLECTION              ANALYSIS        â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Palo Alto   â”‚â”€â”€â”€Syslog (UDP)â”€â”€â”€â–ºâ”‚             â”‚        â”‚             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚             â”‚        â”‚             â”‚   â”‚
â”‚                                    â”‚   SYSLOG    â”‚        â”‚             â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   SERVER    â”‚        â”‚    SIEM     â”‚   â”‚
â”‚  â”‚ Fortinet    â”‚â”€â”€â”€Syslog (TCP)â”€â”€â”€â–ºâ”‚     or      â”‚â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  (Splunk,   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  LOG MGMT   â”‚        â”‚  Sentinel)  â”‚   â”‚
â”‚                                    â”‚             â”‚        â”‚             â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚             â”‚        â”‚             â”‚   â”‚
â”‚  â”‚ Cisco       â”‚â”€â”€â”€Syslog (TLS)â”€â”€â”€â–ºâ”‚             â”‚        â”‚             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  PROTOCOLS:                                                                 â”‚
â”‚  â€¢ Syslog (UDP 514) - Fast, unreliable                                     â”‚
â”‚  â€¢ Syslog (TCP 514) - Reliable delivery                                    â”‚
â”‚  â€¢ Syslog over TLS (TCP 6514) - Encrypted                                  â”‚
â”‚  â€¢ API/HTTPS - Palo Alto Cortex, vendor-specific                           â”‚
â”‚                                                                              â”‚
â”‚  BEST PRACTICE:                                                             â”‚
â”‚  Use TCP with TLS for production, ensure log source is reliable            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                </div>
                
                <h2>Key Fields to Monitor</h2>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Detection Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>action</strong></td>
                                <td>allow, deny, drop, reset</td>
                                <td>Policy violations, blocked threats</td>
                            </tr>
                            <tr>
                                <td><strong>src_ip / dst_ip</strong></td>
                                <td>Source and destination IP</td>
                                <td>Lateral movement, C2 communication</td>
                            </tr>
                            <tr>
                                <td><strong>src_port / dst_port</strong></td>
                                <td>Source and destination port</td>
                                <td>Unusual services, port scanning</td>
                            </tr>
                            <tr>
                                <td><strong>bytes_sent / bytes_recv</strong></td>
                                <td>Data transferred</td>
                                <td>Data exfiltration</td>
                            </tr>
                            <tr>
                                <td><strong>app</strong></td>
                                <td>Application identified</td>
                                <td>Shadow IT, risky applications</td>
                            </tr>
                            <tr>
                                <td><strong>user</strong></td>
                                <td>Username (if User-ID enabled)</td>
                                <td>User attribution, insider threat</td>
                            </tr>
                            <tr>
                                <td><strong>threat_name</strong></td>
                                <td>IPS signature, malware name</td>
                                <td>Active threats, IOC matching</td>
                            </tr>
                            <tr>
                                <td><strong>url_category</strong></td>
                                <td>URL category classification</td>
                                <td>Malware sites, policy violations</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2>Detection Use Cases</h2>
                
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">Common Detection Queries (Pseudo-code)</span>
                        <button class="code-copy-btn">ğŸ“‹ Copy</button>
                    </div>
                    <pre><code><span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># PORT SCANNING DETECTION</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Alert when single source hits many ports on single destination</span>
WHERE action = "deny"
GROUP BY src_ip, dst_ip
HAVING count(DISTINCT dst_port) > 20 
  AND timespan < 1 minute

<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># POTENTIAL DATA EXFILTRATION</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Large outbound transfers to external IPs</span>
WHERE direction = "outbound"
  AND dst_ip NOT IN internal_ranges
  AND bytes_sent > 100MB
  AND dst_port IN (443, 80, 53)

<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># LATERAL MOVEMENT DETECTION</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Internal host connecting to many internal hosts on SMB/RDP</span>
WHERE src_ip IN internal_ranges
  AND dst_ip IN internal_ranges
  AND dst_port IN (445, 3389, 22, 5985)
GROUP BY src_ip
HAVING count(DISTINCT dst_ip) > 10

<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># BLOCKED THREAT PATTERNS</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Hosts repeatedly triggering threat signatures</span>
WHERE log_type = "threat"
  AND action = "blocked"
GROUP BY src_ip
HAVING count(*) > 5 
  AND timespan < 1 hour

<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># C2 BEACONING PATTERN</span>
<span class="token-comment"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="token-comment"># Regular intervals to same destination (beacon behavior)</span>
WHERE direction = "outbound"
GROUP BY src_ip, dst_ip
HAVING stddev(time_between_connections) < 5 seconds
  AND count(*) > 100</code></pre>
                </div>
                
                <h2>Log Retention Requirements</h2>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Compliance</th>
                                <th>Requirement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>PCI-DSS</strong></td>
                                <td>1 year retention, 3 months immediately available</td>
                            </tr>
                            <tr>
                                <td><strong>HIPAA</strong></td>
                                <td>6 years</td>
                            </tr>
                            <tr>
                                <td><strong>SOX</strong></td>
                                <td>7 years</td>
                            </tr>
                            <tr>
                                <td><strong>GDPR</strong></td>
                                <td>As long as necessary (balance privacy)</td>
                            </tr>
                            <tr>
                                <td><strong>Best Practice</strong></td>
                                <td>90 days hot, 1 year warm, 7 years cold</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="callout callout-bestpractice">
                    <div class="callout-title">âœ… Best Practice - Firewall Logging</div>
                    <div class="callout-content">
                        <ul>
                            <li><strong>Log all traffic:</strong> Not just denies - allowed traffic shows lateral movement</li>
                            <li><strong>Enable threat logging:</strong> Capture IPS, URL, malware events</li>
                            <li><strong>Use reliable transport:</strong> TCP with TLS for syslog</li>
                            <li><strong>Include User-ID:</strong> Attribution is critical for investigation</li>
                            <li><strong>Time sync:</strong> NTP on all devices for correlation</li>
                            <li><strong>Test log flow:</strong> Verify logs reach SIEM after changes</li>
                        </ul>
                    </div>
                </div>
                
                <div class="callout callout-interview">
                    <div class="callout-title">ğŸ’¡ Interview Tip</div>
                    <div class="callout-content">
                        <p><strong>Question:</strong> "What firewall logs would you analyze during an incident?"</p>
                        <p><strong>Answer:</strong> "I'd look at traffic logs for connection patterns - source/destination IPs, ports, and data volumes. For the suspected compromised host, I'd search for outbound connections to external IPs (potential C2), internal connections to many hosts (lateral movement), and large data transfers (exfiltration). I'd also check threat logs for any blocked malware or IPS alerts. User-ID logs help identify who was logged in. I'd correlate timestamps across logs to build a timeline of attacker activity."</p>
                    </div>
                </div>
                
                <nav class="page-navigation">
                    <a href="2-9-firewall-ha.html" class="page-nav-btn prev">
                        <span class="page-nav-arrow">â†</span>
                        <div class="page-nav-text">
                            <span class="page-nav-label">Previous</span>
                            <span class="page-nav-title">High Availability</span>
                        </div>
                    </a>
                    <a href="3-1-proxy-fundamentals.html" class="page-nav-btn next">
                        <span class="page-nav-arrow">â†’</span>
                        <div class="page-nav-text">
                            <span class="page-nav-label">Next</span>
                            <span class="page-nav-title">Proxy Fundamentals</span>
                        </div>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    <script src="main.js"></script>
</body>
</html>
