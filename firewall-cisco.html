<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Cisco Firewall Guide - ASA, Firepower Threat Defense (FTD), FMC management, AnyConnect VPN">
  <title>Cisco ASA/FTD Guide | NetSec Guide</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar">
    <a href="index.html" class="navbar-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      NetSec Guide
    </a>
    <ul class="navbar-nav">
      <li><a href="index.html">Home</a></li>
      <li><a href="network-fundamentals.html">Fundamentals</a></li>
      <li><a href="forward-proxy.html">Proxies</a></li>
      <li><a href="firewall-concepts.html" class="active">Firewalls</a></li>
      <li><a href="troubleshooting.html">Troubleshooting</a></li>
    </ul>
    <button class="menu-toggle" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </nav>

  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">On This Page</div>
      <ul class="sidebar-nav">
        <li><a href="#overview">Platform Overview</a></li>
        <li><a href="#asa-config">ASA Configuration</a></li>
        <li><a href="#asa-nat">ASA NAT</a></li>
        <li><a href="#asa-vpn">ASA VPN</a></li>
        <li><a href="#ftd">Firepower (FTD)</a></li>
        <li><a href="#fmc">FMC Management</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ul>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Other Firewalls</div>
      <ul class="sidebar-nav">
        <li><a href="firewall-concepts.html">Firewall Concepts</a></li>
        <li><a href="firewall-paloalto.html">Palo Alto</a></li>
        <li><a href="firewall-fortinet.html">FortiGate</a></li>
        <li><a href="firewall-opensource.html">Open Source</a></li>
      </ul>
    </div>
  </aside>

  <main class="main-content">
    <div class="content-wrapper">
      <nav class="breadcrumb">
        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item"><a href="firewall-concepts.html">Firewalls</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item active">Cisco ASA/FTD</span>
      </nav>

      <h1>Cisco ASA & Firepower Guide</h1>
      <p class="hero-subtitle">
        Complete guide to Cisco security appliances including ASA (Adaptive Security Appliance) 
        and Firepower Threat Defense (FTD) with FMC management.
      </p>

      <!-- Overview -->
      <section>
        <h2 id="overview">Platform Overview</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Platform</th>
                <th>Type</th>
                <th>Management</th>
                <th>Best For</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>ASA</strong></td>
                <td>Traditional stateful firewall</td>
                <td>CLI, ASDM (GUI)</td>
                <td>Legacy, simple deployments</td>
              </tr>
              <tr>
                <td><strong>ASA with FirePOWER</strong></td>
                <td>ASA + Firepower module</td>
                <td>ASDM + FMC</td>
                <td>Hybrid (legacy + NGFW)</td>
              </tr>
              <tr>
                <td><strong>FTD (Firepower Threat Defense)</strong></td>
                <td>Unified NGFW image</td>
                <td>FDM or FMC</td>
                <td>New deployments, full NGFW</td>
              </tr>
              <tr>
                <td><strong>Meraki MX</strong></td>
                <td>Cloud-managed firewall</td>
                <td>Meraki Dashboard</td>
                <td>SMB, distributed sites</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            Cisco Security Platform Evolution
          </div>
          <pre>
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                    CISCO SECURITY PLATFORM EVOLUTION                                │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│   LEGACY                          CURRENT                      FUTURE              │
│   ══════                          ═══════                      ══════              │
│                                                                                     │
│   ┌─────────────┐                ┌─────────────┐              ┌─────────────┐      │
│   │    ASA      │                │    FTD      │              │   Secure    │      │
│   │             │  ────────────► │  (Unified)  │  ──────────► │  Firewall   │      │
│   │ • Stateful  │                │             │              │             │      │
│   │ • VPN       │                │ • Stateful  │              │ • Cloud     │      │
│   │ • NAT       │                │ • NGFW      │              │ • XDR       │      │
│   │             │                │ • IPS       │              │ • SASE      │      │
│   └─────────────┘                │ • AMP       │              └─────────────┘      │
│         +                        │ • URL       │                                    │
│   ┌─────────────┐                │ • VPN       │                                    │
│   │ FirePOWER   │                │ • AnyConnect│                                    │
│   │  (Module)   │                └─────────────┘                                    │
│   │             │                       │                                           │
│   │ • IPS       │                       │                                           │
│   │ • AMP       │                       ▼                                           │
│   │ • URL       │                ┌─────────────┐                                    │
│   └─────────────┘                │    FMC      │                                    │
│                                  │ (Manager)   │                                    │
│   Managed by:                    │             │                                    │
│   ASDM + FMC                     │ Centralized │                                    │
│   (Two systems)                  │ Management  │                                    │
│                                  └─────────────┘                                    │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
          </pre>
        </div>
      </section>

      <!-- ASA Configuration -->
      <section>
        <h2 id="asa-config">ASA Basic Configuration</h2>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Cisco ASA</span>
            <span class="code-filename">Basic ASA Configuration</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>! =============================================================================
! CISCO ASA BASIC CONFIGURATION
! =============================================================================

! Hostname and domain
hostname ASA-FW
domain-name company.com
enable password $ecureP@ss encrypted

! =============================================================================
! INTERFACE CONFIGURATION
! =============================================================================

interface GigabitEthernet0/0
 nameif outside
 security-level 0
 ip address 203.0.113.1 255.255.255.0

interface GigabitEthernet0/1
 nameif inside
 security-level 100
 ip address 192.168.1.1 255.255.255.0

interface GigabitEthernet0/2
 nameif dmz
 security-level 50
 ip address 192.168.10.1 255.255.255.0

! =============================================================================
! ROUTING
! =============================================================================

route outside 0.0.0.0 0.0.0.0 203.0.113.254

! =============================================================================
! OBJECT DEFINITIONS
! =============================================================================

object network Inside-Network
 subnet 192.168.1.0 255.255.255.0

object network DMZ-Network
 subnet 192.168.10.0 255.255.255.0

object network Web-Server
 host 192.168.10.100

object network Mail-Server
 host 192.168.10.101

object-group service Web-Services tcp
 port-object eq www
 port-object eq https

object-group service Mail-Services tcp
 port-object eq smtp
 port-object eq 587
 port-object eq 993

! =============================================================================
! ACCESS CONTROL LISTS
! =============================================================================

! Allow outbound from inside
access-list inside_access_in extended permit ip object Inside-Network any
access-list inside_access_in extended deny ip any any log

! Allow inbound to web server
access-list outside_access_in extended permit tcp any object Web-Server object-group Web-Services
access-list outside_access_in extended permit tcp any object Mail-Server object-group Mail-Services
access-list outside_access_in extended deny ip any any log

! Allow DMZ to access specific inside resources
access-list dmz_access_in extended permit tcp object Web-Server object Inside-Network eq 3306
access-list dmz_access_in extended deny ip any any log

! Apply ACLs to interfaces
access-group inside_access_in in interface inside
access-group outside_access_in in interface outside
access-group dmz_access_in in interface dmz

! =============================================================================
! MANAGEMENT ACCESS
! =============================================================================

http server enable
http 192.168.1.0 255.255.255.0 inside
ssh 192.168.1.0 255.255.255.0 inside
ssh version 2
ssh timeout 30

aaa authentication ssh console LOCAL
username admin password $ecureP@ss privilege 15

! =============================================================================
! LOGGING
! =============================================================================

logging enable
logging timestamp
logging trap informational
logging host inside 192.168.1.50
logging class auth trap alerts</code></pre>
        </div>
      </section>

      <!-- ASA NAT -->
      <section>
        <h2 id="asa-nat">ASA NAT Configuration</h2>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Cisco ASA</span>
            <span class="code-filename">NAT Configuration (8.3+)</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>! =============================================================================
! ASA NAT CONFIGURATION (Version 8.3+)
! =============================================================================

! --- DYNAMIC PAT (Inside to Outside) ---
! All inside hosts share the outside interface IP
object network Inside-Network
 subnet 192.168.1.0 255.255.255.0
 nat (inside,outside) dynamic interface

! --- DYNAMIC PAT with IP Pool ---
object network PAT-Pool
 range 203.0.113.10 203.0.113.20

object network Inside-Network
 subnet 192.168.1.0 255.255.255.0
 nat (inside,outside) dynamic pat-pool PAT-Pool

! --- STATIC NAT (1:1) ---
! Web server accessible from outside
object network Web-Server-Internal
 host 192.168.10.100

object network Web-Server-External
 host 203.0.113.100

nat (dmz,outside) source static Web-Server-Internal Web-Server-External

! --- STATIC PAT (Port Forward) ---
! Forward port 8080 on outside to port 80 on internal server
object network Internal-Web
 host 192.168.10.100

object service HTTP-Alt
 service tcp destination eq 8080

nat (dmz,outside) source static Internal-Web interface service HTTP-Alt www

! --- TWICE NAT (Advanced) ---
! NAT both source and destination
nat (inside,dmz) source static Inside-Network Inside-Network destination static Web-Server-External Web-Server-Internal

! --- NAT EXEMPTION (No NAT for VPN) ---
! Don't NAT traffic destined for VPN networks
object network VPN-Remote-Network
 subnet 10.10.10.0 255.255.255.0

nat (inside,outside) source static Inside-Network Inside-Network destination static VPN-Remote-Network VPN-Remote-Network no-proxy-arp

! =============================================================================
! VERIFY NAT
! =============================================================================
! show nat
! show nat detail
! show xlate
! packet-tracer input inside tcp 192.168.1.10 12345 8.8.8.8 80</code></pre>
        </div>
      </section>

      <!-- ASA VPN -->
      <section>
        <h2 id="asa-vpn">ASA VPN Configuration</h2>

        <h3>Site-to-Site IKEv2 VPN</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Cisco ASA</span>
            <span class="code-filename">Site-to-Site VPN</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>! =============================================================================
! ASA SITE-TO-SITE VPN (IKEv2)
! =============================================================================

! IKEv2 Policy
crypto ikev2 policy 10
 encryption aes-256
 integrity sha256
 group 14
 prf sha256
 lifetime seconds 86400

! IKEv2 Enable on outside interface
crypto ikev2 enable outside

! IPSec Proposal
crypto ipsec ikev2 ipsec-proposal AES256-SHA256
 protocol esp encryption aes-256
 protocol esp integrity sha-256

! Tunnel Group (Connection Profile)
tunnel-group 203.0.113.2 type ipsec-l2l
tunnel-group 203.0.113.2 ipsec-attributes
 ikev2 remote-authentication pre-shared-key SecretKey123!
 ikev2 local-authentication pre-shared-key SecretKey123!

! Crypto Map
crypto map outside_map 10 match address VPN-Traffic
crypto map outside_map 10 set peer 203.0.113.2
crypto map outside_map 10 set ikev2 ipsec-proposal AES256-SHA256
crypto map outside_map interface outside

! Traffic Selector (Interesting Traffic)
access-list VPN-Traffic extended permit ip 192.168.1.0 255.255.255.0 10.10.10.0 255.255.255.0

! NAT Exemption for VPN
object network Local-LAN
 subnet 192.168.1.0 255.255.255.0
object network Remote-LAN
 subnet 10.10.10.0 255.255.255.0

nat (inside,outside) source static Local-LAN Local-LAN destination static Remote-LAN Remote-LAN no-proxy-arp route-lookup</code></pre>
        </div>

        <h3>AnyConnect Remote Access VPN</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Cisco ASA</span>
            <span class="code-filename">AnyConnect VPN</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>! =============================================================================
! ASA ANYCONNECT REMOTE ACCESS VPN
! =============================================================================

! Enable WebVPN
webvpn
 enable outside
 anyconnect image disk0:/anyconnect-win-4.10.pkg
 anyconnect enable
 tunnel-group-list enable

! IP Pool for VPN clients
ip local pool VPN-Pool 10.100.100.10-10.100.100.200 mask 255.255.255.0

! Group Policy
group-policy AnyConnect-Policy internal
group-policy AnyConnect-Policy attributes
 vpn-tunnel-protocol ssl-client
 split-tunnel-policy tunnelspecified
 split-tunnel-network-list value Split-Tunnel-ACL
 dns-server value 192.168.1.10 192.168.1.11
 default-domain value company.com
 address-pools value VPN-Pool

! Split Tunnel ACL (only route these networks through VPN)
access-list Split-Tunnel-ACL standard permit 192.168.0.0 255.255.0.0
access-list Split-Tunnel-ACL standard permit 10.0.0.0 255.0.0.0

! Tunnel Group (Connection Profile)
tunnel-group AnyConnect-Users type remote-access
tunnel-group AnyConnect-Users general-attributes
 address-pool VPN-Pool
 default-group-policy AnyConnect-Policy
 authentication-server-group LOCAL
tunnel-group AnyConnect-Users webvpn-attributes
 group-alias "Corporate VPN" enable

! User Authentication
username vpnuser password $ecureP@ss privilege 0
username vpnuser attributes
 service-type remote-access

! NAT Exemption for VPN clients
object network VPN-Clients
 subnet 10.100.100.0 255.255.255.0

nat (inside,outside) source static Inside-Network Inside-Network destination static VPN-Clients VPN-Clients no-proxy-arp route-lookup

! Allow VPN client traffic
access-list outside_access_in extended permit ip object VPN-Clients object Inside-Network</code></pre>
        </div>
      </section>

      <!-- FTD -->
      <section>
        <h2 id="ftd">Firepower Threat Defense (FTD)</h2>
        <p>
          FTD combines ASA firewall capabilities with Firepower NGFW features in a unified image. 
          It can be managed locally (FDM) or centrally (FMC).
        </p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Feature</th>
                <th>ASA</th>
                <th>FTD</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Stateful Firewall</strong></td>
                <td><span class="feature-yes">Yes</span></td>
                <td><span class="feature-yes">Yes</span></td>
              </tr>
              <tr>
                <td><strong>Application Visibility</strong></td>
                <td><span class="feature-no">No</span></td>
                <td><span class="feature-yes">Yes</span></td>
              </tr>
              <tr>
                <td><strong>IPS/IDS</strong></td>
                <td>Module required</td>
                <td><span class="feature-yes">Built-in</span></td>
              </tr>
              <tr>
                <td><strong>AMP (Malware)</strong></td>
                <td>Module required</td>
                <td><span class="feature-yes">Built-in</span></td>
              </tr>
              <tr>
                <td><strong>URL Filtering</strong></td>
                <td>Module required</td>
                <td><span class="feature-yes">Built-in</span></td>
              </tr>
              <tr>
                <td><strong>SSL Decryption</strong></td>
                <td>Limited</td>
                <td><span class="feature-yes">Full</span></td>
              </tr>
              <tr>
                <td><strong>Management</strong></td>
                <td>CLI, ASDM</td>
                <td>FDM, FMC, CDO</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>FTD CLI Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">FTD</span>
            <span class="code-filename">FTD CLI Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>! =============================================================================
! FTD CLI COMMANDS (Diagnostic CLI - "system support diagnostic-cli")
! =============================================================================

! Enter diagnostic CLI from FTD CLI
> system support diagnostic-cli
firepower# enable

! Most ASA commands work in diagnostic CLI
firepower# show interface ip brief
firepower# show route
firepower# show conn
firepower# show xlate
firepower# show access-list
firepower# packet-tracer input inside tcp 192.168.1.10 12345 8.8.8.8 80

! =============================================================================
! FTD-SPECIFIC COMMANDS (CLISH)
! =============================================================================

! Show system status
> show version
> show managers
> show network

! Show running configuration summary
> show running-config

! Interface information
> show interface

! High availability status
> show high-availability config
> show failover state

! Deployment status
> show deploy

! Capture traffic
> capture CAP interface inside match ip host 192.168.1.10 any
> show capture CAP
> copy /pcap capture:CAP tftp://192.168.1.50/capture.pcap

! Debug (use carefully)
> debug connection-policy-implementation
> undebug all

! =============================================================================
! TROUBLESHOOTING COMMANDS
! =============================================================================

! Check Snort engine status
> show snort statistics

! Connection events
> show conn all

! NAT translations
firepower# show xlate

! Packet tracer (most useful troubleshooting tool)
firepower# packet-tracer input inside tcp 192.168.1.10 12345 8.8.8.8 443 detailed

! CPU and memory
> show cpu usage
> show memory

! Logs
> show log</code></pre>
        </div>
      </section>

      <!-- FMC -->
      <section>
        <h2 id="fmc">Firepower Management Center (FMC)</h2>
        <p>
          FMC provides centralized management for multiple FTD devices with advanced 
          features like correlation, reporting, and automated response.
        </p>

        <div class="card-grid">
          <div class="card">
            <h4>Policy Management</h4>
            <p>Centralized access control, IPS, malware, and URL policies deployed to multiple FTDs.</p>
          </div>
          <div class="card">
            <h4>Threat Intelligence</h4>
            <p>Integration with Talos, automatic signature updates, and Security Intelligence feeds.</p>
          </div>
          <div class="card">
            <h4>Analysis & Reporting</h4>
            <p>Event correlation, dashboards, compliance reports, and forensic investigation tools.</p>
          </div>
          <div class="card">
            <h4>Network Discovery</h4>
            <p>Automatic host profiling, vulnerability mapping, and application detection.</p>
          </div>
        </div>

        <h3>FMC Access Control Policy Structure</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">FMC Policy Hierarchy</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# FMC ACCESS CONTROL POLICY STRUCTURE
# =============================================================================

Access Control Policy: "Corporate-Policy"
│
├── Prefilter Policy (Fast-path / Early drop)
│   ├── Fastpath Rule: Allow established connections
│   └── Block Rule: Block known bad traffic early
│
├── SSL Policy (Decrypt for inspection)
│   ├── Decrypt - Resign: Outbound HTTPS
│   ├── Decrypt - Known Key: Inbound to web servers
│   └── Do Not Decrypt: Banking, healthcare
│
├── Access Control Rules
│   │
│   ├── Rule 1: Block Malware Categories
│   │   Source: Any
│   │   Destination: Any
│   │   Application: Any
│   │   URL Category: Malware, Phishing
│   │   Action: Block
│   │
│   ├── Rule 2: Allow Web Browsing
│   │   Source: Inside-Zone
│   │   Destination: Outside-Zone
│   │   Application: HTTP, HTTPS, SSL
│   │   Action: Allow
│   │   IPS Policy: Balanced Security and Connectivity
│   │   File Policy: Malware Cloud Lookup
│   │
│   ├── Rule 3: Allow Internal to DMZ
│   │   Source: Inside-Zone
│   │   Destination: DMZ-Zone
│   │   Application: Any
│   │   Action: Allow
│   │
│   ├── Rule 4: Allow Inbound Web
│   │   Source: Outside-Zone
│   │   Destination: Web-Server
│   │   Port: 443
│   │   Action: Allow
│   │   IPS Policy: Security Over Connectivity
│   │
│   └── Default Action: Block All Traffic
│
├── IPS Policy: "Balanced Security and Connectivity"
│   ├── Base Policy: Balanced Security and Connectivity
│   ├── Rules: Drop and Generate Events for High/Critical
│   └── Custom Rules: Block specific CVEs
│
├── File Policy: "Malware Cloud Lookup"
│   ├── Block Malware: All file types
│   ├── Cloud Lookup: Unknown files sent to AMP cloud
│   └── Local Analysis: Spero, dynamic analysis
│
└── Identity Policy (Optional)
    └── AD Realm integration for user-based rules</code></pre>
        </div>
      </section>

      <!-- Troubleshooting -->
      <section>
        <h2 id="troubleshooting">Troubleshooting</h2>

        <div class="accordion">
          <div class="accordion-item">
            <button class="accordion-header">
              Traffic Not Passing Through ASA
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header"><span class="code-lang">ASA</span><button class="copy-btn">Copy</button></div>
                <pre><code>! Packet tracer - Most important tool!
packet-tracer input inside tcp 192.168.1.10 12345 8.8.8.8 80 detailed

! Check active connections
show conn address 192.168.1.10

! Check NAT translations
show xlate local 192.168.1.10

! Check ACL hits
show access-list outside_access_in | include hit

! Check routing
show route | include 8.8.8.8

! Check interface status
show interface ip brief

! Check for drops
show asp drop</code></pre>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header">
              VPN Tunnel Not Establishing
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header"><span class="code-lang">ASA</span><button class="copy-btn">Copy</button></div>
                <pre><code>! Check IKE SA status
show crypto ikev2 sa

! Check IPSec SA
show crypto ipsec sa

! Debug IKE (use carefully!)
debug crypto ikev2 platform 127
debug crypto ikev2 protocol 127

! Common issues:
! 1. Pre-shared key mismatch
! 2. Crypto proposal mismatch (encryption, hash, DH group)
! 3. Traffic selector mismatch
! 4. NAT-T issues (UDP 4500)
! 5. Interesting traffic ACL mismatch

! Verify crypto config
show running-config crypto
show running-config tunnel-group</code></pre>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header">
              FTD Snort/IPS Blocking Traffic
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header"><span class="code-lang">FTD</span><button class="copy-btn">Copy</button></div>
                <pre><code>! Check Snort statistics
> show snort statistics

! Check connection events in FMC:
! Analysis > Connections > Events
! Filter by source/destination IP

! Check intrusion events:
! Analysis > Intrusions > Events

! If rule is blocking legitimate traffic:
! 1. Find the rule SID in intrusion events
! 2. Policy > Access Control > Intrusion Policies
! 3. Edit policy > Rules > Search for SID
! 4. Set action to "Generate Events" (alert only)

! Bypass Snort for troubleshooting (temporary!)
! Create prefilter rule with action "Fastpath"</code></pre>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section>
        <div class="section-divider"><span>Other Firewall Guides</span></div>
        <div class="card-grid">
          <a href="firewall-paloalto.html" class="nav-card card">
            <h4>Palo Alto →</h4>
            <p>App-ID, User-ID, GlobalProtect configuration.</p>
          </a>
          <a href="firewall-fortinet.html" class="nav-card card">
            <h4>FortiGate →</h4>
            <p>FortiOS, Security Fabric, SD-WAN.</p>
          </a>
          <a href="firewall-opensource.html" class="nav-card card">
            <h4>Open Source →</h4>
            <p>pfSense, iptables, Windows Firewall.</p>
          </a>
        </div>
      </section>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-bottom">
      <p>Network Security & Infrastructure Guide</p>
    </div>
  </footer>

  <script src="main.js"></script>
</body>
</html>
