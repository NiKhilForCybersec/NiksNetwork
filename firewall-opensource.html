<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Open Source Firewall Guide - pfSense, OPNsense, iptables, nftables, Windows Firewall configurations and rules">
  <title>Open Source Firewalls | NetSec Guide</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar">
    <a href="index.html" class="navbar-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      NetSec Guide
    </a>
    <ul class="navbar-nav">
      <li><a href="index.html">Home</a></li>
      <li><a href="network-fundamentals.html">Fundamentals</a></li>
      <li><a href="forward-proxy.html">Proxies</a></li>
      <li><a href="firewall-concepts.html" class="active">Firewalls</a></li>
      <li><a href="troubleshooting.html">Troubleshooting</a></li>
    </ul>
    <button class="menu-toggle" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </nav>

  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">On This Page</div>
      <ul class="sidebar-nav">
        <li><a href="#overview">Overview</a></li>
        <li><a href="#iptables">iptables (Linux)</a></li>
        <li><a href="#nftables">nftables (Linux)</a></li>
        <li><a href="#pfsense">pfSense</a></li>
        <li><a href="#opnsense">OPNsense</a></li>
        <li><a href="#windows-firewall">Windows Firewall</a></li>
        <li><a href="#comparison">Comparison</a></li>
      </ul>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Other Firewalls</div>
      <ul class="sidebar-nav">
        <li><a href="firewall-concepts.html">Firewall Concepts</a></li>
        <li><a href="firewall-paloalto.html">Palo Alto</a></li>
        <li><a href="firewall-fortinet.html">FortiGate</a></li>
        <li><a href="firewall-cisco.html">Cisco ASA/FTD</a></li>
      </ul>
    </div>
  </aside>

  <main class="main-content">
    <div class="content-wrapper">
      <nav class="breadcrumb">
        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item"><a href="firewall-concepts.html">Firewalls</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item active">Open Source</span>
      </nav>

      <h1>Open Source Firewall Guide</h1>
      <p class="hero-subtitle">
        Complete guide to open source and built-in firewalls including Linux iptables/nftables, 
        pfSense, OPNsense, and Windows Defender Firewall.
      </p>

      <!-- Overview -->
      <section>
        <h2 id="overview">Overview</h2>
        
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Solution</th>
                <th>Platform</th>
                <th>Type</th>
                <th>Best For</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>iptables</strong></td>
                <td>Linux</td>
                <td>Host-based / Gateway</td>
                <td>Servers, containers, legacy Linux</td>
              </tr>
              <tr>
                <td><strong>nftables</strong></td>
                <td>Linux</td>
                <td>Host-based / Gateway</td>
                <td>Modern Linux, replacing iptables</td>
              </tr>
              <tr>
                <td><strong>pfSense</strong></td>
                <td>FreeBSD</td>
                <td>Network Firewall/Router</td>
                <td>SMB, home lab, branch office</td>
              </tr>
              <tr>
                <td><strong>OPNsense</strong></td>
                <td>FreeBSD</td>
                <td>Network Firewall/Router</td>
                <td>Modern UI, enterprise features</td>
              </tr>
              <tr>
                <td><strong>Windows Firewall</strong></td>
                <td>Windows</td>
                <td>Host-based</td>
                <td>Windows servers/endpoints</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- iptables -->
      <section>
        <h2 id="iptables">iptables (Linux)</h2>
        <p>
          iptables is the traditional Linux firewall using the Netfilter framework. 
          It uses tables, chains, and rules to filter packets.
        </p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            iptables Packet Flow
          </div>
          <pre>
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                           IPTABLES PACKET FLOW                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│                              Incoming Packet                                        │
│                                    │                                                │
│                                    ▼                                                │
│                          ┌─────────────────┐                                        │
│                          │   PREROUTING    │  ← NAT (DNAT), mangle                 │
│                          └────────┬────────┘                                        │
│                                   │                                                 │
│                                   ▼                                                 │
│                          ┌─────────────────┐                                        │
│                          │ Routing Decision │                                       │
│                          └────────┬────────┘                                        │
│                                   │                                                 │
│               ┌───────────────────┼───────────────────┐                             │
│               │                   │                   │                             │
│               ▼                   │                   ▼                             │
│     ┌─────────────────┐           │         ┌─────────────────┐                     │
│     │     INPUT       │           │         │    FORWARD      │                     │
│     │ (local process) │           │         │ (routed traffic)│                     │
│     └────────┬────────┘           │         └────────┬────────┘                     │
│              │                    │                  │                              │
│              ▼                    │                  │                              │
│     ┌─────────────────┐           │                  │                              │
│     │  Local Process  │           │                  │                              │
│     └────────┬────────┘           │                  │                              │
│              │                    │                  │                              │
│              ▼                    │                  │                              │
│     ┌─────────────────┐           │                  │                              │
│     │     OUTPUT      │           │                  │                              │
│     │ (local origin)  │           │                  │                              │
│     └────────┬────────┘           │                  │                              │
│              │                    │                  │                              │
│              └───────────────────►│◄─────────────────┘                              │
│                                   │                                                 │
│                                   ▼                                                 │
│                          ┌─────────────────┐                                        │
│                          │   POSTROUTING   │  ← NAT (SNAT/Masquerade)              │
│                          └────────┬────────┘                                        │
│                                   │                                                 │
│                                   ▼                                                 │
│                              Outgoing Packet                                        │
│                                                                                     │
│   TABLES: filter (default), nat, mangle, raw, security                             │
│   CHAINS: PREROUTING, INPUT, FORWARD, OUTPUT, POSTROUTING                          │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
          </pre>
        </div>

        <h3>Basic iptables Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">iptables Basic Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# IPTABLES BASIC COMMANDS
# =============================================================================

# View current rules
iptables -L -v -n                    # List all rules with details
iptables -L -v -n --line-numbers     # With line numbers
iptables -t nat -L -v -n             # NAT table rules
iptables -S                          # Show rules as commands

# Flush all rules (DANGER - blocks all traffic if policy is DROP)
iptables -F                          # Flush filter table
iptables -t nat -F                   # Flush NAT table
iptables -X                          # Delete custom chains

# Set default policies
iptables -P INPUT DROP               # Drop all incoming by default
iptables -P FORWARD DROP             # Drop all forwarded by default
iptables -P OUTPUT ACCEPT            # Allow all outgoing

# Save and restore rules
iptables-save > /etc/iptables/rules.v4
iptables-restore < /etc/iptables/rules.v4

# On Ubuntu/Debian, persist rules
apt install iptables-persistent
netfilter-persistent save
netfilter-persistent reload</code></pre>
        </div>

        <h3>iptables Rule Examples</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">iptables Server Hardening Rules</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>#!/bin/bash
# =============================================================================
# IPTABLES SERVER HARDENING SCRIPT
# =============================================================================

# Flush existing rules
iptables -F
iptables -t nat -F
iptables -X

# Set default policies
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# Allow loopback
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

# Allow established connections
iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

# Drop invalid packets
iptables -A INPUT -m conntrack --ctstate INVALID -j DROP

# Allow SSH (rate limited)
iptables -A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW \
    -m recent --set --name SSH
iptables -A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW \
    -m recent --update --seconds 60 --hitcount 4 --name SSH -j DROP
iptables -A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW -j ACCEPT

# Allow HTTP/HTTPS
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# Allow ICMP (ping) - rate limited
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT

# Allow DNS responses (if server makes DNS queries)
iptables -A INPUT -p udp --sport 53 -j ACCEPT

# Log dropped packets (limit to avoid log flooding)
iptables -A INPUT -m limit --limit 5/min -j LOG --log-prefix "iptables-dropped: " --log-level 4

# Final drop (explicit)
iptables -A INPUT -j DROP

# =============================================================================
# PROTECTION RULES
# =============================================================================

# Block null packets
iptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP

# Block SYN flood
iptables -A INPUT -p tcp --syn -m limit --limit 1/s --limit-burst 3 -j ACCEPT
iptables -A INPUT -p tcp --syn -j DROP

# Block XMAS packets
iptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP

# Block port scanning
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST \
    -m limit --limit 1/s -j ACCEPT

# Block specific IPs (example)
iptables -A INPUT -s 192.168.1.100 -j DROP

# Block IP range
iptables -A INPUT -m iprange --src-range 10.0.0.1-10.0.0.50 -j DROP</code></pre>
        </div>

        <h3>iptables NAT Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">iptables NAT/Router Configuration</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>#!/bin/bash
# =============================================================================
# IPTABLES NAT/ROUTER CONFIGURATION
# =============================================================================

# Enable IP forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward
# Persistent: add "net.ipv4.ip_forward=1" to /etc/sysctl.conf

# Variables
WAN_IF="eth0"         # External interface
LAN_IF="eth1"         # Internal interface
LAN_NET="192.168.1.0/24"
WEB_SERVER="192.168.1.100"

# =============================================================================
# SOURCE NAT (Masquerade) - Internet access for LAN
# =============================================================================
iptables -t nat -A POSTROUTING -o $WAN_IF -j MASQUERADE

# Or with static IP:
# iptables -t nat -A POSTROUTING -o $WAN_IF -j SNAT --to-source 203.0.113.1

# =============================================================================
# DESTINATION NAT (Port Forwarding)
# =============================================================================

# Forward HTTP to internal web server
iptables -t nat -A PREROUTING -i $WAN_IF -p tcp --dport 80 \
    -j DNAT --to-destination $WEB_SERVER:80

# Forward HTTPS to internal web server
iptables -t nat -A PREROUTING -i $WAN_IF -p tcp --dport 443 \
    -j DNAT --to-destination $WEB_SERVER:443

# Forward different external port to internal port
iptables -t nat -A PREROUTING -i $WAN_IF -p tcp --dport 8080 \
    -j DNAT --to-destination 192.168.1.101:80

# =============================================================================
# FORWARD CHAIN RULES (Required for NAT to work)
# =============================================================================

# Allow LAN to WAN
iptables -A FORWARD -i $LAN_IF -o $WAN_IF -j ACCEPT

# Allow established connections back
iptables -A FORWARD -i $WAN_IF -o $LAN_IF -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

# Allow forwarded traffic to web server
iptables -A FORWARD -i $WAN_IF -o $LAN_IF -p tcp -d $WEB_SERVER --dport 80 -j ACCEPT
iptables -A FORWARD -i $WAN_IF -o $LAN_IF -p tcp -d $WEB_SERVER --dport 443 -j ACCEPT

# Block all other forwarded traffic
iptables -A FORWARD -j DROP</code></pre>
        </div>
      </section>

      <!-- nftables -->
      <section>
        <h2 id="nftables">nftables (Modern Linux)</h2>
        <p>
          nftables is the successor to iptables, providing a cleaner syntax, better performance, 
          and unified IPv4/IPv6 handling.
        </p>

        <div class="alert alert-info">
          <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
          <div class="alert-content">
            <div class="alert-title">nftables vs iptables</div>
            <p>nftables is the default on Debian 10+, Ubuntu 20.04+, RHEL 8+, and Fedora 18+. The <code>iptables</code> command may be a compatibility layer for nftables.</p>
          </div>
        </div>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">nftables</span>
            <span class="code-filename">/etc/nftables.conf - Complete Firewall</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>#!/usr/sbin/nft -f
# =============================================================================
# NFTABLES FIREWALL CONFIGURATION
# =============================================================================

# Flush existing rules
flush ruleset

# =============================================================================
# VARIABLES
# =============================================================================
define WAN_IF = eth0
define LAN_IF = eth1
define LAN_NET = 192.168.1.0/24
define WEB_SERVER = 192.168.1.100
define ADMIN_IPS = { 192.168.1.10, 192.168.1.11 }

# =============================================================================
# FILTER TABLE
# =============================================================================
table inet filter {
    # Custom chains
    chain tcp_chain {
        # SSH with rate limiting
        tcp dport 22 ct state new limit rate 3/minute accept
        
        # Web traffic
        tcp dport { 80, 443 } accept
        
        # Reject with TCP RST
        reject with tcp reset
    }
    
    chain udp_chain {
        # DNS
        udp dport 53 accept
        
        # Drop silently
        drop
    }
    
    # Input chain
    chain input {
        type filter hook input priority 0; policy drop;
        
        # Accept loopback
        iif "lo" accept
        
        # Accept established/related
        ct state established,related accept
        
        # Drop invalid
        ct state invalid drop
        
        # ICMP/ICMPv6
        ip protocol icmp icmp type { echo-request, echo-reply, destination-unreachable } accept
        ip6 nexthdr icmpv6 icmpv6 type { echo-request, echo-reply, nd-neighbor-solicit, nd-neighbor-advert } accept
        
        # Jump to protocol-specific chains
        tcp dport 1-65535 jump tcp_chain
        udp dport 1-65535 jump udp_chain
        
        # Log and drop everything else
        log prefix "nft-dropped: " limit rate 5/minute
        drop
    }
    
    # Forward chain (for routing)
    chain forward {
        type filter hook forward priority 0; policy drop;
        
        # Allow LAN to WAN
        iifname $LAN_IF oifname $WAN_IF accept
        
        # Allow established back
        ct state established,related accept
        
        # Port forwards
        iifname $WAN_IF oifname $LAN_IF ip daddr $WEB_SERVER tcp dport { 80, 443 } accept
        
        # Log dropped forwards
        log prefix "nft-forward-dropped: " limit rate 5/minute
        drop
    }
    
    # Output chain
    chain output {
        type filter hook output priority 0; policy accept;
    }
}

# =============================================================================
# NAT TABLE
# =============================================================================
table ip nat {
    chain prerouting {
        type nat hook prerouting priority -100;
        
        # Port forwarding to web server
        iifname $WAN_IF tcp dport 80 dnat to $WEB_SERVER:80
        iifname $WAN_IF tcp dport 443 dnat to $WEB_SERVER:443
    }
    
    chain postrouting {
        type nat hook postrouting priority 100;
        
        # Masquerade outbound traffic
        oifname $WAN_IF masquerade
    }
}

# =============================================================================
# SETS (Dynamic IP Lists)
# =============================================================================
table inet filter {
    # Blocked IPs set
    set blocked_ips {
        type ipv4_addr
        flags timeout
        elements = { 10.0.0.1 timeout 1h, 10.0.0.2 timeout 1h }
    }
    
    # Whitelist set
    set whitelist {
        type ipv4_addr
        elements = { 192.168.1.0/24, 10.10.10.0/24 }
    }
    
    chain input {
        # Block IPs in blocked_ips set
        ip saddr @blocked_ips drop
        
        # Allow whitelist
        ip saddr @whitelist accept
    }
}</code></pre>
        </div>

        <h3>nftables Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">nftables Management Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># List all rules
nft list ruleset

# List specific table
nft list table inet filter

# Add rule interactively
nft add rule inet filter input tcp dport 8080 accept

# Delete rule by handle
nft -a list ruleset    # Show handles
nft delete rule inet filter input handle 15

# Add element to set
nft add element inet filter blocked_ips { 1.2.3.4 timeout 30m }

# Delete element from set
nft delete element inet filter blocked_ips { 1.2.3.4 }

# Save rules
nft list ruleset > /etc/nftables.conf

# Load rules
nft -f /etc/nftables.conf

# Enable on boot
systemctl enable nftables
systemctl start nftables</code></pre>
        </div>
      </section>

      <!-- pfSense -->
      <section>
        <h2 id="pfsense">pfSense</h2>
        <p>
          pfSense is a free, open source firewall/router distribution based on FreeBSD. 
          It provides enterprise-grade features through an intuitive web interface.
        </p>

        <h3>pfSense Features</h3>
        <div class="card-grid">
          <div class="card">
            <h4>Stateful Firewall</h4>
            <p>pf-based firewall with connection tracking and state table.</p>
          </div>
          <div class="card">
            <h4>VPN</h4>
            <p>IPsec, OpenVPN, WireGuard support with site-to-site and remote access.</p>
          </div>
          <div class="card">
            <h4>Traffic Shaping</h4>
            <p>QoS with ALTQ, Limiters, and bandwidth management.</p>
          </div>
          <div class="card">
            <h4>Multi-WAN</h4>
            <p>Load balancing and failover with multiple internet connections.</p>
          </div>
          <div class="card">
            <h4>Packages</h4>
            <p>Snort/Suricata IDS, pfBlockerNG, HAProxy, Squid, and more.</p>
          </div>
          <div class="card">
            <h4>High Availability</h4>
            <p>CARP failover with synchronized state tables.</p>
          </div>
        </div>

        <h3>pfSense CLI Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Shell</span>
            <span class="code-filename">pfSense Shell Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# PFSENSE SHELL COMMANDS
# =============================================================================

# Access shell from console menu option 8, or SSH

# View firewall rules
pfctl -sr                    # Show filter rules
pfctl -sn                    # Show NAT rules
pfctl -ss                    # Show state table
pfctl -si                    # Show statistics

# View interfaces
ifconfig                     # All interfaces
pfctl -s info               # PF info including states

# Reload firewall
pfctl -f /tmp/rules.debug   # Load rules file
/etc/rc.filter_configure    # Reload filter config

# Clear states
pfctl -F states             # Flush all states
pfctl -k 192.168.1.100      # Kill states for specific IP

# View logs
clog /var/log/filter.log | tail -50    # Firewall logs
clog /var/log/system.log | tail -50    # System logs

# Package management
pkg update                   # Update package list
pkg upgrade                  # Upgrade packages
pkg install pfSense-pkg-snort   # Install Snort

# Backup/Restore
php /etc/rc.backup_config.inc   # Create backup
# Backups stored in /cf/conf/backup/

# DNS resolution
host google.com
dig @8.8.8.8 google.com

# Network testing
ping -c 4 8.8.8.8
traceroute 8.8.8.8

# Restart services
/etc/rc.restart_webgui      # Restart web interface
service dhcpd restart       # Restart DHCP
service openvpn restart     # Restart OpenVPN</code></pre>
        </div>

        <h3>pfSense Firewall Rule Example (via GUI)</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">Example Rule Structure</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# PFSENSE FIREWALL RULES (Conceptual - Configure via WebGUI)
# =============================================================================

# Location: Firewall → Rules → [Interface]

# RULE 1: Anti-Lockout Rule (auto-created)
# Action: Pass
# Interface: LAN
# Protocol: TCP
# Source: LAN net
# Destination: LAN address
# Port: 443, 80
# Description: Anti-lockout rule

# RULE 2: Allow LAN to any
# Action: Pass
# Interface: LAN
# Protocol: Any
# Source: LAN net
# Destination: Any
# Description: Default allow LAN to any

# RULE 3: Block RFC1918 on WAN
# Action: Block
# Interface: WAN
# Protocol: Any
# Source: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
# Destination: Any
# Description: Block private networks on WAN

# RULE 4: Port Forward - Web Server
# NAT: Port Forward (Firewall → NAT → Port Forward)
# Interface: WAN
# Protocol: TCP
# Destination: WAN address
# Dest Port: 443
# Redirect IP: 192.168.1.100
# Redirect Port: 443
# Filter Rule: Auto-created

# RULE 5: Block specific country (with pfBlockerNG)
# Uses GeoIP lists to block traffic from specific countries

# =============================================================================
# RECOMMENDED RULE ORDER
# =============================================================================
# 1. Anti-lockout rules
# 2. Block bogon/private networks on WAN
# 3. Allow specific services (port forwards)
# 4. Allow VPN traffic
# 5. Block malicious IPs (pfBlockerNG)
# 6. Allow internal network rules
# 7. Default deny (implicit)</code></pre>
        </div>
      </section>

      <!-- OPNsense -->
      <section>
        <h2 id="opnsense">OPNsense</h2>
        <p>
          OPNsense is a FreeBSD-based firewall forked from pfSense, featuring a modern 
          interface, weekly security updates, and additional enterprise features.
        </p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Feature</th>
                <th>OPNsense</th>
                <th>pfSense</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>License</strong></td>
                <td>BSD (fully open)</td>
                <td>Apache 2.0 (CE), proprietary (Plus)</td>
              </tr>
              <tr>
                <td><strong>Update Frequency</strong></td>
                <td>Weekly</td>
                <td>Less frequent</td>
              </tr>
              <tr>
                <td><strong>UI</strong></td>
                <td>Modern Bootstrap</td>
                <td>Traditional</td>
              </tr>
              <tr>
                <td><strong>API</strong></td>
                <td>Full REST API</td>
                <td>Limited (xmlrpc)</td>
              </tr>
              <tr>
                <td><strong>IDS/IPS</strong></td>
                <td>Suricata (inline)</td>
                <td>Snort/Suricata</td>
              </tr>
              <tr>
                <td><strong>WireGuard</strong></td>
                <td>Native support</td>
                <td>Package (newer versions)</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Shell</span>
            <span class="code-filename">OPNsense CLI Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# OPNSENSE CLI COMMANDS
# =============================================================================

# Configuration tool
opnsense-update               # Check for updates
opnsense-update -p            # Update packages
opnsense-update -bkp          # Update base, kernel, packages
opnsense-revert               # Revert to previous version

# Firewall commands
configctl filter reload       # Reload firewall rules
configctl filter sync         # Sync filter
pfctl -sr                     # Show rules (same as pfSense)

# Service control
configctl service list        # List all services
configctl <service> restart   # Restart service
configctl <service> status    # Check status

# Examples:
configctl webgui restart
configctl openvpn restart
configctl unbound restart

# View logs
tail -f /var/log/filter/latest.log    # Firewall logs
tail -f /var/log/system/latest.log    # System logs

# Backup
configctl system backup       # Create backup

# API Examples (from external system)
curl -k -u "key:secret" https://opnsense/api/diagnostics/interface/getInterfaceStatistics
curl -k -u "key:secret" https://opnsense/api/firewall/filter/searchRule</code></pre>
        </div>
      </section>

      <!-- Windows Firewall -->
      <section>
        <h2 id="windows-firewall">Windows Defender Firewall</h2>
        <p>
          Windows Defender Firewall (formerly Windows Firewall) is the built-in host-based 
          firewall in Windows, supporting inbound/outbound rules, profiles, and advanced security.
        </p>

        <h3>PowerShell Firewall Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">PowerShell</span>
            <span class="code-filename">Windows Firewall Management</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# WINDOWS FIREWALL POWERSHELL COMMANDS
# =============================================================================

# View firewall status
Get-NetFirewallProfile | Format-Table Name, Enabled
Get-NetFirewallProfile -Profile Domain,Private,Public

# Enable/Disable firewall
Set-NetFirewallProfile -Profile Domain -Enabled True
Set-NetFirewallProfile -Profile Public -Enabled True
Set-NetFirewallProfile -All -Enabled True

# View all rules
Get-NetFirewallRule | Format-Table Name, Enabled, Direction, Action
Get-NetFirewallRule -Enabled True | Where-Object {$_.Direction -eq "Inbound"}

# View rule details
Get-NetFirewallRule -DisplayName "Remote Desktop*" | Get-NetFirewallPortFilter

# =============================================================================
# CREATE INBOUND RULES
# =============================================================================

# Allow RDP
New-NetFirewallRule -DisplayName "Allow RDP" `
    -Direction Inbound `
    -Protocol TCP `
    -LocalPort 3389 `
    -Action Allow `
    -Profile Domain,Private

# Allow web server
New-NetFirewallRule -DisplayName "Allow HTTP" `
    -Direction Inbound `
    -Protocol TCP `
    -LocalPort 80 `
    -Action Allow

New-NetFirewallRule -DisplayName "Allow HTTPS" `
    -Direction Inbound `
    -Protocol TCP `
    -LocalPort 443 `
    -Action Allow

# Allow specific application
New-NetFirewallRule -DisplayName "Allow MyApp" `
    -Direction Inbound `
    -Program "C:\Program Files\MyApp\app.exe" `
    -Action Allow

# Allow from specific IP range
New-NetFirewallRule -DisplayName "Allow Admin Network" `
    -Direction Inbound `
    -Protocol TCP `
    -LocalPort 22,3389 `
    -RemoteAddress 192.168.10.0/24 `
    -Action Allow

# Allow ICMP (ping)
New-NetFirewallRule -DisplayName "Allow ICMPv4-In" `
    -Protocol ICMPv4 `
    -IcmpType 8 `
    -Direction Inbound `
    -Action Allow

# =============================================================================
# CREATE OUTBOUND RULES
# =============================================================================

# Block outbound to specific IP
New-NetFirewallRule -DisplayName "Block Malicious IP" `
    -Direction Outbound `
    -RemoteAddress 10.0.0.100 `
    -Action Block

# Block application from internet access
New-NetFirewallRule -DisplayName "Block App Internet" `
    -Direction Outbound `
    -Program "C:\Program Files\BadApp\app.exe" `
    -Action Block

# =============================================================================
# MANAGE EXISTING RULES
# =============================================================================

# Enable/Disable rule
Enable-NetFirewallRule -DisplayName "Allow RDP"
Disable-NetFirewallRule -DisplayName "Allow RDP"

# Remove rule
Remove-NetFirewallRule -DisplayName "Allow RDP"

# Modify rule
Set-NetFirewallRule -DisplayName "Allow RDP" -RemoteAddress 192.168.1.0/24

# =============================================================================
# LOGGING
# =============================================================================

# Enable logging
Set-NetFirewallProfile -Profile Domain -LogBlocked True -LogAllowed True `
    -LogFileName "%systemroot%\system32\LogFiles\Firewall\pfirewall.log" `
    -LogMaxSizeKilobytes 4096

# View log
Get-Content "$env:SystemRoot\system32\LogFiles\Firewall\pfirewall.log" -Tail 50

# =============================================================================
# EXPORT/IMPORT RULES
# =============================================================================

# Export rules
netsh advfirewall export "C:\firewall-backup.wfw"

# Import rules
netsh advfirewall import "C:\firewall-backup.wfw"

# Export rules to CSV (PowerShell)
Get-NetFirewallRule | Export-Csv -Path "C:\firewall-rules.csv" -NoTypeInformation</code></pre>
        </div>

        <h3>Windows Firewall with Advanced Security (WFAS) - netsh</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">CMD</span>
            <span class="code-filename">netsh Firewall Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code>REM =============================================================================
REM NETSH ADVFIREWALL COMMANDS (CMD/Batch)
REM =============================================================================

REM View firewall status
netsh advfirewall show allprofiles

REM Enable/Disable firewall
netsh advfirewall set allprofiles state on
netsh advfirewall set domainprofile state on
netsh advfirewall set privateprofile state on
netsh advfirewall set publicprofile state off

REM Set default policies
netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound

REM View rules
netsh advfirewall firewall show rule name=all
netsh advfirewall firewall show rule name=all dir=in
netsh advfirewall firewall show rule name="Remote Desktop*"

REM Add inbound rule
netsh advfirewall firewall add rule name="Allow SSH" dir=in action=allow protocol=tcp localport=22

REM Add outbound rule
netsh advfirewall firewall add rule name="Block Telnet Out" dir=out action=block protocol=tcp remoteport=23

REM Add rule with remote IP restriction
netsh advfirewall firewall add rule name="Allow RDP from Admin" dir=in action=allow protocol=tcp localport=3389 remoteip=192.168.10.0/24

REM Delete rule
netsh advfirewall firewall delete rule name="Allow SSH"

REM Reset to defaults
netsh advfirewall reset

REM Export/Import
netsh advfirewall export "C:\firewall-backup.wfw"
netsh advfirewall import "C:\firewall-backup.wfw"</code></pre>
        </div>
      </section>

      <!-- Comparison -->
      <section>
        <h2 id="comparison">Solution Comparison</h2>

        <div class="table-wrapper">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Criteria</th>
                <th>iptables/nftables</th>
                <th>pfSense</th>
                <th>OPNsense</th>
                <th>Windows FW</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>GUI</strong></td>
                <td><span class="feature-no">No</span></td>
                <td><span class="feature-yes">Yes</span></td>
                <td><span class="feature-yes">Yes (Modern)</span></td>
                <td><span class="feature-yes">Yes</span></td>
              </tr>
              <tr>
                <td><strong>VPN</strong></td>
                <td>Manual config</td>
                <td>IPsec, OpenVPN, WG</td>
                <td>IPsec, OpenVPN, WG</td>
                <td>Built-in L2TP/IPsec</td>
              </tr>
              <tr>
                <td><strong>IDS/IPS</strong></td>
                <td>Manual (Snort)</td>
                <td>Snort/Suricata pkg</td>
                <td>Suricata built-in</td>
                <td><span class="feature-no">No</span></td>
              </tr>
              <tr>
                <td><strong>Best For</strong></td>
                <td>Servers, containers</td>
                <td>SMB, home lab</td>
                <td>Enterprise, modern</td>
                <td>Windows hosts</td>
              </tr>
              <tr>
                <td><strong>Learning Curve</strong></td>
                <td>High</td>
                <td>Medium</td>
                <td>Medium</td>
                <td>Low</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section>
        <div class="section-divider"><span>Related Guides</span></div>
        <div class="card-grid">
          <a href="firewall-concepts.html" class="nav-card card">
            <h4>Firewall Concepts →</h4>
            <p>Fundamental firewall architecture and best practices.</p>
          </a>
          <a href="ids-ips.html" class="nav-card card">
            <h4>IDS/IPS →</h4>
            <p>Snort, Suricata, and intrusion detection systems.</p>
          </a>
          <a href="vpn.html" class="nav-card card">
            <h4>VPN Technologies →</h4>
            <p>IPsec, OpenVPN, WireGuard configurations.</p>
          </a>
        </div>
      </section>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-bottom">
      <p>Network Security & Infrastructure Guide</p>
    </div>
  </footer>

  <script src="main.js"></script>
</body>
</html>
