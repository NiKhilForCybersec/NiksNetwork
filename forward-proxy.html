<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Forward Proxy Complete Guide - Squid, Zscaler, Blue Coat configurations, SSL inspection, PAC files, and enterprise deployment">
  <title>Forward Proxy Guide | NetSec Guide</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <a href="index.html" class="navbar-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      NetSec Guide
    </a>
    <ul class="navbar-nav">
      <li><a href="index.html">Home</a></li>
      <li><a href="network-fundamentals.html">Fundamentals</a></li>
      <li><a href="forward-proxy.html" class="active">Proxies</a></li>
      <li><a href="firewall-concepts.html">Firewalls</a></li>
      <li><a href="troubleshooting.html">Troubleshooting</a></li>
    </ul>
    <button class="menu-toggle" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </nav>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">On This Page</div>
      <ul class="sidebar-nav">
        <li><a href="#concepts">Forward Proxy Concepts</a></li>
        <li><a href="#architecture">Architecture & Flow</a></li>
        <li><a href="#use-cases">Use Cases</a></li>
        <li><a href="#proxy-modes">Explicit vs Transparent</a></li>
        <li><a href="#ssl-inspection">SSL/TLS Inspection</a></li>
        <li><a href="#pac-files">PAC Files & WPAD</a></li>
        <li><a href="#squid">Squid Proxy</a></li>
        <li><a href="#zscaler">Zscaler ZIA</a></li>
        <li><a href="#bluecoat">Blue Coat ProxySG</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ul>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Related Pages</div>
      <ul class="sidebar-nav">
        <li><a href="reverse-proxy.html">Reverse Proxy</a></li>
        <li><a href="load-balancing.html">Load Balancing</a></li>
        <li><a href="waf.html">Web Application Firewall</a></li>
      </ul>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="content-wrapper">
      <!-- Breadcrumb -->
      <nav class="breadcrumb">
        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item active">Forward Proxy</span>
      </nav>

      <h1>Forward Proxy - Complete Guide</h1>
      <p class="hero-subtitle">
        Master forward proxy technologies for enterprise web filtering, security inspection, 
        caching, and compliance. Covers Squid, Zscaler, Blue Coat, and more.
      </p>

      <!-- Concepts -->
      <section>
        <h2 id="concepts">What is a Forward Proxy?</h2>
        <p>
          A forward proxy sits between client devices and the internet, intercepting outbound 
          requests on behalf of users. It acts as an intermediary that can filter, cache, log, 
          and inspect all traffic leaving the network.
        </p>

        <div class="alert alert-info">
          <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
          <div class="alert-content">
            <div class="alert-title">Key Distinction</div>
            <p><strong>Forward Proxy:</strong> Protects clients, controls outbound traffic<br>
            <strong>Reverse Proxy:</strong> Protects servers, controls inbound traffic</p>
          </div>
        </div>
      </section>

      <!-- Architecture -->
      <section>
        <h2 id="architecture">Forward Proxy Architecture</h2>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            Forward Proxy Network Flow
          </div>
          <pre>
                           INTERNAL NETWORK                          â”‚           INTERNET
                                                                     â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
  â”‚   Laptop    â”‚â”€â”€â”                                                 â”‚
  â”‚ 192.168.1.10â”‚  â”‚                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                                 â”‚
                   â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚                     â”‚                     â”‚    â”‚                 â”‚
  â”‚  Desktop    â”‚â”€â”€â”¼â”€â”€â”€â”€â–ºâ”‚   FORWARD PROXY     â”‚â”€â”€â”€â”€â”                â”‚    â”‚  google.com     â”‚
  â”‚ 192.168.1.11â”‚  â”‚     â”‚   (Squid/Zscaler)   â”‚    â”‚                â”‚    â”‚                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚                     â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”‚        â”‚   â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”‚ â€¢ Web Filter  â”‚  â”‚    â”œâ”€â”€â–ºâ”‚Firewallâ”‚â”€â”€â”€â”¼â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Server    â”‚â”€â”€â”¼â”€â”€â”€â”€â–ºâ”‚  â”‚ â€¢ SSL Inspect â”‚  â”‚    â”‚   â”‚        â”‚   â”‚    â”‚                 â”‚
  â”‚ 192.168.1.12â”‚  â”‚     â”‚  â”‚ â€¢ Caching     â”‚  â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚  microsoft.com  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â”‚ â€¢ Logging     â”‚  â”‚â”€â”€â”€â”€â”˜                â”‚    â”‚                 â”‚
                   â”‚     â”‚  â”‚ â€¢ Auth        â”‚  â”‚                     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                     â”‚
  â”‚   Mobile    â”‚â”€â”€â”˜     â”‚                     â”‚                     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 192.168.1.13â”‚        â”‚   192.168.1.254     â”‚                     â”‚    â”‚                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚  blocked.com    â”‚
                                   â”‚                                 â”‚    â”‚   âœ— BLOCKED     â”‚
                                   â”‚                                 â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
                         â”‚   Proxy Actions   â”‚                       â”‚
                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
                         â”‚ âœ“ Allow           â”‚                       â”‚
                         â”‚ âœ— Block           â”‚                       â”‚
                         â”‚ âš¡ Cache           â”‚                       â”‚
                         â”‚ ğŸ” Inspect         â”‚                       â”‚
                         â”‚ ğŸ“ Log             â”‚                       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚


PACKET FLOW (Step by Step):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Client (192.168.1.10) wants to access https://example.com
   
2. EXPLICIT PROXY: Client sends request TO the proxy (port 3128/8080)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CONNECT example.com:443 HTTP/1.1                                        â”‚
   â”‚ Host: example.com                                                       â”‚
   â”‚ Proxy-Authorization: Basic dXNlcjpwYXNz                                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Proxy evaluates request against policies:
   - User authentication (who is requesting?)
   - URL categorization (what category is this site?)
   - Time-based rules (is access allowed at this time?)
   - SSL inspection (should we decrypt and inspect?)

4. If ALLOWED: Proxy makes request on behalf of client
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ GET / HTTP/1.1                                                          â”‚
   â”‚ Host: example.com                                                       â”‚
   â”‚ X-Forwarded-For: 192.168.1.10                                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. Response flows back through proxy to client
          </pre>
        </div>
      </section>

      <!-- Use Cases -->
      <section>
        <h2 id="use-cases">Forward Proxy Use Cases</h2>
        
        <div class="card-grid">
          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              </div>
              <h4 class="card-title">Web Filtering</h4>
            </div>
            <div class="card-body">
              <p>Block access to malicious, inappropriate, or non-business websites based on URL categories, reputation, and custom rules.</p>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
              </div>
              <h4 class="card-title">SSL/TLS Inspection</h4>
            </div>
            <div class="card-body">
              <p>Decrypt HTTPS traffic to inspect for malware, data exfiltration, and policy violations. Essential as 90%+ of traffic is encrypted.</p>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
              </div>
              <h4 class="card-title">Bandwidth Optimization</h4>
            </div>
            <div class="card-body">
              <p>Cache frequently accessed content, compress data, and implement bandwidth policies to optimize network performance.</p>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
              </div>
              <h4 class="card-title">Logging & Compliance</h4>
            </div>
            <div class="card-body">
              <p>Maintain detailed logs of all web activity for compliance (PCI-DSS, HIPAA, SOX), forensics, and usage reporting.</p>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
              </div>
              <h4 class="card-title">User Authentication</h4>
            </div>
            <div class="card-body">
              <p>Identify users through LDAP, Active Directory, SAML, or captive portal for user-based policy enforcement.</p>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
              </div>
              <h4 class="card-title">Anonymity & Privacy</h4>
            </div>
            <div class="card-body">
              <p>Hide internal IP addresses from external sites. The proxy's IP appears as the source of all requests.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Proxy Modes -->
      <section>
        <h2 id="proxy-modes">Explicit vs Transparent Proxy</h2>

        <div class="table-wrapper">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Aspect</th>
                <th>Explicit Proxy</th>
                <th>Transparent Proxy</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Client Configuration</strong></td>
                <td>Required (browser/system settings)</td>
                <td>Not required (invisible to users)</td>
              </tr>
              <tr>
                <td><strong>Traffic Redirection</strong></td>
                <td>Client connects directly to proxy</td>
                <td>Network redirects traffic (WCCP, PBR)</td>
              </tr>
              <tr>
                <td><strong>HTTPS Handling</strong></td>
                <td>CONNECT method tunnel</td>
                <td>Requires SSL interception</td>
              </tr>
              <tr>
                <td><strong>Authentication</strong></td>
                <td>Full support (407 challenge)</td>
                <td>Limited (IP-based or NTLM)</td>
              </tr>
              <tr>
                <td><strong>Bypass Risk</strong></td>
                <td>Can be bypassed if not enforced</td>
                <td>Harder to bypass (network-level)</td>
              </tr>
              <tr>
                <td><strong>Deployment</strong></td>
                <td>PAC files, GPO, MDM</td>
                <td>Router/firewall redirection</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Proxy Authentication Methods</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Method</th>
                <th>Security</th>
                <th>SSO</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Basic</strong></td>
                <td><span class="badge badge-danger">Low</span></td>
                <td>No</td>
                <td>Base64 encoded credentials (use with HTTPS only)</td>
              </tr>
              <tr>
                <td><strong>NTLM</strong></td>
                <td><span class="badge badge-warning">Medium</span></td>
                <td>Yes</td>
                <td>Windows integrated auth, challenge-response</td>
              </tr>
              <tr>
                <td><strong>Kerberos</strong></td>
                <td><span class="badge badge-success">High</span></td>
                <td>Yes</td>
                <td>Ticket-based, Active Directory integrated</td>
              </tr>
              <tr>
                <td><strong>LDAP</strong></td>
                <td><span class="badge badge-warning">Medium</span></td>
                <td>No</td>
                <td>Directory service authentication</td>
              </tr>
              <tr>
                <td><strong>SAML</strong></td>
                <td><span class="badge badge-success">High</span></td>
                <td>Yes</td>
                <td>Federated identity, cloud-ready</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- SSL Inspection -->
      <section>
        <h2 id="ssl-inspection">SSL/TLS Inspection (MITM)</h2>
        <p>
          SSL inspection decrypts HTTPS traffic for security analysis. The proxy acts as a 
          "man-in-the-middle," presenting its own certificate to clients while establishing 
          a separate encrypted connection to the destination server.
        </p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            SSL/TLS Inspection Flow
          </div>
          <pre>
WITHOUT SSL INSPECTION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Client                      Proxy                         Server
       â”‚                          â”‚                              â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Encrypted Tunnel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
       â”‚     (Proxy can only see destination IP/hostname)        â”‚
       â”‚                          â”‚                              â”‚
       â”‚   Content: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â”‚
       â”‚            (Invisible to proxy - encrypted)             â”‚


WITH SSL INSPECTION (SSL Bump / MITM):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Client                      Proxy                         Server
       â”‚                          â”‚                              â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
       â”‚  â”‚ TLS Session 1  â”‚      â”‚      â”‚ TLS Session 2  â”‚      â”‚
       â”‚â—„â”€â”¤ Proxy CA Cert  â”œâ”€â”€â”€â”€â”€â–ºâ”‚â—„â”€â”€â”€â”€â”€â”¤ Server Cert    â”œâ”€â”€â”€â”€â”€â–ºâ”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
       â”‚                          â”‚                              â”‚
       â”‚   Encrypted with         â”‚        Encrypted with        â”‚
       â”‚   Proxy CA cert          â”‚        Original cert         â”‚
       â”‚                          â”‚                              â”‚
       â”‚                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                        â”‚
       â”‚                    â”‚  DECRYPT  â”‚                        â”‚
       â”‚                    â”‚  INSPECT  â”‚                        â”‚
       â”‚                    â”‚  RE-CRYPT â”‚                        â”‚
       â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
       â”‚                          â”‚                              â”‚
       â”‚                    Content visible:                     â”‚
       â”‚                    â€¢ Malware scanning                   â”‚
       â”‚                    â€¢ DLP inspection                     â”‚
       â”‚                    â€¢ URL categorization                 â”‚
       â”‚                    â€¢ Logging                            â”‚


CERTIFICATE CHAIN:

  Original (No Inspection):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Root CA (DigiCert, Let's Encrypt, etc.)                â”‚
  â”‚     â””â”€â”€ Intermediate CA                                  â”‚
  â”‚           â””â”€â”€ example.com (server certificate)          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  With SSL Inspection:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Enterprise Root CA (must be trusted by clients)        â”‚
  â”‚     â””â”€â”€ Proxy Intermediate CA                           â”‚
  â”‚           â””â”€â”€ example.com (generated by proxy)          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>

        <div class="alert alert-warning">
          <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
          <div class="alert-content">
            <div class="alert-title">SSL Inspection Considerations</div>
            <p>â€¢ Deploy proxy CA certificate to all client devices via GPO/MDM<br>
            â€¢ Exempt sensitive categories: banking, healthcare, government sites<br>
            â€¢ Consider privacy implications and legal requirements<br>
            â€¢ Some applications may break (certificate pinning)</p>
          </div>
        </div>
      </section>

      <!-- PAC Files -->
      <section>
        <h2 id="pac-files">PAC Files & WPAD</h2>
        <p>
          Proxy Auto-Configuration (PAC) files use JavaScript to determine whether requests 
          should go through a proxy or directly to the destination.
        </p>

        <h3>PAC File Examples</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">JavaScript</span>
            <span class="code-filename">proxy.pac - Basic PAC File</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code>function FindProxyForURL(url, host) {
    // Direct connection for localhost
    if (isPlainHostName(host) || 
        shExpMatch(host, "localhost") ||
        shExpMatch(host, "127.0.0.1")) {
        return "DIRECT";
    }
    
    // Direct connection for internal networks
    if (isInNet(host, "10.0.0.0", "255.0.0.0") ||
        isInNet(host, "172.16.0.0", "255.240.0.0") ||
        isInNet(host, "192.168.0.0", "255.255.0.0")) {
        return "DIRECT";
    }
    
    // Direct for internal domain
    if (dnsDomainIs(host, ".internal.company.com") ||
        dnsDomainIs(host, ".corp.local")) {
        return "DIRECT";
    }
    
    // Use proxy for everything else
    return "PROXY proxy.company.com:8080; PROXY proxy2.company.com:8080; DIRECT";
}</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">JavaScript</span>
            <span class="code-filename">proxy.pac - Advanced PAC with Load Balancing</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code>function FindProxyForURL(url, host) {
    // Normalize to lowercase
    host = host.toLowerCase();
    url = url.toLowerCase();
    
    // Block list - return error page
    var blocked = [
        "*.gambling.com",
        "*.torrent.com",
        "*.malware-domain.com"
    ];
    for (var i = 0; i < blocked.length; i++) {
        if (shExpMatch(host, blocked[i])) {
            return "PROXY block.company.com:8080";
        }
    }
    
    // Bypass proxy for specific domains
    var direct_domains = [
        "*.microsoft.com",
        "*.office365.com",
        "*.windowsupdate.com",
        "*.teams.microsoft.com",
        "zoom.us",
        "*.zoom.us"
    ];
    for (var i = 0; i < direct_domains.length; i++) {
        if (shExpMatch(host, direct_domains[i])) {
            return "DIRECT";
        }
    }
    
    // Location-based proxy selection
    var myIP = myIpAddress();
    
    // New York office
    if (isInNet(myIP, "10.10.0.0", "255.255.0.0")) {
        return "PROXY proxy-nyc.company.com:8080; DIRECT";
    }
    
    // London office
    if (isInNet(myIP, "10.20.0.0", "255.255.0.0")) {
        return "PROXY proxy-lon.company.com:8080; DIRECT";
    }
    
    // Default proxy with failover
    return "PROXY proxy1.company.com:8080; PROXY proxy2.company.com:8080; DIRECT";
}</code></pre>
        </div>

        <h3>WPAD (Web Proxy Auto-Discovery)</h3>
        <p>
          WPAD automatically discovers the PAC file location using DNS or DHCP, eliminating 
          manual proxy configuration.
        </p>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">WPAD Configuration</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># DNS Method: Create DNS record
wpad.company.com    A    192.168.1.100

# The browser looks for: http://wpad.company.com/wpad.dat

# Web server configuration (Nginx)
server {
    listen 80;
    server_name wpad.company.com;
    
    location /wpad.dat {
        alias /var/www/proxy.pac;
        types { }
        default_type application/x-ns-proxy-autoconfig;
    }
    
    location /proxy.pac {
        alias /var/www/proxy.pac;
        types { }
        default_type application/x-ns-proxy-autoconfig;
    }
}

# DHCP Method (ISC DHCP)
option wpad code 252 = text;
option wpad "http://wpad.company.com/wpad.dat";</code></pre>
        </div>
      </section>

      <!-- Squid Proxy -->
      <section>
        <h2 id="squid">Squid Proxy (Open Source)</h2>
        <p>
          Squid is a powerful open-source caching and forwarding proxy supporting HTTP, HTTPS, 
          FTP, and more. It's widely used in enterprise environments.
        </p>

        <h3>Installation</h3>
        <div class="tabs">
          <div class="tab-list">
            <button class="tab-btn active" data-tab="squid-ubuntu">Ubuntu/Debian</button>
            <button class="tab-btn" data-tab="squid-rhel">RHEL/CentOS</button>
          </div>
          <div id="squid-ubuntu" class="tab-content active">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Bash</span>
                <button class="copy-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                  Copy
                </button>
              </div>
              <pre><code># Install Squid
sudo apt update
sudo apt install squid squid-openssl -y

# Verify installation
squid -v

# Start and enable service
sudo systemctl start squid
sudo systemctl enable squid

# Check status
sudo systemctl status squid

# Configuration file location
ls -la /etc/squid/squid.conf

# Log files
ls -la /var/log/squid/</code></pre>
            </div>
          </div>
          <div id="squid-rhel" class="tab-content">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Bash</span>
                <button class="copy-btn">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                  Copy
                </button>
              </div>
              <pre><code># Install Squid
sudo dnf install squid -y

# For SSL support, compile from source or use EPEL
sudo dnf install epel-release -y
sudo dnf install squid -y

# Start and enable
sudo systemctl start squid
sudo systemctl enable squid

# Firewall rules
sudo firewall-cmd --permanent --add-port=3128/tcp
sudo firewall-cmd --reload</code></pre>
            </div>
          </div>
        </div>

        <h3>Basic Squid Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">/etc/squid/squid.conf - Basic Setup</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># =============================================================================
# SQUID PROXY CONFIGURATION
# =============================================================================

# -----------------------------------------------------------------------------
# Network Settings
# -----------------------------------------------------------------------------
http_port 3128
visible_hostname proxy.company.com

# -----------------------------------------------------------------------------
# Access Control Lists (ACLs)
# -----------------------------------------------------------------------------

# Define local networks
acl localnet src 10.0.0.0/8
acl localnet src 172.16.0.0/12
acl localnet src 192.168.0.0/16

# Define ports
acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl CONNECT method CONNECT

# Working hours
acl business_hours time MTWHF 08:00-18:00

# -----------------------------------------------------------------------------
# Access Rules
# -----------------------------------------------------------------------------

# Deny requests to unsafe ports
http_access deny !Safe_ports

# Deny CONNECT to non-SSL ports
http_access deny CONNECT !SSL_ports

# Allow localhost
http_access allow localhost manager
http_access deny manager

# Allow local networks
http_access allow localnet
http_access allow localhost

# Deny all other access
http_access deny all

# -----------------------------------------------------------------------------
# Caching
# -----------------------------------------------------------------------------
cache_dir ufs /var/spool/squid 10000 16 256
cache_mem 512 MB
maximum_object_size 100 MB
minimum_object_size 0 KB

# Cache replacement policy
cache_replacement_policy lru

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
access_log /var/log/squid/access.log squid
cache_log /var/log/squid/cache.log
cache_store_log /var/log/squid/store.log

# Log format
logformat combined %>a %[ui %[un [%tl] "%rm %ru HTTP/%rv" %>Hs %<st "%{Referer}>h" "%{User-Agent}>h" %Ss:%Sh

# -----------------------------------------------------------------------------
# Performance
# -----------------------------------------------------------------------------
dns_nameservers 8.8.8.8 8.8.4.4
connect_timeout 30 seconds
read_timeout 3 minutes
request_timeout 3 minutes
client_lifetime 1 day

# Connection limits
max_filedescriptors 65535</code></pre>
        </div>

        <h3>Squid ACL Examples</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">ACL Examples - URL and Domain Filtering</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># =============================================================================
# DOMAIN AND URL FILTERING
# =============================================================================

# Block specific domains
acl blocked_domains dstdomain .facebook.com .twitter.com .instagram.com
acl blocked_domains dstdomain .tiktok.com .snapchat.com
http_access deny blocked_domains

# Block domains from file
acl blocked_file dstdomain "/etc/squid/blocked_domains.txt"
http_access deny blocked_file

# Block by URL regex
acl blocked_urls url_regex -i porn adult xxx gambling
acl blocked_urls url_regex -i torrent download\.exe
http_access deny blocked_urls

# Allow specific domains (whitelist)
acl allowed_domains dstdomain .microsoft.com .google.com .company.com
http_access allow allowed_domains

# =============================================================================
# SOURCE IP-BASED ACLs
# =============================================================================

# Executive subnet - full access
acl executives src 192.168.10.0/24
http_access allow executives

# Guest network - limited access
acl guests src 192.168.200.0/24
acl guest_allowed dstdomain .google.com .bing.com
http_access allow guests guest_allowed
http_access deny guests

# =============================================================================
# TIME-BASED ACLs
# =============================================================================

# Define time periods
acl business_hours time MTWHF 08:00-18:00
acl lunch_time time MTWHF 12:00-13:00

# Allow social media during lunch only
acl social_media dstdomain .facebook.com .twitter.com .linkedin.com
http_access allow social_media lunch_time
http_access deny social_media

# Restrict bandwidth-heavy sites during business hours
acl streaming dstdomain .youtube.com .netflix.com .twitch.tv
http_access deny streaming business_hours

# =============================================================================
# CONTENT-TYPE ACLs
# =============================================================================

# Block file downloads by extension
acl blocked_extensions urlpath_regex -i \.(exe|msi|bat|cmd|vbs|ps1)$
acl blocked_extensions urlpath_regex -i \.(torrent|iso|rar|7z)$
http_access deny blocked_extensions

# Block by MIME type
acl blocked_mimetypes rep_mime_type application/x-executable
acl blocked_mimetypes rep_mime_type application/x-msdos-program
http_reply_access deny blocked_mimetypes</code></pre>
        </div>

        <h3>Squid LDAP Authentication</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">LDAP/Active Directory Authentication</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># =============================================================================
# LDAP AUTHENTICATION CONFIGURATION
# =============================================================================

# LDAP Authentication Helper
auth_param basic program /usr/lib/squid/basic_ldap_auth \
    -v 3 \
    -b "dc=company,dc=com" \
    -D "cn=squid,ou=service,dc=company,dc=com" \
    -W /etc/squid/ldap_password \
    -f "(&(objectClass=user)(sAMAccountName=%s))" \
    -h ldap.company.com

auth_param basic children 10
auth_param basic realm Company Proxy Authentication
auth_param basic credentialsttl 2 hours

# Require authentication
acl authenticated proxy_auth REQUIRED

# LDAP Group-Based Access
external_acl_type ldap_group %LOGIN /usr/lib/squid/ext_ldap_group_acl \
    -v 3 \
    -b "dc=company,dc=com" \
    -D "cn=squid,ou=service,dc=company,dc=com" \
    -W /etc/squid/ldap_password \
    -f "(&(objectClass=group)(cn=%g)(member=cn=%u,ou=users,dc=company,dc=com))" \
    -h ldap.company.com

# Define groups
acl it_admins external ldap_group IT-Admins
acl executives external ldap_group Executives
acl standard_users external ldap_group Domain-Users

# Apply rules
http_access allow it_admins              # IT gets full access
http_access allow executives             # Executives get full access
http_access allow standard_users !blocked_domains  # Others with restrictions
http_access deny all</code></pre>
        </div>

        <h3>Squid SSL Bump (HTTPS Inspection)</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">Generate SSL Certificates</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># Create SSL certificate directory
sudo mkdir -p /etc/squid/ssl_cert
cd /etc/squid/ssl_cert

# Generate CA certificate (valid for 10 years)
sudo openssl req -new -newkey rsa:4096 -sha256 -days 3650 -nodes -x509 \
    -subj "/C=US/ST=State/L=City/O=Company/CN=Squid Proxy CA" \
    -keyout squid-ca-key.pem \
    -out squid-ca-cert.pem

# Create certificate for clients to import
sudo openssl x509 -in squid-ca-cert.pem -outform DER -out squid-ca-cert.der

# Create SSL database
sudo /usr/lib/squid/security_file_certgen -c -s /var/lib/squid/ssl_db -M 20MB

# Set permissions
sudo chown -R squid:squid /etc/squid/ssl_cert
sudo chown -R squid:squid /var/lib/squid/ssl_db
sudo chmod 700 /etc/squid/ssl_cert</code></pre>
        </div>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">/etc/squid/squid.conf - SSL Bump Configuration</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># =============================================================================
# SSL BUMP CONFIGURATION (HTTPS INSPECTION)
# =============================================================================

# HTTPS port with SSL bump
http_port 3128 ssl-bump \
    cert=/etc/squid/ssl_cert/squid-ca-cert.pem \
    key=/etc/squid/ssl_cert/squid-ca-key.pem \
    generate-host-certificates=on \
    dynamic_cert_mem_cache_size=4MB

# SSL certificate generation helper
sslcrtd_program /usr/lib/squid/security_file_certgen \
    -s /var/lib/squid/ssl_db \
    -M 20MB

sslcrtd_children 10

# SSL Bump ACLs - Define what to inspect
acl step1 at_step SslBump1
acl step2 at_step SslBump2
acl step3 at_step SslBump3

# Sites to NOT inspect (banking, healthcare, etc.)
acl no_ssl_bump dstdomain .bank.com
acl no_ssl_bump dstdomain .healthcare.gov
acl no_ssl_bump dstdomain .mybank.com
acl no_ssl_bump dstdomain "/etc/squid/ssl_bump_exceptions.txt"

# SSL Bump Steps:
# 1. peek - Look at server certificate without decrypting
# 2. stare - Wait for more info
# 3. bump - Decrypt and inspect
# 4. splice - Pass through without inspection
# 5. terminate - Block connection

# Peek at all connections first
ssl_bump peek step1

# Splice (don't inspect) banking and healthcare
ssl_bump splice no_ssl_bump

# Bump (inspect) everything else
ssl_bump bump all

# SSL options
sslproxy_cert_error allow all
sslproxy_flags DONT_VERIFY_PEER</code></pre>
        </div>
      </section>

      <!-- Zscaler -->
      <section>
        <h2 id="zscaler">Zscaler Internet Access (ZIA)</h2>
        <p>
          Zscaler is a cloud-native security platform providing secure internet access, 
          web filtering, threat protection, and data loss prevention without on-premises hardware.
        </p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            Zscaler Architecture
          </div>
          <pre>
                                    ZSCALER CLOUD (150+ Data Centers)
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                                         â”‚
                              â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                              â”‚   â”‚         ZEN (Zscaler             â”‚   â”‚
                              â”‚   â”‚      Enforcement Node)           â”‚   â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
  â”‚                 â”‚         â”‚   â”‚  â”‚ â€¢ URL Filtering           â”‚  â”‚   â”‚
  â”‚  Branch Office  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–ºâ”‚  â”‚ â€¢ SSL Inspection          â”‚  â”‚   â”‚â”€â”€â”€â”€â–º  Internet
  â”‚  (GRE/IPSec)    â”‚         â”‚   â”‚  â”‚ â€¢ Malware Protection      â”‚  â”‚   â”‚
  â”‚                 â”‚         â”‚   â”‚  â”‚ â€¢ DLP                     â”‚  â”‚   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚  â”‚ â€¢ Sandboxing              â”‚  â”‚   â”‚
                              â”‚   â”‚  â”‚ â€¢ CASB                    â”‚  â”‚   â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
  â”‚                 â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚  Remote Users   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                         â”‚
  â”‚ (ZCC Agent)     â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚                 â”‚         â”‚   â”‚       ZPA (Private Access)      â”‚   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚    (Zero Trust App Access)      â”‚   â”‚â”€â”€â”€â”€â–º Private Apps
                              â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                                         â”‚
  â”‚                 â”‚         â”‚                                         â”‚
  â”‚    Data Center  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚  (PAC/Tunnel)   â”‚                                                   â”‚
  â”‚                 â”‚                                                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


TRAFFIC FORWARDING METHODS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. PAC FILE
   â””â”€â”€ Browser configured to use Zscaler PAC
   â””â”€â”€ URL: https://pac.zscaler.net/company/proxy.pac

2. ZSCALER CLIENT CONNECTOR (ZCC)
   â””â”€â”€ Lightweight agent on endpoints
   â””â”€â”€ Forces all traffic through Zscaler
   â””â”€â”€ Works on/off corporate network

3. GRE/IPSec TUNNELS
   â””â”€â”€ From branch office routers/firewalls
   â””â”€â”€ All traffic tunneled to nearest ZEN

4. PROXY CHAINING
   â””â”€â”€ On-prem proxy forwards to Zscaler
   â””â”€â”€ X-Forwarded-For header for user identification
          </pre>
        </div>

        <h3>Zscaler Policy Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">Zscaler URL Filtering Policy (Conceptual)</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># =============================================================================
# ZSCALER URL FILTERING POLICY STRUCTURE
# =============================================================================

# Policy Order (Top to Bottom - First Match Wins)

Rule 1: "Executive Bypass"
â”œâ”€â”€ Users: Executive-Group
â”œâ”€â”€ URL Categories: All
â”œâ”€â”€ Action: Allow
â””â”€â”€ SSL Inspection: No

Rule 2: "Block Malicious Content"
â”œâ”€â”€ Users: All
â”œâ”€â”€ URL Categories:
â”‚   â”œâ”€â”€ Malware
â”‚   â”œâ”€â”€ Phishing
â”‚   â”œâ”€â”€ Botnet
â”‚   â””â”€â”€ Command & Control
â”œâ”€â”€ Action: Block
â””â”€â”€ SSL Inspection: Yes

Rule 3: "Block Adult Content"
â”œâ”€â”€ Users: All
â”œâ”€â”€ URL Categories:
â”‚   â”œâ”€â”€ Adult Content
â”‚   â”œâ”€â”€ Pornography
â”‚   â””â”€â”€ Adult Themes
â”œâ”€â”€ Action: Block
â””â”€â”€ SSL Inspection: Yes

Rule 4: "Allow Business Apps"
â”œâ”€â”€ Users: All
â”œâ”€â”€ Applications:
â”‚   â”œâ”€â”€ Microsoft 365
â”‚   â”œâ”€â”€ Salesforce
â”‚   â”œâ”€â”€ Google Workspace
â”‚   â””â”€â”€ Zoom
â”œâ”€â”€ Action: Allow
â””â”€â”€ SSL Inspection: Selective

Rule 5: "Restrict Social Media"
â”œâ”€â”€ Users: Standard-Users
â”œâ”€â”€ Applications:
â”‚   â”œâ”€â”€ Facebook
â”‚   â”œâ”€â”€ Twitter
â”‚   â”œâ”€â”€ Instagram
â”‚   â””â”€â”€ TikTok
â”œâ”€â”€ Time: Business Hours (08:00-18:00 M-F)
â”œâ”€â”€ Action: Caution (Warning Page)
â””â”€â”€ SSL Inspection: Yes

Rule 6: "Block File Sharing"
â”œâ”€â”€ Users: All (except IT-Admins)
â”œâ”€â”€ Applications:
â”‚   â”œâ”€â”€ BitTorrent
â”‚   â”œâ”€â”€ Mega
â”‚   â””â”€â”€ Anonymous Proxies
â”œâ”€â”€ Action: Block
â””â”€â”€ SSL Inspection: Yes

Rule 7: "Default Allow"
â”œâ”€â”€ Users: All
â”œâ”€â”€ URL Categories: All Others
â”œâ”€â”€ Action: Allow
â””â”€â”€ SSL Inspection: Yes

# =============================================================================
# SSL INSPECTION POLICY
# =============================================================================

SSL Inspection Rule 1: "Do Not Inspect"
â”œâ”€â”€ URL Categories:
â”‚   â”œâ”€â”€ Financial Services
â”‚   â”œâ”€â”€ Healthcare
â”‚   â””â”€â”€ Government
â”œâ”€â”€ Action: Do Not Inspect

SSL Inspection Rule 2: "Inspect All Others"
â”œâ”€â”€ URL Categories: All Others
â”œâ”€â”€ Action: Inspect</code></pre>
        </div>

        <h3>Zscaler GRE Tunnel Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Cisco</span>
            <span class="code-filename">Cisco IOS GRE Tunnel to Zscaler</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code>! =============================================================================
! GRE Tunnel to Zscaler - Primary
! =============================================================================

interface Tunnel1
 description GRE Tunnel to Zscaler Primary ZEN
 ip address 10.255.1.1 255.255.255.252
 ip mtu 1400
 ip tcp adjust-mss 1360
 tunnel source GigabitEthernet0/0
 tunnel destination 165.225.xxx.xxx    ! Zscaler ZEN IP (from admin portal)
 tunnel key 12345                       ! Unique tunnel key from Zscaler
 keepalive 10 3

! =============================================================================
! GRE Tunnel to Zscaler - Secondary
! =============================================================================

interface Tunnel2
 description GRE Tunnel to Zscaler Secondary ZEN
 ip address 10.255.2.1 255.255.255.252
 ip mtu 1400
 ip tcp adjust-mss 1360
 tunnel source GigabitEthernet0/0
 tunnel destination 165.225.yyy.yyy    ! Secondary ZEN IP
 tunnel key 12346
 keepalive 10 3

! =============================================================================
! Routing - Send web traffic through Zscaler
! =============================================================================

! Track tunnel availability
track 1 interface Tunnel1 line-protocol
track 2 interface Tunnel2 line-protocol

! Static routes with tracking
ip route 0.0.0.0 0.0.0.0 Tunnel1 track 1
ip route 0.0.0.0 0.0.0.0 Tunnel2 10 track 2

! Alternative: Policy-based routing for specific traffic
route-map ZSCALER permit 10
 match ip address 101
 set ip next-hop verify-availability 10.255.1.2 1 track 1
 set ip next-hop verify-availability 10.255.2.2 2 track 2

access-list 101 permit tcp any any eq 80
access-list 101 permit tcp any any eq 443

interface Vlan100
 ip policy route-map ZSCALER</code></pre>
        </div>
      </section>

      <!-- Blue Coat -->
      <section>
        <h2 id="bluecoat">Blue Coat / Symantec ProxySG</h2>
        <p>
          Blue Coat ProxySG (now Symantec/Broadcom) is an enterprise-grade secure web gateway 
          providing web filtering, SSL inspection, and advanced threat protection.
        </p>

        <h3>ProxySG Policy Layers</h3>
        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            ProxySG Policy Processing Order
          </div>
          <pre>
                    REQUEST ARRIVES
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    ADMIN LAYER          â”‚  â”€â”€â”€ Management access rules
            â”‚  (Highest Priority)     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    DNS LAYER            â”‚  â”€â”€â”€ DNS proxy rules
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    SSL LAYER            â”‚  â”€â”€â”€ SSL interception decisions
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    AUTHENTICATION       â”‚  â”€â”€â”€ User identification
            â”‚    LAYER                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    WEB ACCESS LAYER     â”‚  â”€â”€â”€ URL filtering, allow/deny
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    WEB CONTENT LAYER    â”‚  â”€â”€â”€ Content inspection
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    FORWARDING LAYER     â”‚  â”€â”€â”€ Next hop decisions
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                  ALLOW / DENY
          </pre>
        </div>

        <h3>ProxySG CPL (Content Policy Language)</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">CPL</span>
            <span class="code-filename">Web Access Policy Examples</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code>; =============================================================================
; BLUE COAT PROXYSG - WEB ACCESS LAYER POLICY (CPL)
; =============================================================================

<Proxy>
    ; -------------------------------------------------------------------------
    ; Define Groups and Objects
    ; -------------------------------------------------------------------------
    define subnet internal_networks
        192.168.0.0/16
        10.0.0.0/8
        172.16.0.0/12
    end

    define category blocked_categories
        category="Adult/Sexually Explicit"
        category="Malware"
        category="Phishing"
        category="Gambling"
        category="Illegal Drugs"
        category="Weapons"
    end

    ; -------------------------------------------------------------------------
    ; Authentication Required
    ; -------------------------------------------------------------------------
    authenticate(LDAPRealm)

    ; -------------------------------------------------------------------------
    ; Block Malicious Content
    ; -------------------------------------------------------------------------
    DENY category=blocked_categories \
         exception(content_filter_exception, no)

    ; -------------------------------------------------------------------------
    ; Allow IT Administrators Full Access
    ; -------------------------------------------------------------------------
    ALLOW group="IT-Admins"

    ; -------------------------------------------------------------------------
    ; Block Social Media During Business Hours
    ; -------------------------------------------------------------------------
    DENY category="Social Networking" \
         time=weekdays \
         time.hour=8..17 \
         group!="Executives"

    ; -------------------------------------------------------------------------
    ; Block Large File Downloads
    ; -------------------------------------------------------------------------
    DENY url.extension=(exe,msi,iso,torrent) \
         group!="IT-Admins"

    ; -------------------------------------------------------------------------
    ; Bandwidth Throttling for Streaming
    ; -------------------------------------------------------------------------
    action.bandwidth_class(StreamingLimit) \
         category="Streaming Media"

    ; -------------------------------------------------------------------------
    ; Allow Everything Else
    ; -------------------------------------------------------------------------
    ALLOW client.address=internal_networks

    ; -------------------------------------------------------------------------
    ; Default Deny
    ; -------------------------------------------------------------------------
    DENY

</Proxy>

; =============================================================================
; SSL INTERCEPTION LAYER
; =============================================================================

<SSL-Intercept>
    ; Do not intercept financial sites
    ALLOW category="Financial Services"
    ALLOW category="Health"

    ; Do not intercept if certificate pinning detected
    ALLOW ssl.client_certificate_requested=yes

    ; Intercept all other HTTPS
    ssl.forward_proxy(proxy_cert_name) all
</SSL-Intercept></code></pre>
        </div>
      </section>

      <!-- Troubleshooting -->
      <section>
        <h2 id="troubleshooting">Troubleshooting Forward Proxy</h2>

        <h3>Common Issues and Solutions</h3>
        <div class="accordion">
          <div class="accordion-item">
            <button class="accordion-header">
              Users Cannot Connect Through Proxy
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header">
                  <span class="code-lang">Bash</span>
                  <button class="copy-btn">Copy</button>
                </div>
                <pre><code># Check if proxy is listening
netstat -tlnp | grep 3128
ss -tlnp | grep squid

# Test proxy connectivity
curl -x http://proxy.company.com:3128 http://example.com

# Check proxy logs for errors
tail -f /var/log/squid/access.log
tail -f /var/log/squid/cache.log

# Verify firewall allows proxy traffic
iptables -L -n | grep 3128

# Test DNS resolution on proxy
dig example.com @8.8.8.8</code></pre>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header">
              SSL Certificate Errors
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header">
                  <span class="code-lang">Bash</span>
                  <button class="copy-btn">Copy</button>
                </div>
                <pre><code># Verify CA certificate is installed on client
# Windows: certmgr.msc -> Trusted Root CAs
# Linux: update-ca-certificates

# Check certificate validity
openssl x509 -in /etc/squid/ssl_cert/squid-ca-cert.pem -text -noout

# Test SSL connection through proxy
curl -x http://proxy:3128 --proxy-cacert /path/to/ca.crt https://example.com

# Verify SSL database
/usr/lib/squid/security_file_certgen -c -s /var/lib/squid/ssl_db -M 20MB

# Check for certificate pinning issues
# Sites like banking apps may fail - add to bypass list</code></pre>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header">
              Authentication Failures
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header">
                  <span class="code-lang">Bash</span>
                  <button class="copy-btn">Copy</button>
                </div>
                <pre><code># Test LDAP authentication manually
/usr/lib/squid/basic_ldap_auth -v 3 \
    -b "dc=company,dc=com" \
    -D "cn=squid,ou=service,dc=company,dc=com" \
    -W /etc/squid/ldap_password \
    -f "(&(objectClass=user)(sAMAccountName=%s))" \
    -h ldap.company.com

# Enter username and password when prompted
# Should return OK or ERR

# Check LDAP connectivity
ldapsearch -x -H ldap://ldap.company.com \
    -D "cn=squid,ou=service,dc=company,dc=com" \
    -w password \
    -b "dc=company,dc=com" \
    "(sAMAccountName=testuser)"

# Enable debug logging
debug_options ALL,1 33,2 28,9</code></pre>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header">
              Slow Performance
              <svg class="accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="accordion-body">
              <div class="code-block">
                <div class="code-header">
                  <span class="code-lang">Bash</span>
                  <button class="copy-btn">Copy</button>
                </div>
                <pre><code># Check cache hit ratio
squidclient -h localhost mgr:info | grep -i hit

# Monitor connections
squidclient -h localhost mgr:active_requests

# Check file descriptors
cat /proc/$(pidof squid)/limits | grep "open files"

# Optimize settings in squid.conf:
# - Increase cache_mem
# - Tune cache_dir size
# - Increase max_filedescriptors
# - Use faster DNS servers

# Check for DNS delays
time dig example.com

# Monitor system resources
top -p $(pidof squid)
iostat -x 1</code></pre>
              </div>
            </div>
          </div>
        </div>

        <h3>Useful Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">Squid Management Commands</span>
            <button class="copy-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
          </div>
          <pre><code># Check configuration syntax
squid -k parse

# Reload configuration
squid -k reconfigure

# Rotate logs
squid -k rotate

# Shutdown gracefully
squid -k shutdown

# Force shutdown
squid -k kill

# Check cache statistics
squidclient -h localhost mgr:info
squidclient -h localhost mgr:utilization

# Clear cache
squid -k shutdown
rm -rf /var/spool/squid/*
squid -z
squid

# Real-time log monitoring
tail -f /var/log/squid/access.log | grep -E "(TCP_DENIED|TCP_MISS)"

# Test proxy with verbose output
curl -v -x http://proxy:3128 http://example.com</code></pre>
        </div>
      </section>

      <!-- Next Steps -->
      <section>
        <div class="section-divider"><span>Continue Learning</span></div>
        
        <div class="card-grid">
          <a href="reverse-proxy.html" class="nav-card card">
            <h4>Reverse Proxy â†’</h4>
            <p>Learn about server-side proxies with Nginx, HAProxy, and F5.</p>
          </a>
          <a href="waf.html" class="nav-card card">
            <h4>Web Application Firewall â†’</h4>
            <p>Protect web applications with WAF technologies.</p>
          </a>
          <a href="ssl-inspection.html" class="nav-card card">
            <h4>Network Segmentation â†’</h4>
            <p>Design secure network architectures with Zero Trust.</p>
          </a>
        </div>
      </section>

    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>Proxy Technologies</h4>
        <ul>
          <li><a href="forward-proxy.html">Forward Proxy</a></li>
          <li><a href="reverse-proxy.html">Reverse Proxy</a></li>
          <li><a href="load-balancing.html">Load Balancing</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Security</h4>
        <ul>
          <li><a href="firewall-concepts.html">Firewalls</a></li>
          <li><a href="waf.html">WAF</a></li>
          <li><a href="ids-ips.html">IDS/IPS</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>Network Security & Infrastructure Guide</p>
    </div>
  </footer>

  <script src="main.js"></script>
</body>
</html>
