<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="IDS/IPS Guide - Understanding intrusion detection and prevention, deployment strategies, and rule tuning">
  <title>IDS/IPS Guide | NetSec Guide</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar">
    <a href="index.html" class="navbar-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      NetSec Guide
    </a>
    <ul class="navbar-nav">
      <li><a href="index.html">Home</a></li>
      <li><a href="network-fundamentals.html">Fundamentals</a></li>
      <li><a href="forward-proxy.html">Proxies</a></li>
      <li><a href="firewall-concepts.html">Firewalls</a></li>
      <li><a href="troubleshooting.html">Troubleshooting</a></li>
    </ul>
    <button class="menu-toggle" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </nav>

  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">On This Page</div>
      <ul class="sidebar-nav">
        <li><a href="#concepts">IDS vs IPS</a></li>
        <li><a href="#detection">Detection Methods</a></li>
        <li><a href="#deployment">Deployment Strategy</a></li>
        <li><a href="#solutions">Solutions Overview</a></li>
        <li><a href="#rules">Rule Writing</a></li>
        <li><a href="#tuning">Tuning Process</a></li>
      </ul>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Related Pages</div>
      <ul class="sidebar-nav">
        <li><a href="firewall-concepts.html">Firewalls</a></li>
        <li><a href="waf.html">WAF</a></li>
        <li><a href="best-practices.html">Best Practices</a></li>
      </ul>
    </div>
  </aside>

  <main class="main-content">
    <div class="content-wrapper">
      <nav class="breadcrumb">
        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item active">IDS/IPS</span>
      </nav>

      <h1>Intrusion Detection & Prevention</h1>
      <p class="hero-subtitle">
        Understanding IDS/IPS concepts, choosing the right deployment model, 
        and tuning for effective threat detection without alert fatigue.
      </p>

      <!-- IDS vs IPS -->
      <section>
        <h2 id="concepts">IDS vs IPS: What's the Difference?</h2>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            IDS vs IPS Architecture
          </div>
          <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        IDS vs IPS COMPARISON                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   IDS (Intrusion Detection System) - PASSIVE                               â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                â”‚
â”‚                                                                             â”‚
â”‚   Traffic â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Destination           â”‚
â”‚                    â”‚                                                        â”‚
â”‚                    â”‚ Copy (SPAN/Mirror)                                    â”‚
â”‚                    â–¼                                                        â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚              â”‚   IDS    â”‚ â”€â”€â–º Alert: "Attack detected!"                   â”‚
â”‚              â”‚ (monitor)â”‚                                                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                             â”‚
â”‚   âœ“ No latency added (out of band)                                         â”‚
â”‚   âœ“ No risk of blocking legitimate traffic                                 â”‚
â”‚   âœ“ Good for monitoring and forensics                                      â”‚
â”‚   âœ— Cannot stop attacks, only detect                                       â”‚
â”‚   âœ— Attack may complete before response                                    â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚   IPS (Intrusion Prevention System) - ACTIVE                               â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                â”‚
â”‚                                                                             â”‚
â”‚   Traffic â”€â”€â”€â”€â”€â”€â”€â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”€â”€â”€â”€â”€â”€â”€â”€â–º Destination                     â”‚
â”‚                     â”‚   IPS    â”‚                                           â”‚
â”‚                     â”‚ (inline) â”‚                                           â”‚
â”‚                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â–¼                                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚                    â”‚ BLOCKED! â”‚ â† Malicious traffic dropped               â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                                             â”‚
â”‚   âœ“ Can block attacks in real-time                                         â”‚
â”‚   âœ“ Automated protection                                                   â”‚
â”‚   âœ— Adds latency (traffic passes through)                                  â”‚
â”‚   âœ— False positives can block legitimate traffic                           â”‚
â”‚   âœ— Single point of failure risk                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>

        <h3>Which Should You Use?</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Scenario</th>
                <th>Recommendation</th>
                <th>Why</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>First deployment / Learning</td>
                <td><strong>IDS</strong></td>
                <td>Understand your traffic before blocking</td>
              </tr>
              <tr>
                <td>High-security environment</td>
                <td><strong>IPS</strong></td>
                <td>Need automated blocking</td>
              </tr>
              <tr>
                <td>Regulatory compliance</td>
                <td><strong>IPS</strong> (often required)</td>
                <td>PCI DSS, HIPAA may require prevention</td>
              </tr>
              <tr>
                <td>Can't afford downtime from false positives</td>
                <td><strong>IDS</strong></td>
                <td>Alert and investigate, don't auto-block</td>
              </tr>
              <tr>
                <td>Best of both worlds</td>
                <td><strong>IDS first, then IPS</strong></td>
                <td>Tune in IDS mode, then enable blocking</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-info">
          <strong>Modern Reality</strong><br>
          Most solutions (Snort, Suricata) can operate as either IDS or IPS. 
          The difference is deployment: out-of-band (IDS) vs inline (IPS).
        </div>
      </section>

      <!-- Detection Methods -->
      <section>
        <h2 id="detection">Detection Methods</h2>
        <p>Understanding how detection works helps you choose and tune your IDS/IPS effectively.</p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            Detection Methods Explained
          </div>
          <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DETECTION METHODS                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   1. SIGNATURE-BASED (Most Common)                                         â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                         â”‚
â”‚                                                                             â”‚
â”‚   Known attack pattern:  "' OR '1'='1"  â† SQL Injection signature          â”‚
â”‚                                                                             â”‚
â”‚   Traffic: "SELECT * FROM users WHERE id='' OR '1'='1'"                    â”‚
â”‚                                         ^^^^^^^^^^^^                        â”‚
â”‚                                         MATCH! Alert triggered              â”‚
â”‚                                                                             â”‚
â”‚   âœ“ Fast and accurate for known attacks                                    â”‚
â”‚   âœ“ Low false positive rate when tuned                                     â”‚
â”‚   âœ— Cannot detect new/unknown attacks (zero-day)                           â”‚
â”‚   âœ— Requires constant signature updates                                    â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚   2. ANOMALY-BASED                                                          â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                          â”‚
â”‚                                                                             â”‚
â”‚   Normal baseline:    Server usually gets 100 connections/sec              â”‚
â”‚   Current traffic:    Server getting 10,000 connections/sec                â”‚
â”‚                       â–²                                                     â”‚
â”‚                       â”‚                                                     â”‚
â”‚                       ANOMALY! Possible DDoS                               â”‚
â”‚                                                                             â”‚
â”‚   âœ“ Can detect unknown attacks                                             â”‚
â”‚   âœ“ Adapts to your environment                                             â”‚
â”‚   âœ— Higher false positive rate                                             â”‚
â”‚   âœ— Requires learning period                                               â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚   3. PROTOCOL ANALYSIS                                                      â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
â”‚                                                                             â”‚
â”‚   Expected: HTTP request starts with "GET", "POST", etc.                   â”‚
â”‚   Received: Request starts with garbage bytes                              â”‚
â”‚             â–²                                                               â”‚
â”‚             â”‚                                                               â”‚
â”‚             PROTOCOL VIOLATION! Malformed traffic                          â”‚
â”‚                                                                             â”‚
â”‚   âœ“ Catches malformed/crafted packets                                      â”‚
â”‚   âœ“ Protocol-specific validation                                           â”‚
â”‚   âœ— Only catches violations, not valid-but-malicious                       â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚   BEST PRACTICE: Use ALL methods together                                  â”‚
â”‚   Modern IDS/IPS combines signature + anomaly + protocol analysis          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>
      </section>

      <!-- Deployment -->
      <section>
        <h2 id="deployment">Deployment Strategy</h2>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            Where to Place IDS/IPS
          </div>
          <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IDS/IPS DEPLOYMENT POSITIONS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                          INTERNET                                           â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     POSITION 1: PERIMETER                           â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚  â”‚
â”‚   â”‚   â”‚  Router  â”‚â”€â”€â”€â–ºâ”‚ IDS/IPS  â”‚â”€â”€â”€â–ºâ”‚ Firewall â”‚                     â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   âœ“ Sees ALL internet traffic                                      â”‚  â”‚
â”‚   â”‚   âœ“ First line of defense                                          â”‚  â”‚
â”‚   â”‚   âœ— High volume = more tuning needed                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     POSITION 2: DMZ                                 â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   Firewall â”€â”€â”€â–º IDS/IPS â”€â”€â”€â–º Web Servers                           â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   âœ“ Monitors traffic to public-facing servers                      â”‚  â”‚
â”‚   â”‚   âœ“ Critical for web application attacks                           â”‚  â”‚
â”‚   â”‚   âœ“ Lower volume than perimeter                                    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     POSITION 3: INTERNAL                            â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚
â”‚   â”‚   â”‚ Workstns  â”‚â”€â”€â”€â–ºâ”‚ IDS/IPS  â”‚â”€â”€â”€â–ºâ”‚ Servers   â”‚                   â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   âœ“ Detects lateral movement                                       â”‚  â”‚
â”‚   â”‚   âœ“ Catches insider threats                                        â”‚  â”‚
â”‚   â”‚   âœ“ East-West traffic monitoring                                   â”‚  â”‚
â”‚   â”‚   âœ— Encrypted internal traffic may be invisible                    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   RECOMMENDATION: Start with Position 1 (Perimeter), add others as needed â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>
      </section>

      <!-- Solutions -->
      <section>
        <h2 id="solutions">Solutions Overview</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Solution</th>
                <th>Type</th>
                <th>Best For</th>
                <th>Key Strength</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Snort</strong></td>
                <td>Open Source</td>
                <td>Learning, small deployments</td>
                <td>Huge rule community, well documented</td>
              </tr>
              <tr>
                <td><strong>Suricata</strong></td>
                <td>Open Source</td>
                <td>High-performance, production</td>
                <td>Multi-threaded, faster than Snort</td>
              </tr>
              <tr>
                <td><strong>Zeek (Bro)</strong></td>
                <td>Open Source</td>
                <td>Network forensics, analysis</td>
                <td>Deep protocol logging, scripting</td>
              </tr>
              <tr>
                <td><strong>Cisco Firepower</strong></td>
                <td>Commercial</td>
                <td>Enterprise, Cisco shops</td>
                <td>Integration with Cisco ecosystem</td>
              </tr>
              <tr>
                <td><strong>Palo Alto Threat Prevention</strong></td>
                <td>Commercial</td>
                <td>Enterprise, existing PA customers</td>
                <td>Single pane with firewall</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Open Source Quick Start</h3>
        <div class="tabs">
          <div class="tab-list">
            <button class="tab-btn active" data-tab="suricata">Suricata</button>
            <button class="tab-btn" data-tab="snort">Snort</button>
            <button class="tab-btn" data-tab="zeek">Zeek</button>
          </div>

          <div class="tab-content active" id="suricata">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Bash</span>
                <span class="code-filename">Suricata Quick Start</span>
                <button class="copy-btn">Copy</button>
              </div>
              <pre><code># Install Suricata
sudo apt install suricata

# Download and enable rule sets
sudo suricata-update                    # ET Open rules
sudo suricata-update enable-source oisf/trafficid  # Optional

# Test configuration
sudo suricata -T -c /etc/suricata/suricata.yaml

# Run in IDS mode (listening on eth0)
sudo suricata -c /etc/suricata/suricata.yaml -i eth0

# View alerts
tail -f /var/log/suricata/fast.log    # Simple format
tail -f /var/log/suricata/eve.json    # JSON (for SIEM)

# Key files:
# /etc/suricata/suricata.yaml     - Main config
# /var/lib/suricata/rules/        - Rule files
# /var/log/suricata/              - Logs</code></pre>
            </div>
          </div>

          <div class="tab-content" id="snort">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Bash</span>
                <span class="code-filename">Snort Quick Start</span>
                <button class="copy-btn">Copy</button>
              </div>
              <pre><code># Install Snort 3 (Ubuntu)
sudo apt install snort

# Download community rules
wget https://www.snort.org/downloads/community/snort3-community-rules.tar.gz
tar -xzf snort3-community-rules.tar.gz -C /etc/snort/rules/

# Test configuration
snort -c /etc/snort/snort.lua -T

# Run in IDS mode
snort -c /etc/snort/snort.lua -i eth0 -A alert_fast

# Key files:
# /etc/snort/snort.lua            - Main config (Snort 3 uses Lua)
# /etc/snort/rules/               - Rule files
# /var/log/snort/                 - Logs</code></pre>
            </div>
          </div>

          <div class="tab-content" id="zeek">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Bash</span>
                <span class="code-filename">Zeek Quick Start</span>
                <button class="copy-btn">Copy</button>
              </div>
              <pre><code># Install Zeek
sudo apt install zeek

# Configure interface in node.cfg
# /opt/zeek/etc/node.cfg
[zeek]
type=standalone
interface=eth0

# Deploy configuration
zeekctl deploy

# Check status
zeekctl status

# View logs (Zeek creates structured logs, not alerts)
ls /opt/zeek/logs/current/
# conn.log      - All connections
# http.log      - HTTP requests
# dns.log       - DNS queries
# ssl.log       - TLS handshakes
# notice.log    - Alerts/notices

# Search logs
cat /opt/zeek/logs/current/conn.log | zeek-cut id.orig_h id.resp_h</code></pre>
            </div>
            <p><strong>Note:</strong> Zeek is more of a network analysis framework than traditional IDS. It excels at generating rich logs for forensics and hunting, not real-time blocking.</p>
          </div>
        </div>
      </section>

      <!-- Rules -->
      <section>
        <h2 id="rules">Understanding Rules</h2>
        <p>
          Rules tell the IDS/IPS what to look for. Understanding the structure helps you 
          write custom rules and tune existing ones.
        </p>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Snort/Suricata</span>
            <span class="code-filename">Rule Structure Explained</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># RULE STRUCTURE (Snort/Suricata compatible)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

action protocol source_ip source_port -> dest_ip dest_port (options)

# EXAMPLE RULE - Detect SQL Injection in HTTP:

alert http $HOME_NET any -> $EXTERNAL_NET any (
    msg:"SQL Injection Attempt";       # Alert message
    content:"SELECT"; nocase;          # Look for "SELECT" (case-insensitive)
    content:"FROM"; nocase;            # Also must have "FROM"
    sid:1000001;                       # Unique rule ID
    rev:1;                             # Rule revision
    classtype:web-application-attack;  # Category
)

# BREAKING IT DOWN:
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# ACTION:    What to do when matched
#            alert    = Generate alert (IDS)
#            drop     = Block packet (IPS)
#            pass     = Ignore (whitelist)

# PROTOCOL:  What traffic to inspect
#            tcp, udp, icmp, ip
#            http, dns, tls (Suricata app-layer)

# ADDRESSES: Source and destination
#            $HOME_NET = Your internal network (defined in config)
#            $EXTERNAL_NET = Everything else
#            any = Any address/port

# OPTIONS:   The actual detection logic
#            msg:      - Human-readable description
#            content:  - String to match
#            pcre:     - Regex pattern
#            sid:      - Unique signature ID
#            rev:      - Revision number</code></pre>
        </div>

        <h3>Common Rule Patterns</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Snort/Suricata</span>
            <span class="code-filename">Useful Rule Examples</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># DETECT SSH BRUTE FORCE
# Alert if 5+ SSH connections from same IP in 60 seconds
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (
    msg:"Possible SSH Brute Force";
    flow:to_server;
    threshold:type both, track by_src, count 5, seconds 60;
    sid:1000010; rev:1;
)

# DETECT OUTBOUND CONNECTION TO KNOWN BAD IP
# (You'd populate a list of C2 IPs)
alert ip $HOME_NET any -> [1.2.3.4,5.6.7.8] any (
    msg:"Connection to Known C2 Server";
    sid:1000020; rev:1;
)

# DETECT LARGE DNS QUERY (Possible DNS Tunneling)
alert dns $HOME_NET any -> any 53 (
    msg:"Large DNS Query - Possible Tunneling";
    dns.query; content:"|00|"; offset:50;  # Query > 50 bytes
    sid:1000030; rev:1;
)

# WHITELIST RULE (Put before detection rules)
pass tcp $HOME_NET any -> [10.0.0.50] 443 (
    msg:"Whitelist - Internal monitoring";
    sid:1000040; rev:1;
)</code></pre>
        </div>

        <div class="callout callout-warning">
          <strong>Don't Reinvent the Wheel</strong><br>
          For most threats, use community rule sets (ET Open, Snort Community). 
          Write custom rules only for:
          <br>â€¢ Your specific applications
          <br>â€¢ Threats unique to your environment
          <br>â€¢ Gaps in public rule sets
        </div>
      </section>

      <!-- Tuning -->
      <section>
        <h2 id="tuning">Tuning Process</h2>
        <p>
          An untuned IDS/IPS generates so many alerts that real attacks get lost in the noise. 
          Tuning is essential.
        </p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            IDS/IPS Tuning Process
          </div>
          <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IDS/IPS TUNING METHODOLOGY                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   STEP 1: BASELINE (Week 1-2)                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                               â”‚
â”‚   â€¢ Deploy in ALERT-ONLY mode (no blocking)                                â”‚
â”‚   â€¢ Enable all rules                                                        â”‚
â”‚   â€¢ Let it run and collect alerts                                          â”‚
â”‚                                                                             â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   STEP 2: ANALYZE TOP ALERTS (Week 2-3)                                    â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                    â”‚
â”‚   â€¢ Sort alerts by frequency                                               â”‚
â”‚   â€¢ Top 10 rules probably cause 90% of alerts                              â”‚
â”‚   â€¢ For each top rule, ask:                                                â”‚
â”‚     - Is this a real threat in MY environment?                             â”‚
â”‚     - Is this traffic expected and legitimate?                             â”‚
â”‚                                                                             â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   STEP 3: CATEGORIZE                                                       â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ TRUE POSITIVE       â”‚  â”‚ FALSE POSITIVE      â”‚  â”‚ IRRELEVANT      â”‚   â”‚
â”‚   â”‚                     â”‚  â”‚                     â”‚  â”‚                 â”‚   â”‚
â”‚   â”‚ Real attack!        â”‚  â”‚ Legitimate traffic  â”‚  â”‚ Rule doesn't    â”‚   â”‚
â”‚   â”‚ Keep the rule.      â”‚  â”‚ triggered alert.    â”‚  â”‚ apply to your   â”‚   â”‚
â”‚   â”‚                     â”‚  â”‚                     â”‚  â”‚ environment.    â”‚   â”‚
â”‚   â”‚ Action: Investigate â”‚  â”‚ Action: Tune or     â”‚  â”‚                 â”‚   â”‚
â”‚   â”‚                     â”‚  â”‚ whitelist           â”‚  â”‚ Action: Disable â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   STEP 4: APPLY FIXES                                                      â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
â”‚   â€¢ Disable irrelevant rules (e.g., Windows rules on Linux-only network)  â”‚
â”‚   â€¢ Tune thresholds for noisy-but-useful rules                             â”‚
â”‚   â€¢ Create suppress rules for known-good traffic                           â”‚
â”‚   â€¢ DON'T disable rules just because they're noisy                         â”‚
â”‚                                                                             â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚   STEP 5: REPEAT                                                           â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
â”‚   â€¢ Re-analyze weekly for first month                                      â”‚
â”‚   â€¢ Then monthly                                                           â”‚
â”‚   â€¢ Review after any network/application changes                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>

        <h3>Tuning Techniques</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Suricata</span>
            <span class="code-filename">Common Tuning Actions</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># THRESHOLD: Reduce alert volume for noisy rules
# Only alert once per minute per source IP
threshold gen_id 1, sig_id 2100498, type limit, track by_src, count 1, seconds 60

# SUPPRESS: Don't alert for known-good sources
# e.g., Your vulnerability scanner triggers IDS rules
suppress gen_id 1, sig_id 2100498, track by_src, ip 192.168.1.100

# DISABLE: Turn off irrelevant rules
# In suricata.yaml, add to rule-files section:
# - "!rules/emerging-games.rules"    # We don't have game servers

# Or in disable.conf:
# 2100366   # Disable specific rule by SID
# 2100367

# MODIFY: Change rule action (alert-only instead of drop)
# Copy rule to local.rules, change "drop" to "alert"</code></pre>
        </div>
      </section>

      <!-- Quick Reference -->
      <section>
        <h2>Common Gotchas</h2>

        <div class="card-grid">
          <div class="card">
            <h4>ğŸš« Enabling IPS Too Early</h4>
            <p>Run in IDS mode for 2+ weeks first. Understand your traffic before blocking anything.</p>
          </div>
          <div class="card">
            <h4>ğŸš« Alert Fatigue</h4>
            <p>1000 alerts/day = 0 alerts investigated. Tune until alerts are actionable.</p>
          </div>
          <div class="card">
            <h4>ğŸš« No Bypass Mode</h4>
            <p>IPS must have fail-open or bypass for failures. Test your bypass procedure.</p>
          </div>
          <div class="card">
            <h4>ğŸš« Ignoring Performance</h4>
            <p>IPS adds latency. Size hardware for peak traffic + inspection overhead.</p>
          </div>
          <div class="card">
            <h4>ğŸš« Stale Rules</h4>
            <p>Update rule sets regularly (daily/weekly). Old rules miss new threats.</p>
          </div>
          <div class="card">
            <h4>ğŸš« No SIEM Integration</h4>
            <p>IDS alerts need to go somewhere for analysis. Logs on disk = never reviewed.</p>
          </div>
        </div>
      </section>

      <section>
        <div class="section-divider"><span>Related Guides</span></div>
        <div class="card-grid">
          <a href="firewall-concepts.html" class="nav-card card">
            <h4>Firewall Concepts â†’</h4>
            <p>Network security fundamentals.</p>
          </a>
          <a href="waf.html" class="nav-card card">
            <h4>WAF â†’</h4>
            <p>Application-layer protection.</p>
          </a>
          <a href="best-practices.html" class="nav-card card">
            <h4>Best Practices â†’</h4>
            <p>Security monitoring guidelines.</p>
          </a>
        </div>
      </section>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-bottom">
      <p>Network Security & Infrastructure Guide</p>
    </div>
  </footer>

  <script src="main.js"></script>
</body>
</html>
