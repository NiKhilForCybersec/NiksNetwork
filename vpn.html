<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="VPN Complete Guide - IPSec, OpenVPN, WireGuard configurations for site-to-site and remote access VPNs">
  <title>VPN Technologies | NetSec Guide</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar">
    <a href="index.html" class="navbar-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      NetSec Guide
    </a>
    <ul class="navbar-nav">
      <li><a href="index.html">Home</a></li>
      <li><a href="network-fundamentals.html">Fundamentals</a></li>
      <li><a href="forward-proxy.html">Proxies</a></li>
      <li><a href="firewall-concepts.html" class="active">Firewalls</a></li>
      <li><a href="troubleshooting.html">Troubleshooting</a></li>
    </ul>
    <button class="menu-toggle" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </nav>

  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">On This Page</div>
      <ul class="sidebar-nav">
        <li><a href="#overview">VPN Overview</a></li>
        <li><a href="#types">VPN Types</a></li>
        <li><a href="#ipsec">IPSec VPN</a></li>
        <li><a href="#openvpn">OpenVPN</a></li>
        <li><a href="#wireguard">WireGuard</a></li>
        <li><a href="#ssl-vpn">SSL/TLS VPN</a></li>
        <li><a href="#comparison">Comparison</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ul>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Related Pages</div>
      <ul class="sidebar-nav">
        <li><a href="firewall-concepts.html">Firewall Concepts</a></li>
        <li><a href="firewall-paloalto.html">Palo Alto GlobalProtect</a></li>
        <li><a href="network-segmentation.html">Network Segmentation</a></li>
      </ul>
    </div>
  </aside>

  <main class="main-content">
    <div class="content-wrapper">
      <nav class="breadcrumb">
        <span class="breadcrumb-item"><a href="index.html">Home</a></span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-item active">VPN Technologies</span>
      </nav>

      <h1>VPN Technologies - Complete Guide</h1>
      <p class="hero-subtitle">
        Comprehensive guide to VPN protocols and implementations including IPSec, OpenVPN, 
        and WireGuard for both site-to-site and remote access scenarios.
      </p>

      <!-- Overview -->
      <section>
        <h2 id="overview">VPN Overview</h2>
        <p>
          A Virtual Private Network (VPN) creates an encrypted tunnel over an untrusted network 
          (like the internet), allowing secure communication between endpoints.
        </p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            VPN Tunnel Concept
          </div>
          <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              VPN TUNNEL CONCEPT                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                     â”‚
â”‚   WITHOUT VPN:                                                                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                      â”‚
â”‚                                                                                     â”‚
â”‚   Office A                      INTERNET                        Office B           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”                  (Unencrypted)                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚       â”‚ â”€â”€â”€ Plain Text â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Plain Text â”€â”€â”€â”€â–º â”‚       â”‚          â”‚
â”‚   â”‚       â”‚     Packet                              Packet      â”‚       â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜     ğŸ”“ Can be intercepted                          â””â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                     â”‚
â”‚                                                                                     â”‚
â”‚   WITH VPN:                                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                         â”‚
â”‚                                                                                     â”‚
â”‚   Office A                      INTERNET                        Office B           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚       â”‚              â”‚                     â”‚                â”‚       â”‚          â”‚
â”‚   â”‚  VPN  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚  ENCRYPTED TUNNEL   â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚  VPN  â”‚          â”‚
â”‚   â”‚Gatewayâ”‚              â”‚  ğŸ”’ Secure          â”‚                â”‚Gatewayâ”‚          â”‚
â”‚   â”‚       â”‚              â”‚                     â”‚                â”‚       â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚      â”‚                                                              â”‚              â”‚
â”‚      â”‚   Original packet wrapped in encrypted VPN packet            â”‚              â”‚
â”‚      â”‚                                                              â”‚              â”‚
â”‚      â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚              â”‚
â”‚      â””â”€â”€â–ºâ”‚ VPN Header â”‚ Encrypted â”‚ Original â”‚ Original     â”‚â—„â”€â”€â”€â”€â”€â”˜              â”‚
â”‚          â”‚            â”‚ Payload   â”‚ IP Headerâ”‚ Data         â”‚                      â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                                     â”‚
â”‚                                                                                     â”‚
â”‚   VPN COMPONENTS:                                                                   â”‚
â”‚   â€¢ Authentication: Verify identity (certs, PSK, username/password)               â”‚
â”‚   â€¢ Encryption: Protect data confidentiality (AES, ChaCha20)                      â”‚
â”‚   â€¢ Integrity: Ensure data not tampered (SHA, HMAC)                               â”‚
â”‚   â€¢ Tunneling: Encapsulate packets (ESP, UDP)                                     â”‚
â”‚                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>
      </section>

      <!-- Types -->
      <section>
        <h2 id="types">VPN Types</h2>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            Site-to-Site vs Remote Access VPN
          </div>
          <pre>
SITE-TO-SITE VPN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   Office A (NYC)                    INTERNET                  Office B (LA)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 10.1.0.0/24    â”‚                                    â”‚ 10.2.0.0/24    â”‚
   â”‚                â”‚                                    â”‚                â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚Workstationâ”‚ â”‚     â”‚                      â”‚      â”‚  â”‚  Server  â”‚  â”‚
   â”‚  â”‚10.1.0.10 â”‚  â”‚â—„â•â•â•â–ºâ”‚   VPN TUNNEL         â”‚â—„â•â•â•â•â–ºâ”‚  â”‚10.2.0.50 â”‚  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚   (Always On)        â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚                â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                    â”‚                â”‚
   â”‚  â”‚  Router  â”‚â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”‚  Router  â”‚  â”‚
   â”‚  â”‚ VPN GW   â”‚  â”‚                                    â”‚  â”‚ VPN GW   â”‚  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â€¢ Connects entire networks
   â€¢ Permanent tunnel (always up)
   â€¢ Configured on routers/firewalls
   â€¢ Users don't need VPN client


REMOTE ACCESS VPN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   Remote Users                      INTERNET                Corporate Office
                                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚ 10.0.0.0/16    â”‚
   â”‚  Laptop  â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—                            â”‚                â”‚
   â”‚  (Home)  â”‚                â•‘                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â•‘     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚  Server  â”‚  â”‚
                               â• â•â•â•â•â–ºâ”‚  VPN Gateway  â”‚â—„â”€â”€â”€â”€â–ºâ”‚  â”‚10.0.1.50 â”‚  â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â•‘     â”‚  (Firewall)   â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚  Phone   â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                â”‚
   â”‚ (Mobile) â”‚                â•‘                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â•‘                            â”‚  â”‚  Server  â”‚  â”‚
                               â•‘                            â”‚  â”‚10.0.2.100â”‚  â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â•‘                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚  Tablet  â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                            â”‚                â”‚
   â”‚  (Cafe)  â”‚                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â€¢ Connects individual users
   â€¢ On-demand tunnel (connect when needed)
   â€¢ Requires VPN client software
   â€¢ Users authenticate individually
          </pre>
        </div>
      </section>

      <!-- IPSec -->
      <section>
        <h2 id="ipsec">IPSec VPN</h2>
        <p>
          IPSec (Internet Protocol Security) is a suite of protocols for securing IP communications 
          through authentication and encryption. It operates at Layer 3.
        </p>

        <div class="ascii-diagram">
          <div class="ascii-diagram-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
            IPSec Tunnel Establishment (IKEv2)
          </div>
          <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        IKEV2 TUNNEL ESTABLISHMENT                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                     â”‚
â”‚   Initiator                                                        Responder       â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚              PHASE 1: IKE_SA_INIT                              â”‚           â”‚
â”‚       â”‚              (Establish IKE SA)                                â”‚           â”‚
â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚           â”‚
â”‚       â”‚  HDR, SAi1, KEi, Ni                                            â”‚           â”‚
â”‚       â”‚  (Proposals, DH key, Nonce)                                    â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚
â”‚       â”‚  HDR, SAr1, KEr, Nr, [CERTREQ]                                 â”‚           â”‚
â”‚       â”‚  (Selected proposal, DH key, Nonce)                            â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚         â•â•â• IKE SA Established (encrypted) â•â•â•                 â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚              PHASE 2: IKE_AUTH                                 â”‚           â”‚
â”‚       â”‚              (Authenticate + Create IPSec SA)                  â”‚           â”‚
â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚           â”‚
â”‚       â”‚  HDR, SK{IDi, [CERT], AUTH, SAi2, TSi, TSr}                    â”‚           â”‚
â”‚       â”‚  (Identity, Certificate, Auth, IPSec proposal)                 â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚
â”‚       â”‚  HDR, SK{IDr, [CERT], AUTH, SAr2, TSi, TSr}                    â”‚           â”‚
â”‚       â”‚  (Identity, Certificate, Auth, Selected IPSec)                 â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚         â•â•â• IPSec SA Established (Child SA) â•â•â•                â”‚           â”‚
â”‚       â”‚                                                                â”‚           â”‚
â”‚       â”‚              DATA TRANSFER (ESP)                               â”‚           â”‚
â”‚       â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚           â”‚
â”‚       â”‚  Encrypted and authenticated traffic                           â”‚           â”‚
â”‚       â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚           â”‚
â”‚                                                                                     â”‚
â”‚                                                                                     â”‚
â”‚   KEY TERMS:                                                                        â”‚
â”‚   â€¢ SA (Security Association): Negotiated security parameters                       â”‚
â”‚   â€¢ IKE SA: Protects IKE messages (Phase 1)                                        â”‚
â”‚   â€¢ IPSec SA: Protects user traffic (Phase 2/Child SA)                             â”‚
â”‚   â€¢ ESP: Encapsulating Security Payload (encryption + integrity)                   â”‚
â”‚   â€¢ AH: Authentication Header (integrity only, rarely used)                        â”‚
â”‚                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          </pre>
        </div>

        <h3>IPSec Site-to-Site Configuration</h3>
        <div class="tabs">
          <div class="tab-list">
            <button class="tab-btn active" data-tab="ipsec-cisco">Cisco IOS</button>
            <button class="tab-btn" data-tab="ipsec-palo">Palo Alto</button>
            <button class="tab-btn" data-tab="ipsec-linux">Linux (strongSwan)</button>
          </div>
          <div id="ipsec-cisco" class="tab-content active">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Cisco</span>
                <span class="code-filename">IPSec Site-to-Site VPN</span>
                <button class="copy-btn">Copy</button>
              </div>
              <pre><code>! =============================================================================
! CISCO IOS IPSEC SITE-TO-SITE VPN (IKEv2)
! =============================================================================

! Phase 1: IKE Policy
crypto ikev2 proposal IKEV2-PROPOSAL
 encryption aes-cbc-256
 integrity sha256
 group 14

crypto ikev2 policy IKEV2-POLICY
 proposal IKEV2-PROPOSAL

! Pre-shared Key
crypto ikev2 keyring KEYRING
 peer REMOTE-SITE
  address 203.0.113.2
  pre-shared-key local SecureKey123!
  pre-shared-key remote SecureKey123!

! IKEv2 Profile
crypto ikev2 profile IKEV2-PROFILE
 match identity remote address 203.0.113.2 255.255.255.255
 authentication remote pre-share
 authentication local pre-share
 keyring local KEYRING

! Phase 2: IPSec Transform Set
crypto ipsec transform-set TRANSFORM-SET esp-aes 256 esp-sha256-hmac
 mode tunnel

! Crypto ACL (Traffic to encrypt)
access-list 100 permit ip 10.1.0.0 0.0.255.255 10.2.0.0 0.0.255.255

! Crypto Map
crypto map CRYPTO-MAP 10 ipsec-isakmp
 set peer 203.0.113.2
 set transform-set TRANSFORM-SET
 set ikev2-profile IKEV2-PROFILE
 match address 100

! Apply to interface
interface GigabitEthernet0/0
 crypto map CRYPTO-MAP

! Verify
show crypto ikev2 sa
show crypto ipsec sa
show crypto session detail</code></pre>
            </div>
          </div>
          <div id="ipsec-palo" class="tab-content">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">PAN-OS</span>
                <span class="code-filename">IPSec Site-to-Site VPN</span>
                <button class="copy-btn">Copy</button>
              </div>
              <pre><code># =============================================================================
# PALO ALTO IPSEC SITE-TO-SITE VPN
# =============================================================================

# IKE Crypto Profile (Phase 1)
set network ike crypto-profiles ike-crypto-profiles IKE-PROFILE hash sha256
set network ike crypto-profiles ike-crypto-profiles IKE-PROFILE dh-group group14
set network ike crypto-profiles ike-crypto-profiles IKE-PROFILE encryption aes-256-cbc
set network ike crypto-profiles ike-crypto-profiles IKE-PROFILE lifetime hours 8

# IPSec Crypto Profile (Phase 2)
set network ike crypto-profiles ipsec-crypto-profiles IPSEC-PROFILE esp authentication sha256
set network ike crypto-profiles ipsec-crypto-profiles IPSEC-PROFILE esp encryption aes-256-cbc
set network ike crypto-profiles ipsec-crypto-profiles IPSEC-PROFILE dh-group group14
set network ike crypto-profiles ipsec-crypto-profiles IPSEC-PROFILE lifetime hours 1

# IKE Gateway
set network ike gateway IKE-GW authentication pre-shared-key key "SecureKey123!"
set network ike gateway IKE-GW peer-address ip 203.0.113.2
set network ike gateway IKE-GW local-address interface ethernet1/1
set network ike gateway IKE-GW protocol ikev2 ike-crypto-profile IKE-PROFILE
set network ike gateway IKE-GW protocol version ikev2

# IPSec Tunnel
set network tunnel ipsec IPSEC-TUNNEL auto-key ike-gateway IKE-GW
set network tunnel ipsec IPSEC-TUNNEL auto-key ipsec-crypto-profile IPSEC-PROFILE
set network tunnel ipsec IPSEC-TUNNEL tunnel-interface tunnel.1
set network tunnel ipsec IPSEC-TUNNEL anti-replay yes

# Tunnel Interface
set network interface tunnel units tunnel.1 ip 169.254.1.1/30
set zone VPN network layer3 tunnel.1

# Proxy IDs (Traffic Selectors)
set network tunnel ipsec IPSEC-TUNNEL auto-key proxy-id PI-1 local 10.1.0.0/16
set network tunnel ipsec IPSEC-TUNNEL auto-key proxy-id PI-1 remote 10.2.0.0/16

# Static Route
set network virtual-router default routing-table ip static-route TO-REMOTE destination 10.2.0.0/16 interface tunnel.1

# Verify
> show vpn ike-sa
> show vpn ipsec-sa
> show vpn flow</code></pre>
            </div>
          </div>
          <div id="ipsec-linux" class="tab-content">
            <div class="code-block">
              <div class="code-header">
                <span class="code-lang">Config</span>
                <span class="code-filename">/etc/ipsec.conf - strongSwan</span>
                <button class="copy-btn">Copy</button>
              </div>
              <pre><code># =============================================================================
# STRONGSWAN IPSEC SITE-TO-SITE VPN
# =============================================================================

# /etc/ipsec.conf
config setup
    charondebug="ike 2, knl 2, cfg 2"

conn %default
    ikelifetime=8h
    keylife=1h
    rekeymargin=3m
    keyingtries=3
    keyexchange=ikev2
    authby=secret
    
conn site-to-site
    left=203.0.113.1           # Local public IP
    leftsubnet=10.1.0.0/16     # Local network
    leftid=203.0.113.1
    
    right=203.0.113.2          # Remote public IP
    rightsubnet=10.2.0.0/16    # Remote network
    rightid=203.0.113.2
    
    ike=aes256-sha256-modp2048!
    esp=aes256-sha256-modp2048!
    
    auto=start
    dpdaction=restart
    dpddelay=30s
    dpdtimeout=120s

# /etc/ipsec.secrets
203.0.113.1 203.0.113.2 : PSK "SecureKey123!"

# Commands
sudo ipsec start
sudo ipsec up site-to-site
sudo ipsec status
sudo ipsec statusall</code></pre>
            </div>
          </div>
        </div>
      </section>

      <!-- OpenVPN -->
      <section>
        <h2 id="openvpn">OpenVPN</h2>
        <p>
          OpenVPN is an open-source VPN solution using SSL/TLS for key exchange. 
          It can run over UDP or TCP and is highly configurable.
        </p>

        <h3>OpenVPN Server Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">/etc/openvpn/server.conf</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# OPENVPN SERVER CONFIGURATION
# =============================================================================

# Network
port 1194
proto udp
dev tun

# Certificates and Keys
ca /etc/openvpn/pki/ca.crt
cert /etc/openvpn/pki/server.crt
key /etc/openvpn/pki/server.key
dh /etc/openvpn/pki/dh.pem
tls-auth /etc/openvpn/pki/ta.key 0

# Network Configuration
server 10.8.0.0 255.255.255.0          # VPN subnet
topology subnet

# Push routes to clients
push "route 10.0.0.0 255.0.0.0"        # Internal network
push "dhcp-option DNS 10.0.0.10"       # Internal DNS
push "dhcp-option DNS 10.0.0.11"

# Redirect all traffic through VPN (optional)
# push "redirect-gateway def1 bypass-dhcp"

# Client-to-client communication
client-to-client

# Keep connection alive
keepalive 10 120

# Encryption
cipher AES-256-GCM
auth SHA256
tls-version-min 1.2
tls-cipher TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384

# Compression (disabled for security)
compress lz4-v2
push "compress lz4-v2"

# User/Group (for privilege drop)
user nobody
group nogroup

# Persistence
persist-key
persist-tun

# Logging
status /var/log/openvpn/status.log
log-append /var/log/openvpn/openvpn.log
verb 3

# Management interface
management localhost 7505

# Client configuration directory (for per-client settings)
client-config-dir /etc/openvpn/ccd

# Duplicate CN (allow same cert on multiple devices)
# duplicate-cn

# Max clients
max-clients 100</code></pre>
        </div>

        <h3>OpenVPN Client Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">client.ovpn</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# OPENVPN CLIENT CONFIGURATION
# =============================================================================

client
dev tun
proto udp

# Server address
remote vpn.company.com 1194

# Keep trying to resolve hostname
resolv-retry infinite

# Don't bind to specific port
nobind

# Preserve state across restarts
persist-key
persist-tun

# Verify server certificate
remote-cert-tls server

# Encryption settings (must match server)
cipher AES-256-GCM
auth SHA256

# Compression
compress lz4-v2

# Logging
verb 3

# Certificates (inline)
<ca>
-----BEGIN CERTIFICATE-----
[CA Certificate Here]
-----END CERTIFICATE-----
</ca>

<cert>
-----BEGIN CERTIFICATE-----
[Client Certificate Here]
-----END CERTIFICATE-----
</cert>

<key>
-----BEGIN PRIVATE KEY-----
[Client Private Key Here]
-----END PRIVATE KEY-----
</key>

<tls-auth>
-----BEGIN OpenVPN Static key V1-----
[TLS Auth Key Here]
-----END OpenVPN Static key V1-----
</tls-auth>
key-direction 1</code></pre>
        </div>

        <h3>Easy-RSA Certificate Setup</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">Certificate Generation</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# EASY-RSA CERTIFICATE SETUP
# =============================================================================

# Install Easy-RSA
apt install easy-rsa

# Initialize PKI
cd /etc/openvpn
make-cadir pki
cd pki

# Edit vars file
cat > vars << 'EOF'
set_var EASYRSA_REQ_COUNTRY    "US"
set_var EASYRSA_REQ_PROVINCE   "California"
set_var EASYRSA_REQ_CITY       "San Francisco"
set_var EASYRSA_REQ_ORG        "Company Inc"
set_var EASYRSA_REQ_EMAIL      "admin@company.com"
set_var EASYRSA_REQ_OU         "IT Department"
set_var EASYRSA_KEY_SIZE       4096
set_var EASYRSA_ALGO           rsa
set_var EASYRSA_CA_EXPIRE      3650
set_var EASYRSA_CERT_EXPIRE    365
EOF

# Initialize PKI
./easyrsa init-pki

# Build CA
./easyrsa build-ca nopass

# Generate server certificate
./easyrsa gen-req server nopass
./easyrsa sign-req server server

# Generate DH parameters
./easyrsa gen-dh

# Generate TLS auth key
openvpn --genkey --secret ta.key

# Generate client certificate
./easyrsa gen-req client1 nopass
./easyrsa sign-req client client1

# Revoke certificate (if needed)
./easyrsa revoke client1
./easyrsa gen-crl</code></pre>
        </div>
      </section>

      <!-- WireGuard -->
      <section>
        <h2 id="wireguard">WireGuard</h2>
        <p>
          WireGuard is a modern, high-performance VPN using state-of-the-art cryptography. 
          It's simpler and faster than IPSec or OpenVPN.
        </p>

        <div class="alert alert-info">
          <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
          <div class="alert-content">
            <div class="alert-title">WireGuard Advantages</div>
            <p>â€¢ ~4,000 lines of code (vs 100,000+ for OpenVPN)<br>
            â€¢ Uses modern crypto: Curve25519, ChaCha20, Poly1305<br>
            â€¢ Kernel-space implementation (faster)<br>
            â€¢ Cryptokey routing (simple config)</p>
          </div>
        </div>

        <h3>WireGuard Server Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">/etc/wireguard/wg0.conf (Server)</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# WIREGUARD SERVER CONFIGURATION
# =============================================================================

[Interface]
# Server's private key
PrivateKey = SERVER_PRIVATE_KEY_HERE

# Server's VPN IP address
Address = 10.100.0.1/24

# Listen port
ListenPort = 51820

# Post-up and post-down commands for NAT
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

# DNS (optional, pushed to clients)
DNS = 10.0.0.10

# Save config on changes
SaveConfig = false

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PEER CONFIGURATIONS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Client 1: John's Laptop
[Peer]
PublicKey = CLIENT1_PUBLIC_KEY_HERE
AllowedIPs = 10.100.0.10/32
# Optional: Persistent keepalive for NAT traversal
PersistentKeepalive = 25

# Client 2: Jane's Phone
[Peer]
PublicKey = CLIENT2_PUBLIC_KEY_HERE
AllowedIPs = 10.100.0.11/32
PersistentKeepalive = 25

# Site-to-Site: Branch Office
[Peer]
PublicKey = BRANCH_PUBLIC_KEY_HERE
AllowedIPs = 10.100.0.2/32, 192.168.2.0/24
Endpoint = branch.company.com:51820
PersistentKeepalive = 25</code></pre>
        </div>

        <h3>WireGuard Client Configuration</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Config</span>
            <span class="code-filename">/etc/wireguard/wg0.conf (Client)</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# WIREGUARD CLIENT CONFIGURATION
# =============================================================================

[Interface]
# Client's private key
PrivateKey = CLIENT_PRIVATE_KEY_HERE

# Client's VPN IP address
Address = 10.100.0.10/24

# DNS server to use when connected
DNS = 10.0.0.10

[Peer]
# Server's public key
PublicKey = SERVER_PUBLIC_KEY_HERE

# Server's public IP and port
Endpoint = vpn.company.com:51820

# What traffic to route through VPN
# Option 1: Route only specific networks (split tunnel)
AllowedIPs = 10.0.0.0/8, 192.168.0.0/16

# Option 2: Route ALL traffic through VPN (full tunnel)
# AllowedIPs = 0.0.0.0/0, ::/0

# Keep connection alive (important for NAT)
PersistentKeepalive = 25</code></pre>
        </div>

        <h3>WireGuard Commands</h3>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">WireGuard Management</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# WIREGUARD COMMANDS
# =============================================================================

# Install WireGuard
# Ubuntu/Debian
apt install wireguard

# RHEL/CentOS
dnf install wireguard-tools

# Generate key pair
wg genkey | tee privatekey | wg pubkey > publickey

# Or generate in one command and display
wg genkey | tee /dev/stderr | wg pubkey

# Start interface
wg-quick up wg0

# Stop interface
wg-quick down wg0

# Enable on boot
systemctl enable wg-quick@wg0

# Show status
wg show
wg show wg0

# Show verbose status
wg show all dump

# Add peer dynamically
wg set wg0 peer CLIENT_PUBLIC_KEY allowed-ips 10.100.0.20/32

# Remove peer
wg set wg0 peer CLIENT_PUBLIC_KEY remove

# Show peer statistics
wg show wg0 latest-handshakes
wg show wg0 transfer

# Generate QR code for mobile (requires qrencode)
qrencode -t ansiutf8 < client.conf

# Test connectivity
ping 10.100.0.1</code></pre>
        </div>
      </section>

      <!-- SSL VPN -->
      <section>
        <h2 id="ssl-vpn">SSL/TLS VPN</h2>
        <p>
          SSL VPNs use HTTPS (TCP/443) for transport, making them firewall-friendly. 
          They can provide either network-layer (tunnel) or application-layer (portal) access.
        </p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Description</th>
                <th>Examples</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>SSL Portal VPN</strong></td>
                <td>Browser-based access to web applications via portal</td>
                <td>Citrix NetScaler, F5 APM</td>
              </tr>
              <tr>
                <td><strong>SSL Tunnel VPN</strong></td>
                <td>Full network access via client (like IPSec)</td>
                <td>GlobalProtect, AnyConnect, FortiClient</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Comparison -->
      <section>
        <h2 id="comparison">VPN Protocol Comparison</h2>

        <div class="table-wrapper">
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Feature</th>
                <th>IPSec</th>
                <th>OpenVPN</th>
                <th>WireGuard</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Speed</strong></td>
                <td>Fast (hardware accel)</td>
                <td>Medium</td>
                <td><span class="feature-yes">Fastest</span></td>
              </tr>
              <tr>
                <td><strong>Security</strong></td>
                <td><span class="feature-yes">Excellent</span></td>
                <td><span class="feature-yes">Excellent</span></td>
                <td><span class="feature-yes">Excellent</span></td>
              </tr>
              <tr>
                <td><strong>Complexity</strong></td>
                <td>Complex</td>
                <td>Medium</td>
                <td><span class="feature-yes">Simple</span></td>
              </tr>
              <tr>
                <td><strong>Firewall Friendly</strong></td>
                <td><span class="feature-no">No</span> (UDP 500/4500)</td>
                <td><span class="feature-yes">Yes</span> (TCP 443)</td>
                <td><span class="feature-partial">Partial</span> (UDP)</td>
              </tr>
              <tr>
                <td><strong>Mobile Support</strong></td>
                <td>Built-in (IKEv2)</td>
                <td>App required</td>
                <td>App required</td>
              </tr>
              <tr>
                <td><strong>Site-to-Site</strong></td>
                <td><span class="feature-yes">Excellent</span></td>
                <td>Good</td>
                <td>Good</td>
              </tr>
              <tr>
                <td><strong>Enterprise Support</strong></td>
                <td><span class="feature-yes">Universal</span></td>
                <td>Wide</td>
                <td>Growing</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Troubleshooting -->
      <section>
        <h2 id="troubleshooting">VPN Troubleshooting</h2>

        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-filename">VPN Troubleshooting Commands</span>
            <button class="copy-btn">Copy</button>
          </div>
          <pre><code># =============================================================================
# VPN TROUBLESHOOTING
# =============================================================================

# Check if VPN ports are reachable
nc -vzu vpn.company.com 51820       # WireGuard (UDP)
nc -vzu vpn.company.com 500         # IPSec IKE (UDP)
nc -vz vpn.company.com 1194         # OpenVPN (TCP/UDP)

# IPSec debugging (strongSwan)
ipsec statusall
ipsec status
journalctl -u strongswan -f
swanctl --list-sas
swanctl --list-conns

# OpenVPN debugging
cat /var/log/openvpn/openvpn.log
journalctl -u openvpn@server -f
# Increase verbosity in config: verb 6

# WireGuard debugging
wg show
wg show wg0 latest-handshakes
dmesg | grep wireguard
journalctl -k | grep wireguard

# Check routing
ip route show table all | grep vpn
ip route get 10.0.0.1

# Packet capture on VPN interface
tcpdump -i tun0 -nn
tcpdump -i wg0 -nn

# Check MTU issues
ping -M do -s 1400 remote-host
# Decrease size until it works

# Common issues:
# 1. Firewall blocking VPN ports
# 2. MTU issues (fragmentation)
# 3. Certificate/key mismatch
# 4. Routing table conflicts
# 5. NAT traversal issues</code></pre>
        </div>
      </section>

      <section>
        <div class="section-divider"><span>Related Guides</span></div>
        <div class="card-grid">
          <a href="firewall-concepts.html" class="nav-card card">
            <h4>Firewall Concepts â†’</h4>
            <p>Understand firewall rules for VPN traffic.</p>
          </a>
          <a href="network-segmentation.html" class="nav-card card">
            <h4>Network Segmentation â†’</h4>
            <p>Zero Trust and VPN access control.</p>
          </a>
          <a href="troubleshooting.html" class="nav-card card">
            <h4>Troubleshooting â†’</h4>
            <p>Network diagnostic techniques.</p>
          </a>
        </div>
      </section>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-bottom">
      <p>Network Security & Infrastructure Guide</p>
    </div>
  </footer>

  <script src="main.js"></script>
</body>
</html>
